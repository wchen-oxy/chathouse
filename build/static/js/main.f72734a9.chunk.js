(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){e.exports=a(152)},151:function(e,t,a){},152:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(39),s=a.n(i),o=a(5),l=a(60),c=a(23),u=a(15),d=a(11),p=a(12),h=a(3),m=a(16),v=a(17),E=a(74),f=a.n(E),b="PROJECT_MACRO_VIEW_STATE",g="PROJECT_CONTENT_ONLY_VIEW_STATE",P="ALL",S="POST",O="PROJECT",y="COLLAPSED",j="SPOTLIGHT",D=function(e){return r.a.createElement("section",null,r.a.createElement("div",{id:"welcomeloginform-form",className:"btn-switch"},r.a.createElement("form",{onSubmit:e.onLoginSubmit},r.a.createElement("div",{className:"welcomeloginform-text"},r.a.createElement("input",{type:"text",placeholder:"Email",className:"input-text",name:"email",autoComplete:"off",onChange:e.onLoginEmailChange})),r.a.createElement("div",{className:"welcomeloginform-text"},r.a.createElement("input",{type:"password",placeholder:"Password",className:"input-text",name:"password",autoComplete:"off",onChange:e.onLoginPasswordChange})),r.a.createElement("input",{className:"welcomeloginform-button btn-hero",type:"submit",value:"Log in"})),r.a.createElement("button",{id:"welcomelogin-forgot",className:"welcomeloginform-button",value:"PASSWORD_STATE",onClick:e.onToggleLoginRegisterWindow},"Forget Password?")),r.a.createElement("div",{className:"welcomeloginform-onboard"},r.a.createElement("p",null,"Don't Have An Account?"),r.a.createElement("button",{className:"welcomeloginform-button",value:"REGISTER_STATE",onClick:e.onToggleLoginRegisterWindow},"Create Account")))},I=function(e){var t=Object(n.useState)(!0),a=Object(o.a)(t,2),i=a[0],s=a[1];return r.a.createElement("section",null,r.a.createElement("div",{id:"welcomeregisterform-form"},r.a.createElement("form",{onSubmit:e.onRegisterSubmit},r.a.createElement("div",{className:"welcomeregisterform-text"},r.a.createElement("input",{type:"text",placeholder:"Email",className:"input-text",name:"email",autoComplete:"off",onChange:e.onRegisterEmailChange})),r.a.createElement("div",{className:"welcomeregisterform-text"},r.a.createElement("input",{type:"password",placeholder:"Password",className:"input-text",name:"password",autoComplete:"off",onChange:function(t){t.target.value.length>=6?(s(!1),e.onRegisterPasswordChange(t)):s(!0)}})),r.a.createElement("p",null,i?"Password must be at least 6 characters":null),r.a.createElement("input",{id:"welcomeregisterform-register",className:i?"btn-hero-disabled":"btn-hero",type:"submit",value:"Sign Up",disabled:i}))),r.a.createElement("div",{className:"welcomeregisterform-onboard"},r.a.createElement("p",null,"Already Have An Account?"),r.a.createElement("button",{className:"welcomeregisterform-button",value:"LOGIN_STATE",onClick:e.onToggleLoginRegisterWindow},"Sign In")))},w=r.a.createContext(null),T=function(e){return function(t){return r.a.createElement(w.Consumer,null,function(a){return r.a.createElement(e,Object.assign({},t,{firebase:a}))})}},C=w,_=a(70),k={apiKey:"AIzaSyC9sBHK-evjecmuWQsQHoE-iSJmHUcIBcE",authDomain:"eumyth-65330.firebaseapp.com",databaseURL:"https://eumyth-65330.firebaseio.com",projectId:"eumyth-65330",storageBucket:"eumyth-65330.appspot.com",messagingSenderId:"677080457179",appId:"1:677080457179:web:5e1e38f3f082f93427d1fe",measurementId:"G-GP77M3QKXG"},M=function(){function e(){Object(d.a)(this,e),_.a.initializeApp(k),this.auth=_.a.auth(),this.db=_.a.database(),this.doTest=this.doTest.bind(this),this.doCreateUser=this.doCreateUser.bind(this),this.doSignIn=this.doSignIn.bind(this),this.doSignOut=this.doSignOut.bind(this),this.doSendEmailVerification=this.doSendEmailVerification.bind(this),this.doPasswordReset=this.doPasswordReset.bind(this),this.doPasswordUpdate=this.doPasswordUpdate.bind(this),this.doIsEmailVerified=this.doIsEmailVerified.bind(this),this.checkIsExistingUser=this.checkIsExistingUser.bind(this),this.writeBasicUserData=this.writeBasicUserData.bind(this),this.clearBasicUserData=this.clearBasicUserData.bind(this),this.togglePublisher=this.togglePublisher.bind(this)}return Object(p.a)(e,[{key:"doTest",value:function(){return"FIREBASE"}},{key:"doCreateUser",value:function(e,t){return this.auth.createUserWithEmailAndPassword(e,t).then(function(e){e.user.sendEmailVerification()}).catch(function(e){var t=e.code,a=e.message;console.log(e),"auth/weak-password"===t?alert("The password is too weak."):alert(a)})}},{key:"doSignIn",value:function(e,t){return this.auth.signInWithEmailAndPassword(e,t).catch(function(e){var t=e.code,a=e.message;a&&alert(t+" "+a)})}},{key:"doSignOut",value:function(){return this.auth.signOut()}},{key:"doSendEmailVerification",value:function(){this.auth.currentUser.sendEmailVerification().catch(function(e){var t=e.code,a=e.message;"auth/weak-password"===t?alert("The password is too weak."):console.log(a),console.log(e)})}},{key:"doPasswordReset",value:function(e){return alert("EMAIL"),this.auth.sendPasswordResetEmail(e)}},{key:"doPasswordUpdate",value:function(e){return this.auth.currentUser.updatePassword(e)}},{key:"returnUsername",value:function(){return this.auth.currentUser.displayName}},{key:"doUsernameUpdate",value:function(e){return this.auth.currentUser.updateProfile({displayName:e}).then(function(){return 200})}},{key:"doIsEmailVerified",value:function(){if(this.auth.currentUser)return this.auth.currentUser.emailVerified}},{key:"checkIsExistingUser",value:function(){var e=this.auth.currentUser.uid;return this.db.ref("users/"+e).once("value").then(function(e){return e.val()})}},{key:"returnName",value:function(){var e=this.auth.currentUser.uid;return this.db.ref("users/"+e).once("value").then(function(e){return e.val()})}},{key:"writeBasicUserData",value:function(e,t,a){var n=this.auth.currentUser.uid;return this.db.ref("users/"+n).set({username:e,firstName:t,lastName:a}).then(function(){return 200})}},{key:"clearBasicUserData",value:function(e){if(this.auth.currentUser){var t=this.auth.currentUser.uid;return this.db.ref("users/"+t).remove()}}},{key:"togglePublisher",value:function(e,t){return this.db.ref("users/"+e).set({publisher:t}).then(function(){return 200})}}]),e}(),R={email:"",error:null},L=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state=Object(u.a)({},R),n.handleSubmit=n.handleSubmit.bind(Object(h.a)(n)),n.handleTextUpdate=n.handleTextUpdate.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.email;this.props.firebase.doPasswordReset(a).then(function(){t.setState(Object(u.a)({},R))}).catch(function(e){t.setState({error:e})})}},{key:"handleTextUpdate",value:function(e){this.setState(Object(c.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){var e=this.state,t=e.email,a=e.error,n=""===t;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{name:"email",value:this.state.email,onChange:this.handleTextUpdate,type:"text",placeholder:"Email Address"}),r.a.createElement("button",{disabled:n,type:"submit"},"Reset My Password"),a&&r.a.createElement("p",null,a.message)),r.a.createElement("button",{onClick:this.props.onToggleLoginRegisterWindow,value:"LOGIN_STATE"},"Return"))}}]),a}(r.a.Component),x=T(L),N=function(e){var t=Object(n.useState)(null),a=Object(o.a)(t,2),i=a[0],s=a[1];return r.a.createElement("div",{id:"verifyform"},i?r.a.createElement("p",null,"If you have verified your email, please refresh the page. "):r.a.createElement("p",null,"It looks like you haven't verified your account just yet. Please check your email's inbox or junk folder to verify your account. If you have already, return to login or refresh this page."),r.a.createElement("p",null,i),r.a.createElement("button",{id:"verifyform-resend",className:"btn-hero",onClick:function(t){return s("Email has been sent! Once you verify \n                    your email, try refreshing the page."),e.onSendEmailVerification(t)}},"Resend Email"),r.a.createElement("div",{id:"verifyform-relogin"},r.a.createElement("button",{onClick:e.onSignOut},"Return to Login")))},A={currentUser:"",email:"",password:"",test:"",error:null,window:"LOGIN_STATE",loggedIn:!1,verified:null,showRegisterSuccess:!1},U=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state=Object(u.a)({},A),n.handleWindowToggle=n.handleWindowToggle.bind(Object(h.a)(n)),n.handleLoginSubmit=n.handleLoginSubmit.bind(Object(h.a)(n)),n.handleRegisterSubmit=n.handleRegisterSubmit.bind(Object(h.a)(n)),n.handleSendEmailVerication=n.handleSendEmailVerication.bind(Object(h.a)(n)),n.handleSignOut=n.handleSignOut.bind(Object(h.a)(n)),n.handleRegisterSuccess=n.handleRegisterSuccess.bind(Object(h.a)(n)),n.handleTextChange=n.handleTextChange.bind(Object(h.a)(n)),n.handleVerifiedState=n.handleVerifiedState.bind(Object(h.a)(n)),n.renderLoginRegister=n.renderLoginRegister.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this._isMounted&&this.props.firebase.auth.onAuthStateChanged(function(t){t?e.setState({currentUser:t,verified:t.emailVerified}):e.setState({currentUser:null,verified:!1})})}},{key:"handleTextChange",value:function(e){e.preventDefault(),this.setState(Object(c.a)({},e.target.name,e.target.value))}},{key:"handleRegisterSuccess",value:function(e){e.preventDefault(),this.setState(function(e){return{showRegisterSuccess:!e.showRegisterSuccess}})}},{key:"handleSignOut",value:function(e){e.preventDefault(),this.props.firebase.doSignOut().then(this.setState(Object(u.a)({},A)))}},{key:"handleSendEmailVerication",value:function(e){e.preventDefault(),this.props.firebase.doSendEmailVerification(),alert("Email has been sent! Once you verify \n      your email, try refreshing the page.")}},{key:"handleVerifiedState",value:function(e){this.state.currentUser&&this.setState({verified:e})}},{key:"handleWindowToggle",value:function(e){e.preventDefault(),this.setState({window:e.target.value})}},{key:"handleLoginSubmit",value:function(e){var t=this;if(e.preventDefault(),!f.a.validate(this.state.email))return alert("This is not a valid email!");this.props.firebase.doSignIn(this.state.email,this.state.password).then(function(e){e&&(e.user.emailVerified?t.props.navigate("/",{replace:!0}):t.handleVerifiedState(e.user.emailVerified))})}},{key:"handleRegisterSubmit",value:function(e){var t=this;e.preventDefault(),f.a.validate(this.state.email)?this.state.password.length<6?alert("Password is too short!"):this.props.firebase.doCreateUser(this.state.email,this.state.password).then(function(){return t.setState({showRegisterSuccess:!0})}).catch(function(e){return console.log(e)}):alert("This is not a valid email!")}},{key:"renderLoginRegister",value:function(e){return this.state.currentUser&&!this.state.verified?r.a.createElement("div",{className:"welcome-side"},r.a.createElement(N,{onToggleLoginRegisterWindow:this.handleWindowToggle,onSendEmailVerification:this.handleSendEmailVerication,onSignOut:this.handleSignOut})):"REGISTER_STATE"===e?r.a.createElement("div",{className:"welcome-side"},r.a.createElement(I,{onToggleLoginRegisterWindow:this.handleWindowToggle,onRegisterEmailChange:this.handleTextChange,onRegisterPasswordChange:this.handleTextChange,onRegisterSubmit:this.handleRegisterSubmit})):"LOGIN_STATE"===e?r.a.createElement("div",{className:"welcome-side"},r.a.createElement(D,{onToggleLoginRegisterWindow:this.handleWindowToggle,onLoginEmailChange:this.handleTextChange,onLoginPasswordChange:this.handleTextChange,onLoginSubmit:this.handleLoginSubmit})):"PASSWORD_STATE"===e?r.a.createElement("div",{className:"welcome-side"},r.a.createElement(x,{onToggleLoginRegisterWindow:this.handleWindowToggle})):void 0}},{key:"render",value:function(){return r.a.createElement("section",{className:"welcome-description"},r.a.createElement("div",{className:"welcome-description-inner"},r.a.createElement("h2",null,"Welcome to Third Space! "),r.a.createElement("h4",null,"We're trying to make a place where you can pursue an interest of yours and feel like you're not alone in pursuing something you love. Come document your progress, maybe bump into someone cool every one in awhile and make something meaningful!"),r.a.createElement("p",null,"Login or sign up to get started! To try out this without signing up, use this test account:"),r.a.createElement("br",null),r.a.createElement("p",null," (email: williamshengchen8@gmail.com, password: 123123)")),this.renderLoginRegister(this.state.window))}}]),a}(r.a.Component),F=a(20),V=a(33),W=a(44),B=a.n(W),H=a(91),Y=a.n(H),J=a(99),G=function(e){var t=function(e,t,a){e.preventDefault(),a(t)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,{onDrop:e.handleImageDrop,noClick:!0,noKeyboard:!0,style:{width:"200px",height:"200px"}},function(t){var a=t.getRootProps,n=t.getInputProps;return r.a.createElement("div",a(),r.a.createElement(Y.a,{ref:e.setEditorRef,image:e.profilePhoto,width:170,height:170,borderRadius:200,border:50,color:[215,215,215,.8],scale:e.imageScale,rotate:e.imageRotation}),r.a.createElement("input",n()))}),r.a.createElement("button",{onClick:function(a){return t(a,null,e.clearFile)}},"Clear file"),r.a.createElement("label",null,"Rotation"),r.a.createElement("input",{type:"range",id:"points",name:"points",min:"-180",max:"180",value:e.imageRotation,onChange:function(t){return e.rotateImage(t.target.value)}}),r.a.createElement("button",{onClick:function(a){return t(a,0,e.rotateImage)}},"Reset"),r.a.createElement("label",null,"Scale"),r.a.createElement("input",{type:"range",id:"points",name:"points",step:"0.1",min:"1",max:"10",value:e.imageScale,onChange:function(t){return e.scaleImage(t.target.value)}}),r.a.createElement("button",{onClick:function(a){return t(a,1,e.scaleImage)}},"Reset"))},K=a(67),z=a(22),q=function(e,t){return e?t(e):null},X=function(e,t){var a=e;return a[t._id]=t,a},Q=function(e,t,a){return a[e].comments=t,a[e].comment_count+=1,a},$=function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},Z=function(e,t,a,n){var r=[];return"UNCACHED"===a?r=e.concat(t):"CACHED"===a&&(r=e.concat(t.sort(function(e,t){return n.indexOf(e._id)-n.indexOf(t._id)}))),r},ee=function(e){return(null===e||void 0===e?void 0:e.text_data)&&e.is_paginated?JSON.parse(e.text_data):e.text_data},te=function(e){var t,a=[],n=[],r=Object(F.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(a.push(i.name),i.projects){var s,o=Object(F.a)(i.projects);try{for(o.s();!(s=o.n()).done;){var l=s.value;n.push(l)}}catch(c){o.e(c)}finally{o.f()}}}}catch(c){r.e(c)}finally{r.f()}return{names:a,projects:n}},ae=function(e){return e.map(function(e){return{label:e,value:e}})},ne=function(e,t,a,n,r){if(e)return t(!0),Object(V.a)(e,{maxSizeMB:.5,maxWidthOrHeight:n}).then(function(e){return a(new File([e],r)),!0}).catch(function(e){return console.log(e),!1})},re=function(e,t,a,n){e=e*Math.PI/180,t=t*Math.PI/180,a=a*Math.PI/180;var r=t-e,i=(n=n*Math.PI/180)-a,s=Math.pow(Math.sin(i/2),2)+Math.cos(a)*Math.cos(n)*Math.pow(Math.sin(r/2),2);return 3956*(2*Math.asin(Math.sqrt(s)))},ie=function(e){var t=e.getValue().length||0;return r.a.createElement(z.f.Menu,e,t<5?e.children:r.a.createElement("div",null,"Please just choose 5"))},se=function(e){var t=q(e.options,ae);return r.a.createElement(K.a,{isMulti:!0,onChange:e.onSelect,defaultValue:e.selectedLabels,options:t,components:{Menu:ie},isValidNewOption:function(e,t){return e.length>0&&t.length<5}})},oe=a(13),le=a.n(oe),ce=a(8),ue=a.n(ce),de=function(e){return"/p/"+e},pe=function(e){return"/c/"+e},he=function(e){return"/u/"+e},me=function(e){return e?"http://"+ce.BUCKET_NAME+".s3."+ce.REGION+".amazonaws.com/"+e:null},ve=function(e){return e?"http://"+ce.BUCKET_NAME+".s3."+ce.REGION+".amazonaws.com/"+e:ce.TEMP_PROFILE_PHOTO_URL},Ee=function(e){return{params:{username:e}}},fe=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,null,[{key:"allPosts",value:function(e){return le.a.get(ue.a.ALL_POSTS,{params:{profileID:e}})}},{key:"changeRelationStatus",value:function(e,t,a,n){return le.a.put(ue.a.RELATION_SET_FOLLOWER_URL,{action:e,targetUserPreviewID:t,targetUserRelationID:a,currentUserRelationID:n})}},{key:"checkUsernameAvailable",value:function(e){return le.a.get(ue.a.CHECK_USERNAME_URL,{username:e})}},{key:"createPost",value:function(e){return le.a.post(ue.a.POST_BASE_URL,e)}},{key:"createProject",value:function(e){return le.a.post(ue.a.PROJECT_BASE_URL,e)}},{key:"updateProject",value:function(e){return le.a.put(ue.a.PROJECT_BASE_URL,e)}},{key:"updateCachedDraftTitle",value:function(e,t,a){return le.a.put(ue.a.DRAFT_TITLE_URL,{indexUserID:e,projectID:t,threadTitle:a})}},{key:"updatePostOwner",value:function(e,t,a){return le.a.put(ue.a.PROJECT_THREAD_URL,{projectPreviewID:e,projectID:t,postID:a})}},{key:"createUserProfile",value:function(e){return le.a.post(ue.a.USER_BASE_URL,e)}},{key:"deleteAccountPhoto",value:function(e,t){return le.a.delete("COVER"===t?ue.a.COVER_PHOTO_URL:ue.a.DISPLAY_PHOTO_URL,{data:{username:e,contentType:t}})}},{key:"deletePhotoByKey",value:function(e){return le.a.delete(ue.a.IMAGE_BASE_URL,{data:{imageKey:e}})}},{key:"deleteManyPhotosByKey",value:function(e){return le.a.delete(ue.a.MULTIPLE_IMAGES_URL,{data:{keys:e}})}},{key:"deleteProject",value:function(e,t,a,n,r){return le.a.delete(ue.a.PROJECT_BASE_URL,{params:{projectID:e,shouldDeletePosts:t,indexUserID:a,userID:n,userPreviewID:r}})}},{key:"deletePost",value:function(e,t,a,n,r,i,s){return le.a.delete(ue.a.POST_BASE_URL,{data:{userPreviewID:e,userID:t,indexUserID:a,postID:n,pursuit:r,duration:i}})}},{key:"getCachedFeed",value:function(e){return le.a.get(ue.a.CACHED_FEED_URL,{params:{cachedFeedsID:e}})}},{key:"getUserPreviewID",value:function(e){return le.a.get(ue.a.USER_PREVIEW_ID_URL,Ee(e))}},{key:"getSimilarPeople",value:function(e,t,a,n,r){return le.a.get(ue.a.SIMPLE_PEOPLE_URL,{params:{distance:e,pursuit:t,userPreviewIDList:a,latitude:n,longitude:r}})}},{key:"getSimilarPeopleAdvanced",value:function(e,t,a,n,r){return le.a.get(ue.a.ADVANCED_PEOPLE_URL,{params:{distance:e,pursuits:t,userPreviewIDList:a,latitude:n,longitude:r}})}},{key:"getSpotlight",value:function(e,t,a,n){return le.a.get(ue.a.SPOTLIGHT_URL,{params:{distance:e,latitude:t,longitude:a,userPreviewIDList:n}})}},{key:"returnUserRelationInfo",value:function(e){return le.a.get(ue.a.RELATION_INFO_URL,Ee(e))}},{key:"returnTinyDisplayPhoto",value:function(e){return le.a.get(ue.a.TINY_DISPLAY_PHOTO_URL,Ee(e))}},{key:"setProfilePrivacy",value:function(e,t){return le.a.put(ue.a.USER_PRIVACY_URL,{username:e,isPrivate:t})}},{key:"setFollowerStatus",value:function(e,t,a,n,r,i){return le.a.put(ue.a.RELATION_STATUS_URL,{visitorUserRelationID:e,visitorCachedFeedID:t,targetUserRelationID:a,targetCachedFeedID:n,action:r,isPrivate:i})}},{key:"createFork",value:function(e,t,a,n,r,i,s,o,l){return le.a.put(ue.a.PROJECT_FORK_URL,{userID:e,indexUserID:t,username:a,projectData:n,shouldCopyPosts:r,displayPhotoKey:i,title:s,remix:o,cachedFeedID:l})}},{key:"getLocation",value:function(e){return le.a.get(ue.a.USER_PREVIEW_LOCATION_URL,{params:{userPreviewID:e}})}},{key:"setLocation",value:function(e,t,a){return le.a.put(ue.a.USER_PREVIEW_LOCATION_URL,{latitude:e,longitude:t,userPreviewID:a})}},{key:"returnIndexUser",value:function(e,t){return le.a.get(ue.a.INDEX_BASE_URL,{params:{username:e,isTruncated:t}})}},{key:"returnUser",value:function(e){return le.a.get(ue.a.USER_BASE_URL,Ee(e))}},{key:"returnFollowerStatus",value:function(e,t){return le.a.get(ue.a.RELATION_BASE_URL,{params:{visitorUsername:e,userRelationID:t}})}},{key:"getSpotlightProjects",value:function(e,t){return le.a.get(ue.a.PROJECT_SPOTLIGHT_URL,{params:{quantity:e,pursuitArray:t}})}},{key:"returnSingleProject",value:function(e){return le.a.get(ue.a.SINGLE_PROJECT_URL,{params:{projectID:e}})}},{key:"returnMultipleProjects",value:function(e){return le.a.get(ue.a.MULTIPLE_PROJECTS_URL,{params:{projectIDList:e}})}},{key:"getSingleProjectPreview",value:function(e){return le.a.get(ue.a.PROJECT_PREVIEW_SINGLE_URL,{params:{projectPreviewID:e}})}},{key:"getRelatedProjectPreview",value:function(e,t,a){return le.a.get(ue.a.SEARCH_RELATED_PREVIEW_URL,{params:{excluded:e,keywords:t,pursuit:a}})}},{key:"getSharedParentProjectPreview",value:function(e,t,a){return le.a.get(ue.a.PROJECT_PREVIEW_SHARED_URL,{params:{parentProjectPreviewID:e,status:t,excluded:a}})}},{key:"returnMultiplePostInfo",value:function(e,t){return le.a.get(ue.a.MULTIPLE_POSTS_URL,{params:{targetUserDataID:e,postIDList:t}})}},{key:"returnProjectPreviewFromPostID",value:function(e){return le.a.get(ue.a.PROJECT_PREVIEW_FROM_POST,{params:{postID:e}})}},{key:"returnMultiplePosts",value:function(e,t){return le.a.get(ue.a.MULTIPLE_POSTS_URL,{params:{postIDList:e,includePostText:t}})}},{key:"returnExtraFeedContent",value:function(e){return le.a.get(ue.a.EXTRA_FEED_URL,{params:{contentList:e}})}},{key:"returnOverflowContent",value:function(e,t,a,n){return le.a.get(ue.a.SEARCH_UNCACHED_URL,{params:{contentIDList:e,contentType:t,indexUserID:a,requestQuantity:n}})}},{key:"retrieveProject",value:function(e){return le.a.get(ue.a.PROJECT_BASE_URL,{params:{projectID:e}})}},{key:"retrievePost",value:function(e,t){return le.a.get(ue.a.SINGLE_POST_TEXT_DATA_URL,{params:{postID:e,textOnly:t}})}},{key:"returnSocialFeedPosts",value:function(e,t){return le.a.get(ue.a.SOCIAL_FEED_POSTS_URL,{params:{indexUserID:e,postIDList:t}})}},{key:"returnAccountSettingsInfo",value:function(e){return le.a.get(ue.a.USER_ACCOUNT_SETTINGS_INFO_URL,Ee(e))}},{key:"updateBio",value:function(e,t,a,n){return le.a.put(ue.a.USER_BIO_URL,{userPreviewID:e,indexUserID:t,userID:a,bio:n})}},{key:"updatePost",value:function(e){return le.a.put(ue.a.POST_BASE_URL,e)}},{key:"updateAccountImage",value:function(e,t){return le.a.post("COVER"===t?ue.a.COVER_PHOTO_URL:ue.a.DISPLAY_PHOTO_URL,e)}},{key:"getComments",value:function(e,t){return le.a.get(ue.a.COMMENT_BASE_URL,{params:{rootCommentIDArray:e,viewingMode:t}})}},{key:"postComment",value:function(e,t,a,n){return le.a.post(ue.a.ROOT_COMMENT_URL,{profilePreviewID:e,comment:t,postID:a,imagePageNumber:n})}},{key:"postAnnotation",value:function(e,t,a,n,r){return le.a.post(ue.a.ROOT_COMMENT_URL,{profilePreviewID:e,postID:t,imagePageNumber:a,annotationData:n,annotationGeometry:r})}},{key:"postReply",value:function(e,t,a,n){return le.a.post(ue.a.REPLY_COMMENT_URL,{postID:e,profilePreviewID:t,ancestors:a,comment:n})}},{key:"publishProject",value:function(e){return le.a.put(ue.a.PROJECT_PUBLISH_URL,{projectID:e})}},{key:"retrieveNewPostInfo",value:function(e){return le.a.get(ue.a.DRAFT_BASE_URL,Ee(e))}},{key:"returnImage",value:function(e){return le.a.get(ue.a.IMAGE_BASE_URL,{params:{imageKey:e}})}},{key:"refreshComments",value:function(e){return le.a.get(ue.a.REFRESH_COMMENTS_URL,{params:{rootCommentIDArray:e}})}},{key:"saveDraft",value:function(e,t,a){return le.a.put(ue.a.DRAFT_BASE_URL,{username:e,draft:JSON.stringify(t),draftTitle:a})}},{key:"updatePostDisplayPhotos",value:function(e,t){return le.a.patch(ue.a.POST_DISPLAY_PHOTO_URL,{username:e,imageKey:t})}},{key:"updateTemplate",value:function(e,t,a){return le.a.put(ue.a.USER_TEMPLATE_URL,{indexUserID:e,text:t,pursuit:a})}},{key:"voteOnComment",value:function(e,t,a){return le.a.put(ue.a.VOTE_ON_COMMENT_URL,{profilePreviewID:e,commentID:t,voteValue:a})}},{key:"voteOnProject",value:function(e,t,a){return le.a.put(ue.a.PROJECT_VOTE_URL,{projectID:e,userPreviewID:t,voteValue:a})}},{key:"bookmarkContent",value:function(e,t,a,n){return le.a.put(ue.a.BOOKMARK_URL,{contentType:e,contentID:t,userPreviewID:a,bookmarkState:n})}},{key:"searchProject",value:function(e,t,a,n){return le.a.get(ue.a.SEARCH_PROJECT_URL,{params:{pursuit:e,projectIDList:t,requestQuantity:a,submittingIndexUserID:n}})}},{key:"returnUserPreviewByParam",value:function(e){return le.a.get(ue.a.USER_PREVIEW_BASE_URL,{params:Object(u.a)({},e)})}},{key:"searchBranches",value:function(e,t){return le.a.get(ue.a.SEARCH_BRANCHES_URL,{params:{indexUserID:e,requestQuantity:t}})}}]),e}(),be=a(6),ge=["Drawing","Painting","Cycling"],Pe={firstName:"",lastName:"",username:"",pursuits:[],experienceSelects:[],isTaken:!1,isUpperCase:!1,croppedImage:null,fullImage:null,imageScale:1,imageRotation:0,isSubmitting:!1},Se=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).editor=r.a.createRef(null),n.handleRegisterFailure=n.handleRegisterFailure.bind(Object(h.a)(n)),n.handleTextChange=n.handleTextChange.bind(Object(h.a)(n)),n.handleUsernameChange=B.a.debounce(function(e){return n.checkUsernameAvailable(e)},1e3),n.handleExperienceSelect=n.handleExperienceSelect.bind(Object(h.a)(n)),n.handleProfileSubmit=n.handleProfileSubmit.bind(Object(h.a)(n)),n.handlePursuitExperienceChange=n.handlePursuitExperienceChange.bind(Object(h.a)(n)),n.handleProfilePhotoChange=n.handleProfilePhotoChange.bind(Object(h.a)(n)),n.handleImageDrop=n.handleImageDrop.bind(Object(h.a)(n)),n.testForSpecialCharacter=n.testForSpecialCharacter.bind(Object(h.a)(n)),n.checkUsernameAvailable=n.checkUsernameAvailable.bind(Object(h.a)(n)),n.clearFile=n.clearFile.bind(Object(h.a)(n)),n.setEditorRef=n.setEditorRef.bind(Object(h.a)(n)),n.rotateImage=n.rotateImage.bind(Object(h.a)(n)),n.scaleImage=n.scaleImage.bind(Object(h.a)(n)),n.state=Object(u.a)({},Pe),n}return Object(p.a)(a,[{key:"clearFile",value:function(){this.setState(function(e){return{imageKey:e.imageKey+1,profilePhoto:null}})}},{key:"rotateImage",value:function(e){this.setState({imageRotation:parseFloat(e)})}},{key:"scaleImage",value:function(e){this.setState({imageScale:parseFloat(e)})}},{key:"checkUsernameAvailable",value:function(e){var t=this;return fe.checkUsernameAvailable(e).then(function(e){var a=null;200===e.status?a=!0:204===e.state&&(a=!1),t.setState({isTaken:a})}).catch(function(e){console.log(e)})}},{key:"handleRegisterFailure",value:function(e){return this.setState({isSubmitting:!1}),console.log(e),this.props.firebase.clearBasicUserData()}},{key:"handleTextChange",value:function(e,t){if(e.preventDefault(),this.setState(Object(c.a)({},e.target.name,e.target.value)),"username"===e.target.name){var a=e.target.value;t||this.handleUsernameChange(a)}}},{key:"handleExperienceSelect",value:function(e){var t=[],a=[];if(e){var n,i=Object(F.a)(e);try{for(i.s();!(n=i.n()).done;){var s=n.value;t.push({name:s.value,experience:"Beginner"}),a.push(r.a.createElement("span",{key:s.value},r.a.createElement("label",null,s.value),r.a.createElement("select",{className:"initialcustomization-select",name:s.value,onChange:this.handlePursuitExperienceChange},r.a.createElement("option",{value:"Beginner"},"Beginner"),r.a.createElement("option",{value:"Familiar"},"Familiar"),r.a.createElement("option",{value:"Experienced"},"Experienced"),r.a.createElement("option",{value:"Expert"},"Expert"))))}}catch(o){i.e(o)}finally{i.f()}}this.setState({pursuits:t,experienceSelects:a})}},{key:"handleProfileSubmit",value:function(e){var t=this;if(e.preventDefault(),this.setState({isSubmitting:!0}),this.state.profilePhoto){var a=this.editor.getImage();Promise.all([this.props.firebase.writeBasicUserData(this.state.username,this.state.firstName,this.state.lastName),this.props.firebase.doUsernameUpdate(this.state.username),V.a.canvasToFile(a)]).then(function(e){return Promise.all([Object(V.a)(e[2],{maxWidthOrHeight:250,maxSizeMB:1,fileType:"image/jpeg"}),Object(V.a)(e[2],{maxWidthOrHeight:125,maxSizeMB:1,fileType:"image/jpeg"}),Object(V.a)(e[2],{maxWidthOrHeight:62,maxSizeMB:1,fileType:"image/jpeg"})])}).then(function(e){for(var t=["normal","small","tiny"],a=[],n=0;n<3;n++)a.push(new File([e[n]],t[n],{type:"image/jpeg"}));return a}).then(function(e){var a=t.state.pursuits.map(function(e){return e.toUpperCase()}),n=new FormData;return n.append(be.USERNAME_FIELD,t.state.username),n.append(be.FIRST_NAME_FIELD,t.state.firstName),n.append(be.LAST_NAME_FIELD,t.state.lastName),n.append(be.PURSUIT_ARRAY_FIELD,JSON.stringify(a)),n.append(be.CROPPED_IMAGE_FIELD,e[0]),n.append(be.SMALL_CROPPED_IMAGE_FIELD,e[1]),n.append(be.TINY_CROPPED_IMAGE_FIELD,e[2]),fe.createUserProfile(n)}).then(function(e){t.setState({isSubmitting:!1}),201===e.status&&window.location.reload()}).catch(function(e){t.handleRegisterFailure(e)})}else Promise.all([this.props.firebase.writeBasicUserData(this.state.username,this.state.firstName,this.state.lastName),this.props.firebase.doUsernameUpdate(this.state.username)]).then(function(e){var a=new FormData;return a.append(be.USERNAME_FIELD,t.state.username),a.append(be.FIRST_NAME_FIELD,t.state.firstName),a.append(be.LAST_NAME_FIELD,t.state.lastName),a.append(be.PURSUIT_ARRAY_FIELD,JSON.stringify(t.state.pursuits)),fe.createUserProfile(a)}).then(function(e){201===e.status?window.location.reload():alert("Something unexpected happened: ",e.status)}).catch(function(e){t.handleRegisterFailure(e)})}},{key:"handlePursuitExperienceChange",value:function(e){var t,a=this.state.pursuits,n=Object(F.a)(a);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.name===e.target.name&&(r.experience=e.target.value)}}catch(i){n.e(i)}finally{n.f()}this.setState({pursuits:a})}},{key:"testForSpecialCharacter",value:function(e){return!new RegExp("^[0-9A-Za-z_.]+$").test(e)||/\s/.test(e)}},{key:"handleProfilePhotoChange",value:function(e){this.setState({profilePhoto:e})}},{key:"handleImageDrop",value:function(e){this.setState({profilePhoto:e[0]})}},{key:"setEditorRef",value:function(e){this.editor=e}},{key:"render",value:function(){var e=this,t=""===this.state.username||this.state.isTaken?"Taken":"Available",a=this.state.username!==this.state.username.toLowerCase(),n=a?", But Please Choose Only Lower Case Characters":"",i=this.testForSpecialCharacter(this.state.username),s=i?a?" and No Special Characters Please":", But No Special Characters Please":"",o=this.state,l=o.username,c=o.firstName,u=o.lastName,d=o.pursuits,p=""===l||""===c||""===u||null===d||0===d.length||this.state.isTaken||a||i,h=0!==this.state.pursuits.length?this.state.experienceSelects:null;return r.a.createElement("div",{id:"initialcustomization"},r.a.createElement("form",{onSubmit:this.handleProfileSubmit},r.a.createElement("h2",null,"Let us know about you!"),r.a.createElement("label",null,"Don't worry this information won't be public if you don't want it to."),r.a.createElement("div",{className:"initialcustomization-content"},r.a.createElement("label",null,"Choose a display profile!"),r.a.createElement("input",{key:this.state.imageKey,type:"file",name:be.DISPLAY_PHOTO_FIELD,onChange:function(t){return e.handleProfilePhotoChange(t.target.files[0])}}),this.state.profilePhoto?r.a.createElement(G,{clearFile:this.clearFile,profilePhoto:this.state.profilePhoto,handleImageDrop:this.handleImageDrop,imageScale:this.state.imageScale,imageRotation:this.state.imageRotation,rotateImage:this.rotateImage,scaleImage:this.scaleImage,setEditorRef:this.setEditorRef}):r.a.createElement("div",{id:"initialcustomization-dp"})),r.a.createElement("div",{className:"initialcustomization-content"},r.a.createElement("label",null,r.a.createElement("p",null,"Choose a username!"),r.a.createElement("p",null,""===this.state.username?"Invalid":t+n+s)),r.a.createElement("input",{type:"text",name:be.USERNAME_FIELD,placeholder:"Username",onChange:function(t){return e.handleTextChange(t,p)}}),r.a.createElement("label",null,"First Name"),r.a.createElement("input",{type:"text",name:be.FIRST_NAME_FIELD,placeholder:"First Name",onChange:this.handleTextChange}),r.a.createElement("label",null,"Last Name"),r.a.createElement("input",{type:"text",name:be.LAST_NAME_FIELD,placeholder:"Last Name",onChange:this.handleTextChange})),r.a.createElement("div",{className:"initialcustomization-content"},r.a.createElement("label",null,"Tell us what you want to pursue or choose one from the list!"),r.a.createElement(se,{name:be.PURSUIT_ARRAY_FIELD,onSelect:this.handleExperienceSelect,options:ge}),h,r.a.createElement("button",{disabled:p||this.state.isSubmitting,type:"submit"},"Submit"))))}}]),a}(r.a.Component),Oe=T(Se),ye=r.a.createContext(null),je=(r.a.createContext(null),function(e){var t=function(t){Object(m.a)(n,t);var a=Object(v.a)(n);function n(e){var t;return Object(d.a)(this,n),(t=a.call(this,e)).state={authUser:null,isLoading:!0,mongoError:!1},t.createUserInfoObject=t.createUserInfoObject.bind(Object(h.a)(t)),t.saveUserInfoObject=t.saveUserInfoObject.bind(Object(h.a)(t)),t}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.listener=this.props.firebase.auth.onAuthStateChanged(function(t){t?e.createUserInfoObject(t):e.saveUserInfoObject(!1)})}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"createUserInfoObject",value:function(e){var t=this;if(!e.displayName){var a={email:e.email,emailVerified:e.emailVerified,uid:e.uid};return this.saveUserInfoObject(!0,a)}return fe.returnIndexUser(e.displayName,!0).then(function(a){var n=Object(u.a)({email:e.email,emailVerified:e.emailVerified,uid:e.uid},a.data);t.saveUserInfoObject(!0,n)}).catch(function(a){if(console.log(a),404===a.response.status){var n={email:e.email,emailVerified:e.emailVerified,uid:e.uid};t.saveUserInfoObject(!0,n)}else t.setState({isLoading:!1,mongoError:!0})})}},{key:"saveUserInfoObject",value:function(e,t){e?this.setState({authUser:t,isLoading:!1}):this.setState({authUser:null,isLoading:!1})}},{key:"render",value:function(){return this.state.isLoading?r.a.createElement("p",null,"Loading ... "):this.state.mongoError?r.a.createElement("p",null,"You are authenticated but we cannot reach our servers at the moment. Please Contact 88developers@gmail.com"):r.a.createElement(ye.Provider,{value:this.state.authUser},r.a.createElement(e,this.props))}}]),n}(r.a.Component);return T(t)}),De=a(7);var Ie=function(e){return function(t){var a=Object(De.k)(),n=Object(De.m)(),i=Object(De.o)();return r.a.createElement(e,Object.assign({},t,{navigate:n,location:a,match:i}))}},we=function(e){return function(t){var a=function(a){Object(m.a)(i,a);var n=Object(v.a)(i);function i(){return Object(d.a)(this,i),n.apply(this,arguments)}return Object(p.a)(i,[{key:"componentDidMount",value:function(){var t=this;this.listener=this.props.firebase.auth.onAuthStateChanged(function(a){e(a)||t.props.history.push("")})}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){var a=this;return r.a.createElement(ye.Consumer,null,function(n){return e(n)?r.a.createElement(t,a.props):null})}}]),i}(r.a.Component);return Object(l.a)(Ie,T)(a)}},Te=a(49),Ce={enableHighAccuracy:!0,timeout:5e3,maximumAge:0},_e=a(30),ke=function(e){var t=[];t.push(r.a.createElement("option",{key:"null",value:null}));for(var a=1;a<e.pursuitNames.length;a++){var n=e.pursuitNames[a];t.push(r.a.createElement("option",{key:n,value:n},n))}return r.a.createElement("div",{className:"btn-meta"},r.a.createElement("label",null,"Pursuit"),r.a.createElement("select",{name:"pursuit-category",id:"pursuitcategoryinput-select",value:e.pursuit,onChange:function(t){return e.setPursuit(t.target.value)}},t))},Me=function(e){var t=Object(n.useState)(e.selectedDraft),a=Object(o.a)(t,2),i=a[0],s=(a[1],Object(n.useState)(0)),l=Object(o.a)(s,2),c=l[0],u=l[1],d=Object(n.useState)([]),p=Object(o.a)(d,2),h=p[0],m=p[1];Object(n.useEffect)(function(){var t=e.drafts.length>0,a=t?e.drafts.map(function(t,a){return e.isUpdateToPost&&t.content_id===e.selectedDraft.content_id&&u(a),r.a.createElement("option",{key:a,value:a},t.title)}):[r.a.createElement("option",{value:null,disabled:!0},"No Drafts Available")];t&&!e.isUpdateToPost&&(a.unshift(r.a.createElement("option",{key:"null",value:-1})),u(-1)),m(a)},[]);return console.log(e.toggleState),r.a.createElement("div",{id:"projectdraftcontrols"},r.a.createElement("div",{className:"projectdraftcontrols-header"},r.a.createElement("span",null,r.a.createElement("label",null,e.isUpdateToPost?"Change The Series the Post Belongs To:":"Add to Existing Series:"),r.a.createElement("label",{className:"switch"},r.a.createElement("input",{type:"checkbox",checked:e.toggleState,onChange:function(){return e.setToggleState(!e.toggleState)}}),r.a.createElement("span",{className:"slider round"})),r.a.createElement("label",null,"Create New Series")),r.a.createElement("h5",null,"A Series is a collection of posts that have a common theme or idea. When you add more posts to a Series, you can see how your pursuit develops over time. As a Series grows, you may be surprised who may interested in your hard work!")),e.toggleState?r.a.createElement("div",null,r.a.createElement("div",{className:"projectdraftcontrols-inner"},r.a.createElement(_e.a,{name:"subtitle",id:"titleinput-content",placeholder:"Write the Title of Your New Series",onChange:function(t){return e.setThreadTitle(t.target.value)},minRows:2,maxLength:140})),r.a.createElement(ke,{pursuitNames:e.pursuitNames,pursuit:e.pursuit,setPursuit:e.setPursuit}),r.a.createElement("div",{className:"projectdraftcontrols-inner"},r.a.createElement("label",null,"Make Series Title Private"),r.a.createElement("input",{type:"checkbox",onChange:function(){return e.setTitlePrivacy(!e.titlePrivacy)}}))):r.a.createElement("div",{className:"projectdraftcontrols-inner"},r.a.createElement("label",null,"Series"),r.a.createElement("select",{name:"select",id:"projectdraftcontrols-content",value:c,onChange:function(t){var a=t.target.value;u(a),e.setDraft(e.drafts[a]),console.log(e.drafts[a])}},h),r.a.createElement("div",{className:"projectdraftcontrols-inner"},r.a.createElement("label",null,"Complete Series"),r.a.createElement("input",{type:"checkbox",onChange:function(){return e.setCompleteProject(!e.isCompleteProject)}}))),e.isUpdateToPost&&i&&i!==e.selectedDraft&&r.a.createElement("p",null,"Changing the series this post belongs to may require you to reorder your posts in the new parent series. You may do so by directly editing the parent series. "))},Re=function(e){var t={};switch(e.case){case 1:t.style="step-number",t.number=1,t.label="Main";break;case 2:t.style=e.current>=2?"step-number":"step-number-disabled",t.number=2,t.label="Extras";break;case 3:t.style=e.current>=3?"step-number":"step-number-disabled",t.number=3,t.label="Review"}return r.a.createElement("div",{className:"step"},r.a.createElement("div",{className:t.style},r.a.createElement("h3",null,t.number)),r.a.createElement("h4",null,t.label))},Le=function(e){return r.a.createElement("div",{id:"steps"},r.a.createElement(Re,{case:1,current:e.current}),r.a.createElement(Re,{case:2,current:e.current}),r.a.createElement(Re,{case:3,current:e.current}))},xe=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),i=a[0],s=a[1],l=Object(n.useState)(!1),c=Object(o.a)(l,2),u=c[0],d=c[1],p=Object(n.useState)(!1),h=Object(o.a)(p,2),m=h[0],v=h[1],E=!e.selectedDraft,f=0===e.threadTitle.length||!e.selectedPursuit,b=m||e.threadToggleState?f:E,g=b?"reviewstage-button-disabled":" reviewstage-button-enabled";return r.a.createElement("div",{id:"reviewstage"},r.a.createElement("div",null,r.a.createElement("div",{id:"reviewstage-header"},r.a.createElement("h2",null,"Add your metadata!")),r.a.createElement("div",{id:"reviewstage-nav"},r.a.createElement("div",{id:"reviewstage-prev"},r.a.createElement("button",{className:"reviewstage-button-enabled",value:e.previousState,onClick:function(t){return a=t.target.value,void e.setPostStage(a);var a}},"  Return")),r.a.createElement(Le,{current:3}),r.a.createElement("div",{id:"reviewstage-next"},r.a.createElement("button",{className:g,onClick:function(t){return function(){v(!0);var t={setIsSubmitting:v,setLoading:s,setError:d,closeModal:e.closeModal};e.handleSubmit(t)}()},disabled:b},e.isUpdateToPost?m?"Updating!":"Update!":m?"Posting!":"Post!"))),r.a.createElement("div",{id:"reviewstage-desc"},E&&r.a.createElement("p",null,"Please Select or Create a Series")),r.a.createElement("div",null,r.a.createElement(Me,{isUpdateToPost:e.isUpdateToPost,drafts:e.drafts,selectedDraft:e.selectedDraft,pursuit:e.selectedPursuit,title:e.threadTitle,titlePrivacy:e.titlePrivacy,toggleState:e.threadToggleState,isCompleteProject:e.isCompleteProject,pursuitNames:e.pursuitNames.map(function(e){return e.name}),setPursuit:e.setSelectedPursuit,setDraft:e.setDraft,setTitlePrivacy:e.setTitlePrivacy,setThreadTitle:e.setThreadTitle,setToggleState:e.setThreadToggleState,setCompleteProject:e.setIsCompleteProject})),u&&r.a.createElement("p",null,"An Error Occured. Please try again. "),i&&r.a.createElement("div",null,"  ",r.a.createElement("p",null," Loading..."),"  ")))},Ne=function(e){return r.a.createElement("div",{className:"imagedrop",onDragOver:e.dragOver,onDragEnter:e.dragEnter,onDragLeave:e.dragLeave,onDrop:e.fileDrop,onClick:e.fileInputClicked},r.a.createElement("div",{id:"imagedrop-message"},r.a.createElement("div",{id:"imagedrop-upload"}),"Drag and Drop files here or click to select file(s)"),r.a.createElement("input",{ref:e.reference,type:"file",multiple:!0,onChange:e.filesSelected}))},Ae=a(54),Ue=r.a.memo(function(e){var t=Object(Ae.b)(function(e){var t=e.data,a=e.fileType,n=e.fileSize,i=e.errorMessage,s=e.removeFile,o=t.invalid?"sortableitem-error":"";return console.log(t),r.a.createElement("div",{className:"sortableitem"},r.a.createElement("div",null,r.a.createElement("div",{className:"sortableitem-type-logo"}),r.a.createElement("div",{className:"sortableitem-type"},a(t.name)),r.a.createElement("span",{className:"sortableitem-name ".concat(o)},t.name),r.a.createElement("span",{className:"sortableitem-size"},"(",n(t.size),")"),t.invalid&&r.a.createElement("span",{className:"sortableitem-error-message"},"(",i,")")),r.a.createElement("button",{onClick:function(){return s(t.name)}},"X"))}),a=Object(Ae.a)(function(e){var a=e.items,n=e.onSortEnd,i=e.fileType,s=e.fileSize,o=e.errorMessage,l=e.removeFile;return r.a.createElement("ul",null,a.map(function(e,a){return r.a.createElement(t,{key:"item-".concat(a),index:a,data:e,onSortEnd:n,fileType:i,fileSize:s,errorMessage:o,removeFile:l})}))});return r.a.createElement(a,{items:e.validFiles,onSortEnd:e.onSortEnd,fileType:e.fileType,fileSize:e.fileSize,errorMessage:e.errorMessage,removeFile:e.removeFile})}),Fe=function(e){return e.isPaginated?r.a.createElement("button",{className:"captionbuttons",title:"Discard All Captions Except For the First Image",onClick:e.onPaginatedChange},"Return to Single Caption"):r.a.createElement("button",{className:"captionbuttons",title:"Click to Caption Each Image Individually",onClick:e.onPaginatedChange},"Caption Photos Individually")},Ve=function(e){return console.log(e.isPaginated),r.a.createElement("div",{id:"textcontainer"},e.validFilesLength>1&&r.a.createElement(Fe,{validFilesLength:e.validFilesLength,isPaginated:e.isPaginated,onPaginatedChange:e.onPaginatedChange}),r.a.createElement(_e.a,{id:"textcontainer-text-input",placeholder:"Write something here.",onChange:function(t){return e.onTextChange(t.target.value)},minRows:10,value:e.isPaginated?e.tempText[e.imageIndex]:e.tempText}),r.a.createElement("p",null,e.validFilesLength>1?e.imageIndex+1:null))},We=a(98),Be=function(e){return r.a.createElement("div",null,e.imageArray.length>1?r.a.createElement("div",{className:"imagecontrols"},r.a.createElement("button",{onClick:function(t){return e.onArrowPress(t,-1)}},"<"),r.a.createElement("p",null,e.imageIndex+1," of ",e.imageArray.length),r.a.createElement("button",{onClick:function(t){return e.onArrowPress(t,1)}},">")):null,"EXPANDED"===e.windowType&&!e.editProjectState&&r.a.createElement("div",{className:"imagecontrols"},r.a.createElement("button",{onClick:e.toggleAnnotations},e.areAnnotationsHidden?"Show Annotations":"Hide Annotations")))},He=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={annotation:{}},n.activeAnnotationComparator=n.activeAnnotationComparator.bind(Object(h.a)(n)),n.onAnnotationChange=n.onAnnotationChange.bind(Object(h.a)(n)),n.onAnnotationSubmit=n.onAnnotationSubmit.bind(Object(h.a)(n)),n.renderEditor=n.renderEditor.bind(Object(h.a)(n)),n.renderPromptOverlay=n.renderPromptOverlay.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"onAnnotationChange",value:function(e){this.setState({annotation:e})}},{key:"onAnnotationSubmit",value:function(e){this.setState({annotation:{}},this.props.onAnnotationSubmit(e))}},{key:"renderEditor",value:function(e){var t=e.annotation.geometry;return t?r.a.createElement("div",{style:{background:"white",borderRadius:3,position:"absolute",zIndex:9999,left:"".concat(t.x,"%"),top:"".concat(t.y+t.height,"%")}},r.a.createElement("div",null,"Custom Editor"),r.a.createElement(_e.a,{onChange:function(t){return e.onChange(Object(u.a)(Object(u.a)({},e.annotation),{},{data:Object(u.a)(Object(u.a)({},e.annotation.data),{},{text:t.target.value})}))}}),r.a.createElement("button",{onClick:e.onSubmit},"Comment")):null}},{key:"renderPromptOverlay",value:function(){return r.a.createElement("div",{style:{background:"rgba(0, 0, 0, 0.3)",color:"white",padding:5,pointerEvents:"none",position:"absolute",top:5,left:5}},"Click and Drag to create an annotation!")}},{key:"activeAnnotationComparator",value:function(e,t){return e.data.id===t}},{key:"render",value:function(){var e,t=this.props.hideAnnotations||this.props.annotateButtonPressed?[]:this.props.annotations;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:this.props.newPost||this.props.isReEdit?"customimageslider-new-post-hero-container":(e=this.props.windowType,"EXPANDED"===e?"customimageslider-hero-container customimageslider-expanded":"customimageslider-hero-container")},r.a.createElement(We.a,{src:this.props.imageArray[this.props.imageIndex],alt:"Image Display Goes Here",activeAnnotations:this.props.activeAnnotations,annotations:t,disableOverlay:this.props.hideAnnotations||!this.props.visitorProfilePreviewID,disableAnnotation:this.props.windowType===y||!this.props.visitorProfilePreviewID,value:this.state.annotation,renderEditor:this.renderEditor,activeAnnotationComparator:this.activeAnnotationComparator,onChange:this.onAnnotationChange,onSubmit:this.onAnnotationSubmit})),this.props.showPromptOverlay&&r.a.createElement("p",null,"Click on a point in the image and drag!"),r.a.createElement(Be,{editProjectState:this.props.editProjectState,imageIndex:this.props.imageIndex,imageArray:this.props.imageArray,windowType:this.props.windowType,areAnnotationsHidden:this.props.areAnnotationsHidden,onArrowPress:this.props.onArrowPress,toggleAnnotations:this.props.toggleAnnotations}),r.a.createElement("div",{className:"customimageslider-expand-container"},this.props.windowType===y&&r.a.createElement("button",{onClick:this.props.onModalLaunch},"Expand Post")))}}]),a}(r.a.Component),Ye=He,Je=function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window}(),Ge=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).preventDefault=function(e){e.preventDefault()},n.dragOver=function(e){n.preventDefault(e)},n.dragEnter=function(e){n.preventDefault(e)},n.dragLeave=function(e){n.preventDefault(e)},n.fileDrop=function(e){n.preventDefault(e);var t=e.dataTransfer.files;t.length&&n.handleFiles(t)},n.filesSelected=function(){n.fileInputRef.current.files.length&&n.handleFiles(n.fileInputRef.current.files)},n.fileInputClicked=function(){n.fileInputRef.current.click()},n.handleFiles=function(e){for(var t=!1,a=0;a<e.length;a++)n.validateFile(e[a])?n.props.onSelectedFileChange(e[a]):(t=!0,e[a].invalid=!0,n.props.onSelectedFileChange(e[a]),n.setErrorMessage("File type not permitted"),n.props.onUnsupportedFileChange(e[a]));n.updateDisabilityState(t)},n.fileSize=function(e){if(0===e)return"0 Bytes";var t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][t]},n.fileType=function(e){return e.substring(e.lastIndexOf(".")+1,e.length)||e},n.removeFile=function(e){var t=n.props.validFiles.findIndex(function(t){return t.name===e}),a=n.props.selectedFiles.findIndex(function(t){return t.name===e}),r=n.props.unsupportedFiles.findIndex(function(t){return t.name===e}),i=n.props.validFiles,s=n.props.selectedFiles,o=n.props.unsupportedFiles;i.splice(t,1),s.splice(a,1),n.props.setValidFiles(i),n.props.setSelectedFiles(s),-1!==r&&(o.splice(r,1),n.props.setUnsupportedFiles(o)),i.length>0&&0===o.length?n.updateDisabilityState(!1):n.updateDisabilityState(!0)},n.updateDisabilityState=function(e){e&&0===n.props.tempText.length?n.props.onDisablePost(!0):n.props.onDisablePost(!1)},n.openImageModal=function(e){var t=Object(h.a)(n),a=new FileReader;n.modalRef.current.style.display="block",a.readAsDataURL(e),a.onload=function(e){t.modalImageRef.current.style.backgroundImage="url(".concat(e.target.result,")")}},n.closeModal=function(){n.modalRef.current.style.display="none",n.modalImageRef.current.style.backgroundImage="none"},n.fileInputRef=r.a.createRef(),n.state={errorMessage:""},n.setErrorMessage=n.setErrorMessage.bind(Object(h.a)(n)),n.validateFile=n.validateFile.bind(Object(h.a)(n)),n.renderTextContainer=n.renderTextContainer.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"setErrorMessage",value:function(e){this.setState({value:e})}},{key:"validateFile",value:function(e){return-1!==["image/jpeg","image/jpg","image/png","image/gif","image/x-icon"].indexOf(e.type)}},{key:"renderTextContainer",value:function(){return r.a.createElement(Ve,{validFilesLength:this.props.validFiles.length,isPaginated:this.props.isPaginated,onPaginatedChange:this.props.onPaginatedChange,onTextChange:this.props.onTextChange,tempText:this.props.tempText,imageIndex:this.props.imageIndex})}},{key:"render",value:function(){return Je||console.log("Sorry, this is not a modern browser! Try another browser."),0===this.props.validFiles.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"shorteditor-text"},this.renderTextContainer()),this.props.unsupportedFiles.length?r.a.createElement("p",null,"Please remove all unsupported files."):"",r.a.createElement(Ne,{reference:this.fileInputRef,dragOver:this.dragOver,dragEnter:this.dragEnter,dragLeave:this.dragLeave,fileDrop:this.fileDrop,fileInputClicked:this.fileInputClicked,filesSelected:this.filesSelected})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"shorteditor-main"},r.a.createElement("div",{id:"shorteditor-hero"},this.props.unsupportedFiles.length?r.a.createElement("p",null,"Please remove all unsupported files."):"",r.a.createElement("div",{id:"shorteditor-images"},r.a.createElement(Ye,{newPost:!0,hideAnnotations:!0,windowType:y,imageArray:this.props.imageArray,imageIndex:this.props.imageIndex,onArrowPress:this.props.handleArrowPress,activeAnnotations:[]}))),r.a.createElement("div",{id:"shorteditor-side-container"},this.renderTextContainer())),r.a.createElement("div",{id:"shorteditor-files"},r.a.createElement(Ne,{reference:this.fileInputRef,dragOver:this.dragOver,dragEnter:this.dragEnter,dragLeave:this.dragLeave,fileDrop:this.fileDrop,fileInputClicked:this.fileInputClicked,filesSelected:this.filesSelected}),r.a.createElement("div",null,r.a.createElement("h4",null,"Drag Your Images To Rearrange Your Photos")),r.a.createElement(Ue,{onSortEnd:this.props.onSortEnd,validFiles:this.props.validFiles,openImageModal:this.openImageModal,removeFile:this.removeFile,fileType:this.fileType,fileSize:this.fileSize,errorMessage:this.state.errorMessage})))}}]),a}(r.a.Component),Ke=T(Ge),ze=function(e){var t=e.isPostDisabled?"shortpostinitial-nav-button-disabled":"shortpostinitial-nav-button-enabled";return r.a.createElement("div",{id:"shortpostinitial",className:"draft-window"},r.a.createElement("h2",{id:"shortpostinitial-title"},"Short Post"),e.isCompressing&&r.a.createElement("p",null,"Compressing Photos"),r.a.createElement("div",{className:"shortpostinitial-nav"},r.a.createElement("div",{id:"shortpostinitial-discard"},r.a.createElement("button",{className:"shortpostinitial-nav-button-enabled",onClick:e.onModalClose},"Discard")),r.a.createElement(Le,{current:e.window}),r.a.createElement("div",{id:"shortpostinitial-review"},r.a.createElement("button",{className:t,value:2,disabled:e.isPostDisabled,onClick:function(t){return e.setPostStage(t.target.value)}},"Review Meta"))),r.a.createElement("div",{id:"shortpostinitial-title"},r.a.createElement(_e.a,{id:"shortpostinitial-input",placeholder:"Title",onChange:function(t){return e.editorFunctions.onTextChange(t.target.value,!0)},minRows:2,value:e.previewTitle})),r.a.createElement(Ke,Object.assign({isPaginated:e.isPaginated},e.editorFunctions,e.editorStates)))},qe=function(e){return r.a.createElement("div",{className:"btn-meta"},r.a.createElement("label",null,"Date"),r.a.createElement("input",{type:"date",id:"datainput-content",value:e.date,onChange:function(t){return e.setDate(t.target.value)}}))},Xe=function(e){return r.a.createElement("div",{className:"btn-meta"},r.a.createElement("label",null,"Difficulty"),r.a.createElement("div",{className:"input-slider"},r.a.createElement("input",{id:"difficultyinput-slider",defaultValue:e.difficulty,type:"range",step:1,min:0,max:2,onClick:function(t){return e.setDifficulty(t.target.value)}}),r.a.createElement("p",null,e.displayDifficulty(e.difficulty))))},Qe=function(e){return r.a.createElement("div",{className:"btn-meta"},r.a.createElement("label",null,"Total Minutes"),r.a.createElement("input",{id:"minutesinput-number",type:"number",value:e.minDuration,min:0,onChange:function(t){return e.setMinDuration(t.target.value)}}))},$e=function(e){return r.a.createElement("div",{className:"btn-meta"},r.a.createElement("label",null,"Post Title"),r.a.createElement(_e.a,{name:"title",id:"titleinput-text",placeholder:"Create an Optional Title Text",value:e.title?e.title:null,onChange:function(t){return e.setTitle(t.target.value,!0)},minRows:2,maxLength:100}))},Ze=function(e){switch(/^\d+$/.test(e)&&(e=parseInt(e)),e){case 0:return null;case 1:return"Challenging";case 2:return"Difficult";default:throw new Error("No Difficulty matched")}},et=function(e){var t=new Date(e);return{month:["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()],day:t.getDate(),year:t.getFullYear()}},tt=function(e){return e?e<1?" Is Your Local Neighbor":e<7?" Is Your City Neighbor":e<39?" Is Your County Neighbor":e<100?" Is Your Next City Over Neighbor":e<500?" Is Your State Neighbor":" Is Your Super Far Away Neighbor Who Lives "+Math.floor(e)+" miles from you":null},at=function(e){return r.a.createElement("div",{id:"prepostcontrols"},r.a.createElement("p",null,"Post to:"),r.a.createElement("div",null,r.a.createElement("select",{name:"posts",value:e.postPrivacyType?e.postPrivacyType:"PUBLIC_FEED",onChange:function(t){return e.setPostPrivacyType(t.target.value)}},r.a.createElement("option",{value:"PRIVATE"},"Make post private on your page"),r.a.createElement("option",{value:"PERSONAL_PAGE"},"Make post public on your page:"),r.a.createElement("option",{value:"PUBLIC_FEED"},"Post to your feed and page"))))},nt=function(e){return r.a.createElement("div",{id:"metastage",className:"draft-window"},r.a.createElement("h2",{id:"metastage-title"},"Post Info"),r.a.createElement("div",{className:"metastage-nav"},r.a.createElement("div",{id:"metastage-prev"},r.a.createElement("button",{value:e.previousState,onClick:function(t){return e.setPostStage(t.target.value)}},"Return")),r.a.createElement(Le,{current:2}),r.a.createElement("div",{id:"metastage-next"},r.a.createElement("button",{value:e.previousState+2,onClick:function(t){return e.setPostStage(t.target.value)}},"Review Series"))),r.a.createElement("div",null,r.a.createElement("div",{id:"metastage-desc"},r.a.createElement("h4",null,"Post"),r.a.createElement("p",null,"Add any additional information you'd like before you submit your post!")),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement($e,{title:e.previewTitle,setTitle:e.handleTitleChange}),r.a.createElement(qe,{date:e.date,setDate:e.setDate}),r.a.createElement(Qe,{minDuration:e.minDuration,setMinDuration:e.setMinDuration}),r.a.createElement(Xe,{difficulty:e.difficulty,displayDifficulty:Ze,setDifficulty:e.setDifficulty})),r.a.createElement("div",null,r.a.createElement("label",null,"Tags"),r.a.createElement(se,{options:e.pastLabels,selectedLabels:e.selectedLabels,name:"Tags",onSelect:e.setLabels})),r.a.createElement("div",{className:"reviewstage-button-container"},r.a.createElement(at,{postPrivacyType:e.postPrivacyType,setPostPrivacyType:e.setPostPrivacyType})))))},rt=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={window:1,selectedFiles:[],unsupportedFiles:[],imageArray:[],postDisabled:!0},n.warnModalClose=n.warnModalClose.bind(Object(h.a)(n)),n.setSelectedFiles=n.setSelectedFiles.bind(Object(h.a)(n)),n.setValidFiles=n.setValidFiles.bind(Object(h.a)(n)),n.setUnsupportedFiles=n.setUnsupportedFiles.bind(Object(h.a)(n)),n.setImageArray=n.setImageArray.bind(Object(h.a)(n)),n.handleUnsupportedFileChange=n.handleUnsupportedFileChange.bind(Object(h.a)(n)),n.handleSelectedFileChange=n.handleSelectedFileChange.bind(Object(h.a)(n)),n.handleDisablePost=n.handleDisablePost.bind(Object(h.a)(n)),n.generateValidFiles=n.generateValidFiles.bind(Object(h.a)(n)),n.handleSortEnd=n.handleSortEnd.bind(Object(h.a)(n)),n.loadImage=n.loadImage.bind(Object(h.a)(n)),n.transformImageProp=n.transformImageProp.bind(Object(h.a)(n)),n.createTinyFiles=n.createTinyFiles.bind(Object(h.a)(n)),n.handleArrowPress=n.handleArrowPress.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"warnModalClose",value:function(){window.confirm("Do you want to discard this post?")&&this.props.closeModal()}},{key:"transformImageProp",value:function(e){var t=this,a=e,n=e.length>0;Promise.all(a.map(function(e){return t.loadImage(e)})).then(function(a){a.length<t.state.displayedItemCount&&!0,t.setState({imageArray:a,displayedItemCount:a.length,isCompressing:n},function(){console.log(e.length),n&&t.createTinyFiles(e)})})}},{key:"createTinyFiles",value:function(e){var t=this;console.log(e);var a,n=[],r=Object(F.a)(e);try{for(r.s();!(a=r.n()).done;){var i=a.value;n.push(Object(V.a)(i,{maxSizeMB:1}))}}catch(s){r.e(s)}finally{r.f()}n.push(Object(V.a)(e[0],{maxSizeMB:.5,maxWidthOrHeight:250})),Promise.all(n).then(function(e){for(var a=new File([e[e.length-1]],"Thumbnail"),n=[],r=0;r<e.length-1;r++)n.push(new File([e[r]],e[1].name));t.setState({isCompressing:!1},function(){return t.props.setPhotoData(a,n)})})}},{key:"loadImage",value:function(e){return new Promise(function(t,a){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(){a(n.error)},n.readAsDataURL(e)})}},{key:"setImageArray",value:function(e){this.setState({imageArray:e})}},{key:"setSelectedFiles",value:function(e){this.setState({selectedFiles:e},this.generateValidFiles)}},{key:"setValidFiles",value:function(e){this.transformImageProp(e)}},{key:"setUnsupportedFiles",value:function(e){this.setState({unsupportedFiles:e})}},{key:"handleArrowPress",value:function(e,t){e.stopPropagation();var a=this.props.imageIndex+t;return a===this.state.imageArray.length?this.props.onIndexChange(0):-1===a?this.props.onIndexChange(this.props.compressedPhotos.length-1):this.props.onIndexChange(a)}},{key:"handleUnsupportedFileChange",value:function(e){this.setState(function(t){return{unsupportedFiles:t.unsupportedFiles.concat(e)}})}},{key:"handleSelectedFileChange",value:function(e){this.setState(function(t){return{selectedFiles:t.selectedFiles.concat(e)}},this.generateValidFiles)}},{key:"handleDisablePost",value:function(e){this.setState({postDisabled:e})}},{key:"generateValidFiles",value:function(){var e=this.state.selectedFiles.reduce(function(e,t){return e.find(function(e){return e.name===t.name})?e:e.concat([t])},[]);this.setValidFiles(e)}},{key:"handleSortEnd",value:function(e){var t=e.oldIndex,a=e.newIndex,n=Array.from(this.props.compressedPhotos),r=n.splice(t,1),i=Object(o.a)(r,1)[0];n.splice(a,0,i),this.transformImageProp(n)}},{key:"render",value:function(){var e=0===this.props.compressedPhotos.length||this.state.unsupportedFiles.length>0;if(1===this.props.window){var t={onModalClose:this.warnModalClose,setPostStage:this.props.setPostStage},a={previewTitle:this.props.previewTitle,isPostDisabled:0===this.props.tempText.length&&e,isCompressing:this.state.isCompressing,window:this.props.window},n={selectedFiles:this.state.selectedFiles,validFiles:this.props.compressedPhotos,imageArray:this.state.imageArray,unsupportedFiles:this.state.unsupportedFiles,tempText:this.props.tempText,imageIndex:this.props.imageIndex},i={onSortEnd:this.handleSortEnd,setImageArray:this.setImageArray,handleArrowPress:this.handleArrowPress,onSelectedFileChange:this.handleSelectedFileChange,onUnsupportedFileChange:this.handleUnsupportedFileChange,onDisablePost:this.handleDisablePost,setValidFiles:this.setValidFiles,setSelectedFiles:this.setSelectedFiles,setUnsupportedFiles:this.setUnsupportedFiles,onPaginatedChange:this.props.onPaginatedChange,onTextChange:this.props.onTextChange};return r.a.createElement(ze,Object.assign({},a,t,this.props.initialDraftObject,{isPaginated:this.props.isPaginated,editorStates:n,editorFunctions:i}))}if(2===this.props.window){var s={previousState:1,setPostStage:this.props.setPostStage,handleTitleChange:this.props.onTextChange},o={closeModal:this.props.closeModal};return r.a.createElement(nt,Object.assign({},s,o,this.props.metaObject,this.props.metaFunctions))}if(3===this.props.window)return r.a.createElement("div",{className:"draft-window"},r.a.createElement(xe,Object.assign({},this.props.threadObject,this.props.threadFunction,{previousState:2,closeModal:this.props.closeModal,setPostStage:this.props.setPostStage,setDraft:this.props.setDraft})))}}]),a}(r.a.Component),it=rt,st=a(29),ot=(a(87),a(88),function(e){if(e.eventData.image_data.length){var t=e.eventData.image_data,a=[];return e.eventData.image_data.length>0&&(a=(a=t).map(function(e){return ve(e)})),r.a.createElement("div",{id:"shortreeditor-main"},r.a.createElement("div",{id:"shortreeditor-hero",className:"short-post-hero-image-container"},r.a.createElement(Ye,{isReEdit:!0,hideAnnotations:!0,onArrowPress:e.onArrowPress,imageIndex:e.imageIndex,imageArray:a})),r.a.createElement("div",{id:"shortreeditor-side",className:"short-post-side-container"},r.a.createElement(Ve,{validFilesLength:e.eventData.image_data.length,isPaginated:e.isPaginated,onPaginatedChange:e.onPaginatedChange,onTextChange:e.onTextChange,tempText:e.tempText,imageIndex:e.imageIndex})))}return r.a.createElement(Ve,{validFilesLength:e.eventData.image_data.length,isPaginated:e.isPaginated,onPaginatedChange:e.onPaginatedChange,onTextChange:e.onTextChange,tempText:e.tempText,imageIndex:e.imageIndex})}),lt=function(e){return r.a.createElement(_e.a,{ref:e.reference,className:e.classStyle,minRows:e.minRows,onChange:function(t){return e.handleTextChange(t.target.value)},value:e.commentText,style:{width:"120%"}})},ct=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={overallVoteScore:n.props.score,previousVote:0,isReplyBoxToggled:!1,replyText:"",replies:[]},n.toggleReplyBox=n.toggleReplyBox.bind(Object(h.a)(n)),n.setReplyText=n.setReplyText.bind(Object(h.a)(n)),n.handleVote=n.handleVote.bind(Object(h.a)(n)),n.postReply=n.postReply.bind(Object(h.a)(n)),n.renderReply=n.renderReply.bind(Object(h.a)(n)),n.isReplyTextInvalid=n.isReplyTextInvalid.bind(Object(h.a)(n)),n.renderThreadIndicators=n.renderThreadIndicators.bind(Object(h.a)(n)),n.cancelTextInput=n.cancelTextInput.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){this.props.likes.includes(this.props.visitorProfilePreviewID)?this.setState({previousVote:1}):this.props.dislikes.includes(this.props.visitorProfilePreviewID)&&this.setState({previousVote:-1})}},{key:"setReplyText",value:function(e){this.setState({replyText:e})}},{key:"toggleReplyBox",value:function(){this.setState(function(e){return{isReplyBoxToggled:!e.isReplyBoxToggled}})}},{key:"handleVote",value:function(e){var t=this,a=this.state.overallVoteScore,n=this.state.previousVote,r=n+e,i=r>-1&&r<1?e:r,s=e,o=e;return(r<-1||r>1)&&(s=0),r<-1&&(o=1),r>1?o=-1:0===r&&(-1===n?o=2:1===n&&(o=-2)),this.setState({overallVoteScore:a+o,previousVote:s}),fe.voteOnComment(this.props.visitorProfilePreviewID,this.props.commentID,i).then(function(e){console.log(e)}).catch(function(e){console.log(e),console.log("Something went wrong with the server."),t.setState({overallVoteScore:a,previousVote:n})})}},{key:"isReplyTextInvalid",value:function(){return 0===this.state.replyText.replaceAll("\\s+","").length||0===this.state.replyText.length}},{key:"postReply",value:function(){var e=this;if(!this.isReplyTextInvalid()){var t=this.props.ancestors;return t.push(this.props.commentID),fe.postReply(this.props.postID,this.props.visitorProfilePreviewID,JSON.stringify(t),this.state.replyText).then(function(t){alert("Comment added! Refresh the page to see!"),e.renderReply(t.data,e.props.level),e.toggleReplyBox(!1)}).catch(function(e){return console.log(e)})}alert("You need to write something")}},{key:"cancelTextInput",value:function(){this.isReplyTextInvalid()?this.setState({replyText:"",isReplyBoxToggled:!1}):window.confirm("Are you sure you want discard your comment?")&&this.setState({isReplyBoxToggled:!1})}},{key:"renderThreadIndicators",value:function(e){for(var t=[],a=0;a<e;a++)t.push(r.a.createElement("div",{key:this.props.commentID+"inner"+2*Math.random(),className:"singlecomment-thread-indicator-inner"}));return t}},{key:"renderReply",value:function(e,t){var n=t+1,i=e.annotation?JSON.parse(e.annotation.data):null,s=e.comment?e.comment:i.text,o=this.state.replies;o.push(r.a.createElement(a,{key:n,hasAnnotation:!!i,level:n,postID:this.props.postID,visitorProfilePreviewID:this.props.visitorProfilePreviewID,commentID:e._id,ancestors:e.ancestor_post_ids,username:e.username,commentText:s,likes:e.likes,dislikes:e.dislikes,displayPhoto:this.props.displayPhoto,score:e.score,annotation:i,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut,onMouseClick:this.props.onMouseClick})),this.setState({replies:o}),console.log(this.state.replies)}},{key:"render",value:function(){var e=this,t=this.props.level>1?"singlecomment-threads":"",a=this.props.displayPhoto?ve(this.props.displayPhoto):ce.TEMP_PROFILE_PHOTO_URL;return r.a.createElement("div",null,r.a.createElement("div",{className:t},this.props.level>1&&r.a.createElement("div",{className:"singlecomment-thread-indicator"},this.renderThreadIndicators(this.props.level-1)),r.a.createElement("div",{className:"singlecomment-main"},r.a.createElement("div",{className:"singlecomment-header"},r.a.createElement("div",{className:"singlecomment-dp"},r.a.createElement("img",{alt:"Single Comment Display Photo Url",src:a})),r.a.createElement("div",{className:"singlecomment-username-container"},r.a.createElement("p",null,this.props.username))),r.a.createElement("div",{className:"singlecomment-body"},r.a.createElement("div",{className:"singlecomment-thread-indicator"},this.renderThreadIndicators(1)),r.a.createElement("div",{className:"singlecomment-main"},this.props.hasAnnotation&&r.a.createElement("div",{className:"singlecomment-annotation-indicator"},"Annotation"),r.a.createElement("div",{className:"singlecomment-comment",onMouseOver:function(){return e.props.onMouseOver(e.props.commentID)},onMouseOut:function(){return e.props.onMouseOut(e.props.commentID)},onClick:function(){return e.props.onMouseClick(e.props.commentID)}},r.a.createElement("pre",null,this.props.commentText)),r.a.createElement("div",{className:"singlecomment-management"},r.a.createElement("button",{onClick:function(){return e.handleVote(1)}},"Upvote"),r.a.createElement("p",null,this.state.overallVoteScore),r.a.createElement("button",{onClick:function(){return e.handleVote(-1)}},"Downvote"),r.a.createElement("button",{onClick:function(){return e.toggleReplyBox()}},"Reply")),r.a.createElement("div",null,this.state.isReplyBoxToggled&&r.a.createElement(r.a.Fragment,null,r.a.createElement(lt,{classStyle:"",minRows:4,handleTextChange:this.setReplyText,commentText:this.state.replyText}),r.a.createElement("button",{onClick:this.cancelTextInput},"Cancel"),r.a.createElement("button",{onClick:this.postReply},"Reply"))))))),r.a.createElement("div",{key:"Reply"+this.props.level},this.state.replies))}}]),a}(r.a.Component),ut=ct,dt=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={commentText:"",selectedCommentThread:!1,loadingComments:!0},n.setCommentThread=n.setCommentThread.bind(Object(h.a)(n)),n.renderCommentSectionType=n.renderCommentSectionType.bind(Object(h.a)(n)),n.renderCommentInput=n.renderCommentInput.bind(Object(h.a)(n)),n.renderCommentThreads=n.renderCommentThreads.bind(Object(h.a)(n)),n.recursiveRenderComments=n.recursiveRenderComments.bind(Object(h.a)(n)),n.handleCommentTextChange=n.handleCommentTextChange.bind(Object(h.a)(n)),n.handleCommentPost=n.handleCommentPost.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;return this.props.commentIDArray.length>0?this.props.visitorUsername?fe.getComments(this.props.commentIDArray,this.props.windowType).then(function(t){e.setState({loadingComments:!1},function(){e.props.postType,e.props.passAnnotationData(t.data.rootComments)})}):void fe.getComments(JSON.stringify(this.props.commentIDArray),this.props.windowType).then(function(t){e.setState({loadingComments:!1},function(){e.props.passAnnotationData(t.data.rootComments)})}):this.setState({loadingComments:!1},function(){"SHORT"===e.props.postType&&e.props.passAnnotationData(null)})}},{key:"setCommentThread",value:function(e){var t=this,a=e?[e]:this.props.commentIDArray;return fe.getComments(JSON.stringify(a),this.props.windowType).then(function(a){return t.setState({loadingComments:!1,selectedCommentThread:!!e},function(){t.props.passAnnotationData(a.data.rootComments)})})}},{key:"handleCommentTextChange",value:function(e){this.setState({commentText:e})}},{key:"handleCommentPost",value:function(){var e=this;return fe.postComment(this.props.visitorProfilePreviewID,this.state.commentText,this.props.postID,0).then(function(t){var a=t.data.rootCommentIDArray;return fe.refreshComments(JSON.stringify(a)).then(function(t){e.props.onCommentDataInjection(e.props.selectedIndex,t.data.rootComments)})}).then(function(){return alert("Success!")})}},{key:"renderCommentSectionType",value:function(e){if(this.state.loadingComments||!this.props.fullCommentData)return r.a.createElement("div",null,"Loading...");if(e===y)return this.renderCommentThreads(this.props.fullCommentData);if("EXPANDED"===e)return this.renderCommentThreads(this.props.fullCommentData);throw new Error("No viewing modes matched")}},{key:"recursiveRenderComments",value:function(e,t){var a=this,n=t+1,i=e.annotation?JSON.parse(e.annotation.data):null,s=e.comment?e.comment:i.text;if(e.replies){var o=[],l=[],c=n%14===0&&e.replies.length>0;if(e.replies.sort(function(e,t){return e.createdAt<t.createdAt?-1:e.createdAt>t.createdAt?1:0}),c)for(var u=0;u<n;u++)l.push(r.a.createElement("div",{key:this.props.commentID+"inner"+2*Math.random(),className:"singlecomment-thread-indicator"}));else{var d,p=Object(F.a)(e.replies);try{for(p.s();!(d=p.n()).done;){var h=d.value;o.push(this.recursiveRenderComments(h,n))}}catch(m){p.e(m)}finally{p.f()}}return r.a.createElement("div",{key:e._id},r.a.createElement(ut,{level:n,postID:this.props.postID,visitorProfilePreviewID:this.props.visitorProfilePreviewID,visitorUsername:this.props.visitorUsername,commentID:e._id,ancestors:e.ancestor_post_ids,username:e.username,commentText:s,score:e.score,likes:e.likes,dislikes:e.dislikes,displayPhoto:e.display_photo_key,annotation:i,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut,onMouseClick:this.props.onMouseClick}),c?r.a.createElement("div",{className:"singlecomment-multiple-thread-style"},r.a.createElement("div",{className:"singlecomment-thread-indicator-container"},l),r.a.createElement("button",{className:"comments-extended-thread",value:e._id,onClick:function(){return a.setCommentThread(e._id)}},"Continue this thread \u2192")):r.a.createElement("div",{className:"comments-reply-container"},o))}return r.a.createElement("div",{key:e._id+"outer"},r.a.createElement(ut,{hasAnnotation:!!i,level:n,postID:this.props.postID,visitorProfilePreviewID:this.props.visitorProfilePreviewID,commentID:e._id,ancestors:e.ancestor_post_ids,username:e.username,commentText:s,likes:e.likes,dislikes:e.dislikes,displayPhoto:e.display_photo_key,score:e.score,annotation:i,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut,onMouseClick:this.props.onMouseClick}))}},{key:"renderCommentThreads",value:function(e){var t,a=[],n=Object(F.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a.push(this.recursiveRenderComments(r,0))}}catch(i){n.e(i)}finally{n.f()}return a}},{key:"renderCommentInput",value:function(e){return this.props.visitorUsername?r.a.createElement("div",{className:e===y?"comments-collapsed":"comments-expanded"},r.a.createElement(lt,{reference:this.props.reference,classStyle:e===y?"comments-collapsed-input":"comments-expanded-input",minRows:4,handleTextChange:this.handleCommentTextChange,commentText:this.state.commentText}),r.a.createElement("div",null,r.a.createElement("button",{className:0===this.state.commentText.trim().length?"comments-button-disabled":"comments-button",disabled:0===this.state.commentText.trim().length,onClick:this.handleCommentPost},"Add Comment"),this.props.isImageOnly&&r.a.createElement("button",{className:"comments-button",onClick:this.props.onPromptAnnotation},"Annotate"))):r.a.createElement("div",null,r.a.createElement("p",null,"You must sign in before you can leave a comment."))}},{key:"render",value:function(){var e=this;return this.props.windowType===y?r.a.createElement("div",{className:"comments-main"},this.renderCommentSectionType(y),this.renderCommentInput(y)):"EXPANDED"===this.props.windowType?r.a.createElement("div",{className:"comments-main"},this.renderCommentInput("EXPANDED"),this.state.selectedCommentThread&&r.a.createElement("button",{id:"comments-return",className:"comments-extended-thread",onClick:function(){return e.setCommentThread(null)}},"\u2190 Return To Parent Thread"),this.renderCommentSectionType("EXPANDED"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null)):void 0}}]),a}(r.a.Component),pt=dt,ht=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),i=a[0],s=a[1];return!e.editProjectState&&e.isOwnProfile?r.a.createElement("div",null,r.a.createElement("div",{id:"hiddenbuttons-overlay",onClick:function(){return s(!i)}}),r.a.createElement("div",{id:"hiddenbuttons"},r.a.createElement("button",{onClick:function(){return s(!i)}},"..."),i&&r.a.createElement("div",{id:"hiddenbuttons-options"},r.a.createElement("button",{id:"hiddenbuttons-options-edit",onClick:function(){return e.onEditClick(2)}},"Edit"),r.a.createElement("button",{id:"hiddenbuttons-options-remove",onClick:e.onDeletePost},"Remove")))):null},mt=function(e){return r.a.createElement("div",{id:"activitybuttons"},r.a.createElement(ht,{editProjectState:e.editProjectState,isOwnProfile:e.isOwnProfile,onEditClick:e.onEditClick,onDeletePost:e.onDeletePost}))},vt=function(e){return e.needsSideCaption?r.a.createElement("div",{className:"captiontext"},r.a.createElement("h2",null,e.title),r.a.createElement("p",null,e.isPaginated&&e.textData?e.textData[e.imageIndex]:e.textData)):null},Et=function(e){var t=e.labels.map(function(e,t){return r.a.createElement("div",{key:t,className:"eventlabels-background"},r.a.createElement("div",{className:"eventlabels-foreground"},r.a.createElement("p",null,e.label)))});return r.a.createElement("div",{id:e.isFullPage?"eventlabels-full":"eventlabels-partial"},t)},ft=function(e){var t,a,n=Ze(e.difficulty);return e.isMetaToggled?r.a.createElement("div",null,r.a.createElement("div",{className:"metainfo-stat"},r.a.createElement("div",{className:"metainfo-stat-inner metainfo-right-border"},r.a.createElement("p",null,"Difficulty"),r.a.createElement("h4",null," ",n||"-.-")),r.a.createElement("div",{className:"metainfo-stat-inner metainfo-right-border"},r.a.createElement("p",null,"Minutes"),r.a.createElement("h4",null," ",e.minDuration?e.minDuration:"-.-")),r.a.createElement("div",{className:"metainfo-stat-inner"},r.a.createElement("p",null,"Labels"),(null!==(t=null===(a=e.labels)||void 0===a?void 0:a.length)&&void 0!==t?t:0)>0&&r.a.createElement(Et,{isFullPage:e.isFullPage,labels:e.labels})))):null},bt=function(e){var t=e.isPaginated&&e.textData?e.textData[e.imageIndex]:e.textData,a=t.length<1e3?"tiny-text":"medium-text";return r.a.createElement("div",null,e.isLargeViewMode&&r.a.createElement("div",{className:"shortherotext-title-container"},r.a.createElement("h2",null,e.title)),r.a.createElement("div",{id:a},r.a.createElement("pre",null,t)))},gt=function(e){return r.a.createElement("div",{className:"thread"},r.a.createElement("h2",null,e.pursuit.toUpperCase()),r.a.createElement("h4",null,"|"),e.projectPreview&&r.a.createElement("a",{href:pe(e.projectPreview.project_id)},e.projectPreview.title))},Pt=function(e){return r.a.createElement("div",{className:"postheader-author"},r.a.createElement("div",{className:"postheader-dp"},r.a.createElement("a",{href:"/u/"+e.username},r.a.createElement("img",{alt:"profile",src:ve(e.displayPhoto)}))),r.a.createElement("div",{className:"postheader-meta"},r.a.createElement("a",{href:"/u/"+e.username},r.a.createElement("h4",null,e.username))))},St=function(e){return e.hasImages?r.a.createElement("div",{className:"shortpostviewer"},r.a.createElement("div",{id:"shortpostviewer-large-hero"},e.annotations&&e.renderImageSlider("EXPANDED"),r.a.createElement("div",{className:"shortpostviewer-large-side  short-post-side-container",ref:e.heroRef},r.a.createElement(gt,e.meta),r.a.createElement(Pt,e.user),r.a.createElement(ft,Object.assign({isLargeViewMode:!0},e.meta)),r.a.createElement(vt,Object.assign({needsSideCaption:!0},e.caption)),r.a.createElement(mt,Object.assign({},e.header,e.activityFunctions)))),e.renderComments("EXPANDED")):r.a.createElement("div",{className:"shortpostviewer"},r.a.createElement(gt,e.meta),r.a.createElement(Pt,e.user),r.a.createElement(ft,Object.assign({isLargeViewMode:!0},e.meta)),r.a.createElement(vt,e.caption),r.a.createElement("div",{className:"shortpostviewer-large-hero-text"},r.a.createElement(bt,Object.assign({isLargeViewMode:!0},e.caption)),r.a.createElement(mt,Object.assign({},e.header,e.activityFunctions))),e.renderComments("EXPANDED"))},Ot=function(e){return e.windowWidth>600?r.a.createElement("div",{className:"shortpostviewer-inline",onClick:e.onModalLaunch},r.a.createElement("div",{className:"shortpostviewer-inline-hero"},r.a.createElement("div",{className:"shortpostviewer-inline-side"},r.a.createElement(gt,e.meta)),r.a.createElement("div",{className:"shortherotext-title-container"},e.caption.title&&r.a.createElement("h2",{className:"shortpostviewer-title"}," ",e.caption.title)),r.a.createElement("div",{className:"shortpostviewer-secondary-header"},r.a.createElement(Pt,e.user),r.a.createElement("div",{className:"shortpostviewer-date"},e.date&&r.a.createElement("h4",null,e.date.month,", ",e.date.day,", ",e.date.year," "))),e.annotations&&e.renderImageSlider(y,e.windowWidth),r.a.createElement("p",null,e.caption.isPaginated&&e.caption.textData?e.caption.textData[e.caption.imageIndex]:e.caption.textData)),e.renderComments(y)):r.a.createElement("p",null,"page too small")},yt=function(e){var t=e.meta.date?et(e.meta.date):null;return e.hasImages?r.a.createElement(Ot,{date:t,annotations:e.annotations,meta:e.meta,caption:e.caption,user:e.user,renderImageSlider:e.renderImageSlider,renderComments:e.renderComments,onModalLaunch:e.onModalLaunch,windowWidth:e.windowWidth}):r.a.createElement("div",{className:"shortpostviewer-inline"},r.a.createElement("div",{className:"shortpostviewer-inline-hero"},r.a.createElement("div",{className:"shortpostviewer-inline-side"},r.a.createElement(gt,e.meta)),r.a.createElement("div",{className:"shortherotext-title-container"},e.caption.title&&r.a.createElement("h2",null,e.caption.title)),r.a.createElement("div",{className:"shortpostviewer-secondary-header"},r.a.createElement(Pt,e.user),r.a.createElement("div",{className:"shortpostviewer-date"},t&&r.a.createElement("h4",null,t.month,", ",t.day,", ",t.year," "))),r.a.createElement("div",{className:"shortpostviewer-inline-hero"},r.a.createElement(bt,e.caption))),r.a.createElement("div",{className:"shortpostviewer-inline-comments"},e.renderComments(y)))},jt=function(e,t){return e&&(null===t||void 0===t?void 0:t.project_id)?function(e,t){var a,n=0,r=Object(F.a)(e);try{for(r.s();!(a=r.n()).done;){if(a.value.content_id===t)return e[n].content_id;n++}}catch(i){r.e(i)}finally{r.f()}return null}(e,t.project_id):null},Dt=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.state={annotations:null,activeAnnotations:[],fullCommentData:[],areAnnotationsHidden:!0,selectedAnnotationIndex:null,showPromptOverlay:!1,projectPreview:null,isMetaToggled:!1},n.heroRef=r.a.createRef(),n.commentRef=r.a.createRef(),n.toggleAnnotations=n.toggleAnnotations.bind(Object(h.a)(n)),n.passAnnotationData=n.passAnnotationData.bind(Object(h.a)(n)),n.returnValidAnnotations=n.returnValidAnnotations.bind(Object(h.a)(n)),n.renderComments=n.renderComments.bind(Object(h.a)(n)),n.renderImageSlider=n.renderImageSlider.bind(Object(h.a)(n)),n.handleArrowPress=n.handleArrowPress.bind(Object(h.a)(n)),n.handlePromptAnnotation=n.handlePromptAnnotation.bind(Object(h.a)(n)),n.handleMouseOver=n.handleMouseOver.bind(Object(h.a)(n)),n.handleMouseOut=n.handleMouseOut.bind(Object(h.a)(n)),n.handleMouseClick=n.handleMouseClick.bind(Object(h.a)(n)),n.handleAnnotationSubmit=n.handleAnnotationSubmit.bind(Object(h.a)(n)),n.handleModalLaunch=n.handleModalLaunch.bind(Object(h.a)(n)),n.handleCommentDataInjection=n.handleCommentDataInjection.bind(Object(h.a)(n)),n.deletePostCallback=n.deletePostCallback.bind(Object(h.a)(n)),n.handleDeletePost=n.handleDeletePost.bind(Object(h.a)(n)),n.loadProjectPreview=n.loadProjectPreview.bind(Object(h.a)(n)),n.setMetaToggle=n.setMetaToggle.bind(Object(h.a)(n)),n.jumpToComment=n.jumpToComment.bind(Object(h.a)(n)),n.findAnnotation=n.findAnnotation.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){if(this._isMounted=!0,this._isMounted){for(var e=[],t=0;t<this.props.eventData.image_data.length;t++)e.push([]);this.setState({annotations:e},this.loadProjectPreview)}}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"setMetaToggle",value:function(e){e.stopPropagation(),this.setState({isMetaToggled:!this.state.isMetaToggled})}},{key:"jumpToComment",value:function(){this.commentRef.current.scrollIntoView({block:"center"}),this.commentRef.current.focus()}},{key:"loadProjectPreview",value:function(){var e=this,t=this.props.eventData.project_preview_id;if(t&&!this.props.projectPreviewMap[t])return fe.getSingleProjectPreview(t).then(function(t){e.setState({projectPreview:t.data},function(){return e.props.intermSaveProjectPreview?e.props.intermSaveProjectPreview(t.data):e.props.saveProjectPreview?e.props.saveProjectPreview(t.data):void 0})});var a=this.props.projectPreviewMap[t];this.setState({projectPreview:a,selectedDraft:jt(this.props.drafts,a)},function(){})}},{key:"deletePostCallback",value:function(){var e=this;return fe.deletePost(this.props.userPreviewID,this.props.profileID,this.props.indexProfileID,this.props.eventData._id,this.props.pursuit,this.props.minDuration).then(function(t){e.props.projectID?window.location.replace("/c/"+e.props.projectID):window.location.replace("/u/"+e.props.eventData.username)}).catch(function(e){console.log(e),alert("Something went wrong during deletion")})}},{key:"handleDeletePost",value:function(){var e=this;if(this.props.eventData.image_data.length){var t=this.props.eventData.image_data;return this.props.eventData.cover_photo_key&&t.push(this.props.eventData.cover_photo_key),fe.deleteManyPhotosByKey(t).then(function(t){return e.deletePostCallback()})}return this.deletePostCallback()}},{key:"toggleAnnotations",value:function(){this.state.areAnnotationsHidden?this.setState({areAnnotationsHidden:!1,annotateButtonPressed:!1}):this.setState({areAnnotationsHidden:!0,selectedAnnotationIndex:null,annotateButtonPressed:!1})}},{key:"passAnnotationData",value:function(e){var t=this.state.annotations;if(e){var a,n=Object(F.a)(e);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(r.annotation){var i=JSON.parse(r.annotation.data),s=JSON.parse(r.annotation.geometry);t[r.annotation.image_page_number].push({geometry:s,data:Object(u.a)(Object(u.a)({},i),{},{id:r._id})})}}}catch(o){n.e(o)}finally{n.f()}}this.setState({fullCommentData:e||[],annotations:t})}},{key:"returnValidAnnotations",value:function(){if(this.state.annotations){var e=this.state.annotations[this.props.imageIndex];return null!==this.state.selectedAnnotationIndex?[e[this.state.selectedAnnotationIndex]]:e}return[]}},{key:"renderComments",value:function(e){if("EXPANDED"===e){if(this.props.disableCommenting)return null;var t=!!this.props.eventData.image_data.length;return r.a.createElement("div",null,r.a.createElement(pt,{reference:this.commentRef,postType:"SHORT",commentIDArray:this.props.eventData.comments,fullCommentData:this.state.fullCommentData,isImageOnly:t,windowType:e,visitorUsername:this.props.username,visitorProfilePreviewID:this.props.userPreviewID,postID:this.props.eventData._id,selectedIndex:this.props.selectedIndex,onCommentDataInjection:this.handleCommentDataInjection,onPromptAnnotation:this.handlePromptAnnotation,passAnnotationData:this.passAnnotationData,onMouseClick:this.handleMouseClick,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut}))}if(e===y){var a=this.state.isMetaToggled?"Hide Meta Info":"Show Meta Info",n=this.props.initialViewerObject,i=0!==n.difficulty||n.minDuration||n.labels.length>0;return r.a.createElement("div",{className:"shortpostviewer-bottom-info"},r.a.createElement("div",{className:"shortpostviewer-bottom-bar "},r.a.createElement("p",null,this.props.eventData.comment_count," Comments"),r.a.createElement("button",{className:i?"shortpostviewer-showmeta-enabled":"shortpostviewer-showmeta-disabled",disabled:!i,onClick:this.setMetaToggle},a)),r.a.createElement("div",null,r.a.createElement(ft,Object.assign({isMetaToggled:this.state.isMetaToggled},this.props.initialViewerObject))))}}},{key:"renderImageSlider",value:function(e,t){var a=this.props.largeViewMode?"shortpostviewer-large-hero-image short-post-hero-image-container":"shortpostviewer-inline-hero",n=this.props.eventData.image_data.map(function(e,t){return ve(e)});return r.a.createElement("div",{className:a},r.a.createElement(Ye,{sliderClassName:a,editProjectState:this.props.editProjectState,windowType:e,hideAnnotations:this.state.areAnnotationsHidden,imageArray:n,activeAnnotations:this.state.activeAnnotations,imageIndex:this.props.imageIndex,showPromptOverlay:this.state.showPromptOverlay,annotateButtonPressed:this.state.annotateButtonPressed,areAnnotationsHidden:this.state.areAnnotationsHidden,visitorProfilePreviewID:this.props.userPreviewID,annotations:this.returnValidAnnotations(),onAnnotationSubmit:this.handleAnnotationSubmit,toggleAnnotations:this.toggleAnnotations,onArrowPress:this.handleArrowPress,onModalLaunch:this.handleModalLaunch}))}},{key:"handleArrowPress",value:function(e,t){var a=this;e.stopPropagation();var n=this.props.imageIndex+t,r=this.props.eventData.image_data.length;return n===r?(this.setState({selectedAnnotationIndex:null}),function(){return a.props.onIndexChange(0)}):-1===n?(this.setState({selectedAnnotationIndex:null}),function(){return a.props.onIndexChange(r-1)}):this.setState({selectedAnnotationIndex:null},function(){return a.props.onIndexChange(n)})}},{key:"handleCommentDataInjection",value:function(e,t,a){var n=this,r=this.props.eventData.comments,i=t[t.length-1]._id;r.push(i),this.setState({fullCommentData:t},function(){null===n.props.selectedIndex||n.props.isPostOnlyView||n.props.onCommentIDInjection(e,r,a)})}},{key:"handlePromptAnnotation",value:function(){this.heroRef.current.scrollIntoView({block:"center"}),this.setState({areAnnotationsHidden:!1,annotateButtonPressed:!0})}},{key:"handleMouseOver",value:function(e){this.setState({activeAnnotations:[].concat(Object(st.a)(this.state.activeAnnotations),[e])})}},{key:"handleMouseOut",value:function(e){var t=this.state.activeAnnotations.indexOf(e);this.setState({activeAnnotations:[].concat(Object(st.a)(this.state.activeAnnotations.slice(0,t)),Object(st.a)(this.state.activeAnnotations.slice(t+1)))})}},{key:"findAnnotation",value:function(e){this.props.onIndexChange(e),this.heroRef.current.scrollIntoView({block:"center"})}},{key:"handleMouseClick",value:function(e){var t,a=0,n=Object(F.a)(this.state.annotations);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.length>0){var i,s=0,o=Object(F.a)(r);try{for(o.s();!(i=o.n()).done;){if(i.value.data.id===e)return this.setState({selectedAnnotationIndex:s,areAnnotationsHidden:!1},this.findAnnotation(a));s++}}catch(l){o.e(l)}finally{o.f()}}a++}}catch(l){n.e(l)}finally{n.f()}}},{key:"handleAnnotationSubmit",value:function(e){var t=this,a=e.geometry,n=e.data;fe.postAnnotation(this.props.userPreviewID,this.props.eventData._id,this.props.imageIndex,JSON.stringify(n),JSON.stringify(a)).then(function(e){var r=e.data.rootCommentIDArray,i=e.data.newRootComment,s=t.state.annotations[t.props.imageIndex].concat({geometry:a,data:Object(u.a)(Object(u.a)({},n),{},{id:r[0]})}),o=t.state.annotations,l=t.state.fullCommentData;return l.push(i),o[t.props.imageIndex]=s,t.setState({annotations:o,commentArray:r,fullCommentData:l,annotateButtonPressed:!1})}).catch(function(e){console.log(e),alert("Sorry, your annotation could not be added.")})}},{key:"handleModalLaunch",value:function(){if(!this.props.isPostOnlyView)return this.props.setModal(this.props.eventData,"SHORT",this.props.postIndex)}},{key:"render",value:function(){var e=this,t=this.props.isPostOnlyView?"shortpostviewer-post-view":"shortpostviewer-modal-view",a=this.props.username===this.props.eventData.username;if(1===this.props.window){var n,i=(null===(n=this.props.eventData.image_data)||void 0===n?void 0:n.length)>0,s={header:{isOwnProfile:a,editProjectState:this.props.editProjectState},user:{displayPhoto:this.props.eventData.display_photo_key,username:this.props.eventData.username},caption:{title:this.props.eventData.title,textData:this.props.tempText,isPaginated:this.props.isPaginated,imageIndex:this.props.imageIndex},meta:Object(u.a)(Object(u.a)({},this.props.initialViewerObject),{},{projectPreview:this.state.projectPreview}),hasImages:i,annotations:this.state.annotations,renderImageSlider:this.renderImageSlider,renderComments:this.renderComments};return this.props.largeViewMode?r.a.createElement("div",{id:t},r.a.createElement(St,Object.assign({heroRef:this.heroRef,activityFunctions:{jumpToComment:this.jumpToComment,onEditClick:this.props.setPostStage,onDeletePost:this.handleDeletePost}},s))):r.a.createElement(yt,Object.assign({windowWidth:this.props.windowWidth},s))}if(2===this.props.window)return r.a.createElement("div",{id:t,className:"shortpostviewer-window"},r.a.createElement("h2",null,"Edit your Post!"),r.a.createElement("div",{className:"shortpostviewer-nav"},r.a.createElement("div",{className:"shortpostviewer-prev"},r.a.createElement("button",{className:"shortpostviewer-buttons",onClick:function(){return e.props.setPostStage(1)}},"Return")),r.a.createElement(Le,{current:1}),r.a.createElement("div",{className:"shortpostviewer-next"},r.a.createElement("button",{className:"shortpostviewer-buttons",onClick:function(){return e.props.setPostStage(3)}},"Review Post"))),r.a.createElement(ot,{imageIndex:this.props.imageIndex,eventData:this.props.eventData,tempText:this.props.tempText,isPaginated:this.props.isPaginated,onArrowPress:this.handleArrowPress,onTextChange:this.props.onTextChange,onPaginatedChange:this.props.onPaginatedChange}));if(3===this.props.window){var o={previousState:2,setPostStage:this.props.setPostStage,handleTitleChange:this.handleTextChange};return r.a.createElement("div",{id:t},r.a.createElement(nt,Object.assign({},o,this.props.metaObject,this.props.metaFunctions)))}if(4===this.props.window){var l={useImageForThumbnail:this.state.useImageForThumbnail};return r.a.createElement("div",{id:t},r.a.createElement(xe,Object.assign({isUpdateToPost:!0,isPostOnlyView:this.props.isPostOnlyView},l,this.props.threadObject,this.props.threadFunction,{previousState:3,textData:this.props.tempText,closeModal:this.props.closeModal,setPostStage:this.props.setPostStage,setDraft:this.props.setDraft})))}throw new Error("No stage matched")}}]),a}(r.a.Component),It=Dt,wt=function(e,t){var a=new FormData;return function(e,t){e.append(be.USERNAME_FIELD,t.username),e.append(be.USER_ID_FIELD,t.profileID),e.append(be.INDEX_USER_ID_FIELD,t.indexProfileID),e.append(be.USER_PREVIEW_ID_FIELD,t.userPreviewID),t.smallCroppedDisplayPhotoKey&&e.append(be.DISPLAY_PHOTO_FIELD,t.smallCroppedDisplayPhotoKey)}(a,e),function(e,t){e.append(be.STATUS_FIELD,be.DRAFT),e.append(be.THREAD_TITLE_FIELD,t.threadTitle),e.append(be.PURSUIT_FIELD,t.selectedPursuit),e.append(be.THREAD_TITLE_PRIVACY_FIELD,t.titlePrivacy)}(a,t),fe.createProject(a)},Tt=function(e,t,a,n){(n?fe.updatePost(e):fe.createPost(e)).then(function(e){var n,r;t.setIsSubmitting(!1),201===e.status||200===e.status?function(e,t){alert("Post Successful! You will see your post soon."),e||t(),window.location.reload()}(a,t.closeModal):(n=t.setLoading,r=t.setError,n(!1),r(!0))}).catch(function(e){t.setIsSubmitting(!1),alert(e)})},Ct=function(e,t){return e&&t?e.find(function(e){return e.project_preview_id===t.project_preview_id}):null},_t=function(e){return e&&e.is_paginated?JSON.parse(e.text_data):""},kt=function(e){return{label:e,value:e}},Mt=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n,r,i;Object(d.a)(this,a),(i=t.call(this,e))._isMounted=!1;var s=null!==(n=null===(r=i.props.viewerObject)||void 0===r?void 0:r.eventData)&&void 0!==n?n:null;return i.state={window:1,imageIndex:0,date:(null===s||void 0===s?void 0:s.date)?new Date(s.date).toISOString().substring(0,10):(new Date).toISOString().substr(0,10),difficulty:s?s.difficulty:0,isPaginated:!!s&&s.is_paginated,minDuration:s?s.min_duration:null,previewTitle:s?s.title:"",postPrivacyType:s?s.post_privacy_type:i.props.authUser.preferredPostType,tempText:_t(s),compressedPhotos:[],coverPhoto:null,labels:s?s.labels.map(kt):null,selectedPursuit:s?s.pursuit_category:null,isNewSeriesToggled:!1,titlePrivacy:!1,threadTitle:"",isCompleteProject:!1,selectedDraft:i.props.authUser?Ct(i.props.authUser.drafts,s):null},i.setLabels=i.setLabels.bind(Object(h.a)(i)),i.setDraft=i.setDraft.bind(Object(h.a)(i)),i.setSelectedPursuit=i.setSelectedPursuit.bind(Object(h.a)(i)),i.setThreadTitle=i.setThreadTitle.bind(Object(h.a)(i)),i.setMinDuration=i.setMinDuration.bind(Object(h.a)(i)),i.setDate=i.setDate.bind(Object(h.a)(i)),i.setDifficulty=i.setDifficulty.bind(Object(h.a)(i)),i.setPostPrivacyType=i.setPostPrivacyType.bind(Object(h.a)(i)),i.setThreadToggleState=i.setThreadToggleState.bind(Object(h.a)(i)),i.setTitlePrivacy=i.setTitlePrivacy.bind(Object(h.a)(i)),i.setIsCompleteProject=i.setIsCompleteProject.bind(Object(h.a)(i)),i.setPreviewTitle=i.setPreviewTitle.bind(Object(h.a)(i)),i.setPhotoData=i.setPhotoData.bind(Object(h.a)(i)),i.setDifficulty=i.setDifficulty.bind(Object(h.a)(i)),i.setPostStage=i.setPostStage.bind(Object(h.a)(i)),i.handleIndexChange=i.handleIndexChange.bind(Object(h.a)(i)),i.setIsPaginated=i.setIsPaginated.bind(Object(h.a)(i)),i.handleSubmit=i.handleSubmit.bind(Object(h.a)(i)),i.retrieveThumbnail=i.retrieveThumbnail.bind(Object(h.a)(i)),i.handleTextChange=i.handleTextChange.bind(Object(h.a)(i)),i.handlePaginatedChange=i.handlePaginatedChange.bind(Object(h.a)(i)),i}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e;this._isMounted=!0,this._isMounted&&this.props.isViewer&&function(e,t){if(!t&&(!e.saveProjectPreview||!e.setModal||!e.onCommentIDInjection||!e.saveProjectPreview))throw new Error("Missing Modal and Comment Functions")}(this.props.viewerFunctions,null===(e=this.props.viewerObject)||void 0===e?void 0:e.isPostOnlyView)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"setPhotoData",value:function(e,t){this.setState({coverPhoto:e,compressedPhotos:t})}},{key:"handleTextChange",value:function(e,t){if(t)this.setPreviewTitle(e);else{var a=this.state.tempText;this.state.isPaginated?a[this.state.imageIndex]=e:a=e,this.setState({tempText:a})}}},{key:"handlePaginatedChange",value:function(){var e=this;if(!1===this.state.isPaginated){for(var t=this.props.isViewer?this.props.viewerObject.eventData.image_data.length:this.state.compressedPhotos.length,a=[],n=0;n<t;n++)n===this.state.imageIndex?a.push(this.state.tempText):a.push("");this.setState({tempText:a},function(){return e.setIsPaginated(!0)})}else if(window.confirm("Switching back will remove all your captions except \n                          for the first one. Keep going?")){var r=this.state.tempText[0];this.setState({tempText:r},function(){return e.setIsPaginated(!1)})}}},{key:"handleIndexChange",value:function(e){this.setState({imageIndex:e})}},{key:"setPreviewTitle",value:function(e){this.setState({previewTitle:e})}},{key:"retrieveThumbnail",value:function(){var e,t=this,a=this.props.viewerObject.eventData;if((null===(e=a.image_data)||void 0===e?void 0:e.length)>0)return fe.returnImage(a.image_data[0]).then(function(e){return fetch(e.data.image)}).then(function(e){return e.blob()}).then(function(e){var t=new File([e],"Thumbnail",{type:e.type});return Object(V.a)(t,{maxSizeMB:.5,maxWidthOrHeight:250})}).then(function(e){return t.setState({coverPhoto:e})})}},{key:"setPostStage",value:function(e){var t,a=parseInt(e),n=2===a&&this.props.isViewer?this.props.viewerObject.textData:"";this.props.isViewer&&!(null===(t=this.props.viewerObject.eventData)||void 0===t?void 0:t.cover_photo_key)&&2===e?(this.retrieveThumbnail(),this.setState({window:a,tempText:n})):(this.props.isViewer&&1===e&&window.confirm("Do you want to stop editing your posts?"),this.setState({window:a}))}},{key:"setDifficulty",value:function(e){this.setState({difficulty:e})}},{key:"setLabels",value:function(e){this.setState({labels:e})}},{key:"setDraft",value:function(e){this.setState({selectedDraft:e})}},{key:"setSelectedPursuit",value:function(e){this.setState({selectedPursuit:e})}},{key:"setThreadTitle",value:function(e){this.setState({threadTitle:e})}},{key:"setMinDuration",value:function(e){this.setState({minDuration:e})}},{key:"setDate",value:function(e){this.setState({date:e})}},{key:"setPostPrivacyType",value:function(e){this.setState({postPrivacyType:e})}},{key:"setThreadToggleState",value:function(e){this.setState({isNewSeriesToggled:e})}},{key:"setTitlePrivacy",value:function(e){this.setState({titlePrivacy:e})}},{key:"setIsCompleteProject",value:function(e){this.setState({isCompleteProject:e})}},{key:"setIsPaginated",value:function(e){this.setState({isPaginated:e})}},{key:"handleSubmit",value:function(e){var t,a,n,r=this,i=this.props.isViewer,s=Promise.resolve(),o=new FormData,l={textData:this.state.tempText,previewTitle:this.state.previewTitle},c={postPrivacyType:this.state.postPrivacyType,difficulty:this.state.difficulty,labels:this.state.labels,date:this.state.date,minDuration:this.state.minDuration,isPaginated:this.state.isPaginated},d={username:this.props.authUser.username,userPreviewID:this.props.authUser.userPreviewID,indexProfileID:this.props.authUser.indexProfileID,profileID:this.props.authUser.profileID,smallCroppedDisplayPhotoKey:this.props.authUser.smallCroppedDisplayPhotoKey},p={selectedDraft:this.state.selectedDraft,isCompleteProject:this.state.isCompleteProject},h={threadTitle:this.state.threadTitle,selectedPursuit:this.state.selectedPursuit,titlePrivacy:this.state.titlePrivacy},m=Object(u.a)(Object(u.a)(Object(u.a)({},l),c),d);if(function(e,t){if(e.append(be.USERNAME_FIELD,t.username),e.append(be.IS_PAGINATED_FIELD,t.isPaginated),e.append(be.DIFFICULTY_FIELD,t.difficulty),e.append(be.USER_PREVIEW_ID_FIELD,t.userPreviewID),e.append(be.INDEX_USER_ID_FIELD,t.indexProfileID),t.date&&e.append(be.DATE_FIELD,t.date),t.smallCroppedDisplayPhotoKey&&e.append(be.DISPLAY_PHOTO_FIELD,t.smallCroppedDisplayPhotoKey),t.previewTitle&&e.append(be.TITLE_FIELD,B.a.trim(t.previewTitle)),t.postPrivacyType&&e.append(be.POST_PRIVACY_TYPE_FIELD,t.postPrivacyType),t.minDuration&&e.append(be.MIN_DURATION_FIELD,t.minDuration),t.labels){var a,n=Object(F.a)(t.labels);try{for(n.s();!(a=n.n()).done;){var r=a.value;e.append(be.LABELS_FIELD,r.value)}}catch(s){n.e(s)}finally{n.f()}}if(t.textData){var i=t.isPaginated?JSON.stringify(t.textData):t.textData;e.append(be.TEXT_DATA_FIELD,i)}}(o,m),function(e,t){t.selectedDraft&&(e.append(be.THREAD_TITLE_PRIVACY_FIELD,t.titlePrivacy),e.append(be.SELECTED_DRAFT_ID,t.selectedDraft.content_id))}(o,p),function(e,t,a){a&&(e.append(be.POST_ID_FIELD,t._id),e.append(be.PROJECT_PREVIEW_ID_FIELD,t.project_preview_id))}(o,null!==(t=null===(a=this.props.viewerObject)||void 0===a?void 0:a.eventData)&&void 0!==t?t:null,i),this.state.compressedPhotos.length>0){var v={coverPhoto:this.state.coverPhoto,imageArray:this.state.compressedPhotos};!function(e,t){if(e.append(be.COVER_PHOTO_FIELD,t.coverPhoto),t.imageArray&&t.imageArray.length>0){var a,n=Object(F.a)(t.imageArray);try{for(n.s();!(a=n.n()).done;){var r=a.value;e.append(be.IMAGES_FIELD,r)}}catch(i){n.e(i)}finally{n.f()}}}(o,v)}return this.state.isNewSeriesToggled&&(s=s.then(function(){return wt(d,h)}).then(function(e){return function(e,t){var a=e.data.id,n=e.data.project_preview_id;return t.set(be.PROJECT_PREVIEW_ID_FIELD,e.data.project_preview_id),t.append(be.SELECTED_DRAFT_ID,e.data.id),{content_id:a,project_preview_id:n}}(e,o)})),i&&(null===(n=this.props.viewerObject)||void 0===n?void 0:n.eventData.project_preview_id)!==this.state.selectedDraft.project_preview_id&&(s=s.then(function(e){var t,a=r.state.isNewSeriesToggled?e:r.state.selectedDraft;return function(e,t,a){return e.set(be.PROJECT_PREVIEW_ID_FIELD,a.newProjectPreviewID),fe.updatePostOwner(a.oldProjectPreviewID,a.newProjectID,t)}(o,r.props.viewerObject.eventData._id,{newProjectID:a.content_id,newProjectPreviewID:a.project_preview_id,oldProjectPreviewID:null===(t=r.props.viewerObject)||void 0===t?void 0:t.eventData.project_preview_id})})),s=s.then(function(){var t,a;return Tt(o,e,null!==(t=null===(a=r.props.viewerObject)||void 0===a?void 0:a.isPostOnlyView)&&void 0!==t&&t,r.props.isViewer)})}},{key:"render",value:function(){var e={pastLabels:this.props.authUser.labels,userPreviewID:this.props.authUser.userPreviewID,profileID:this.props.authUser.profileID,indexProfileID:this.props.authUser.indexProfileID,username:this.props.authUser.username,drafts:this.props.authUser.drafts,pursuitNames:this.props.authUser.pursuits},t={window:this.state.window,imageIndex:this.state.imageIndex,isPaginated:this.state.isPaginated,tempText:this.state.tempText,modalState:this.props.modalState,compressedPhotos:this.state.compressedPhotos,setDraft:this.setDraft,setPostStage:this.setPostStage,setIsPaginated:this.setIsPaginated,setPreviewTitle:this.setPreviewTitle,onIndexChange:this.handleIndexChange,onTextChange:this.handleTextChange,onPaginatedChange:this.handlePaginatedChange},a={previewTitle:this.state.previewTitle},n=Object(u.a)({},a),i=Object(u.a)(Object(u.a)({},a),{},{date:this.state.date,labels:this.state.labels,minDuration:this.state.minDuration,difficulty:this.state.difficulty,pursuit:this.state.selectedPursuit}),s=Object(u.a)(Object(u.a)({},a),{},{date:this.state.date,difficulty:this.state.difficulty,pastLabels:this.props.authUser.labels,selectedLabels:this.state.labels,minDuration:this.state.minDuration,postPrivacyType:this.state.postPrivacyType,threadTitle:this.state.threadTitle,titlePrivacy:this.state.titlePrivacy}),o={setDate:this.setDate,setDifficulty:this.setDifficulty,setLabels:this.setLabels,setMinDuration:this.setMinDuration,setPostPrivacyType:this.setPostPrivacyType},l={date:this.state.date,drafts:this.props.authUser.drafts,selectedDraft:this.state.selectedDraft,selectedPursuit:this.state.selectedPursuit,isCompleteProject:this.state.isCompleteProject,pursuitNames:this.props.authUser.pursuits,threadTitle:this.state.threadTitle,titlePrivacy:this.state.titlePrivacy,threadToggleState:this.state.isNewSeriesToggled},c={setThreadTitle:this.setThreadTitle,setTitlePrivacy:this.setTitlePrivacy,setSelectedPursuit:this.setSelectedPursuit,setIsCompleteProject:this.setIsCompleteProject,handleSubmit:this.handleSubmit,setThreadToggleState:this.setThreadToggleState};return this.props.isViewer?r.a.createElement(It,Object.assign({},e,this.props.viewerObject,this.props.viewerFunctions,t,{initialViewerObject:i,metaObject:s,metaFunctions:o,threadObject:l,threadFunction:c,intermSaveProjectPreview:this.props.intermSaveProjectPreview})):r.a.createElement(it,Object.assign({},e,t,{initialDraftObject:n,metaObject:s,metaFunctions:o,threadObject:l,threadFunction:c,setPhotoData:this.setPhotoData,closeModal:this.props.closeModal}))}}]),a}(r.a.Component),Rt=T(Mt),Lt=function(e){if("POST_VIEWER_MODAL_STATE"===e.modalState&&e.selected){var t=ee(e.selected),a={key:e.selectedIndex,largeViewMode:!0,textData:t,isPostOnlyView:e.isPostOnlyView,eventData:e.selected,selectedIndex:e.selectedIndex,pursuitObjects:e.pursuitObjects,projectPreviewMap:e.projectPreviewMap},n=r.a.createElement(Rt,{isViewer:!0,viewerObject:a,viewerFunctions:e.viewerFunctions,authUser:e.authUser,closeModal:e.clearModal});return e.returnModalStructure(n,e.clearModal)}return null},xt=function(e){var t=Object(n.useState)(0),a=Object(o.a)(t,2),i=a[0],s=a[1],l=Object(n.useState)(0!==e.following.length),c=Object(o.a)(l,2),d=c[0],p=c[1],h=Object(n.useState)([]),m=Object(o.a)(h,2),v=m[0],E=m[1],f=Object(n.useState)(0),b=Object(o.a)(f,2),g=b[0],P=b[1],S=Object(n.useState)({}),O=Object(o.a)(S,2),y=O[0],j=O[1],D=Object(n.useState)(null),I=Object(o.a)(D,2),w=I[0],T=I[1],C=Object(n.useState)(null),_=Object(o.a)(C,2),k=(_[0],_[1]),M=Object(n.useState)(null),R=Object(o.a)(M,2),L=R[0],x=R[1];Object(n.useEffect)(function(){d&&N(i)},[]);var N=function(t){var a=e.following,n=a.slice(t,t+10),r=10!==n.length,i=r?t+n.length:t+10,o=t>=a.length||r;return fe.returnMultiplePosts(n,!0).then(function(e){if(e.data){var t=e.data.posts;E(v.concat(t)),s(i),P(g+t.length),p(!o)}}).catch(function(e){console.log(e),alert(e)})},A=function(){T(null),e.closeMasterModal()},U={isPostOnlyView:!1,pursuitObjects:e.pursuitObjects,projectPreviewMap:y,windowWidth:e.windowWidth},F={onCommentIDInjection:function(e,t){E(Q(e,t,v))},saveProjectPreview:function(e){if(!y[e._id]){var t=X(y,e);j(t)}},setModal:function(t,a,n){T(t),k(a),x(n),e.openMasterModal("POST_VIEWER_MODAL_STATE")},clearModal:A};return r.a.createElement("div",null,r.a.createElement(Lt,Object.assign({},U,{authUser:e.authUser,modalState:e.modalState,viewerFunctions:F,selected:w,selectedIndex:L,returnModalStructure:e.returnModalStructure,clearModal:A})),r.a.createElement("div",{id:"returninguser-infinite-scroll"},r.a.createElement(Te.a,{dataLength:g,next:function(){return N(i)},hasMore:d,loader:r.a.createElement("h4",null,"Loading..."),endMessage:r.a.createElement("p",{style:{textAlign:"center"}},r.a.createElement("b",null,"Yay! You have seen it all"))},function(t,a,n,i){if(!t||0===t.length)return[];var s=a;return t.map(function(t,a){var o=ee(t),l=Object(u.a)({key:s++,largeViewMode:!1,textData:o,eventData:t},n);return r.a.createElement("div",{key:a,className:"returninguser-feed-object friendfeed-object"},r.a.createElement(Rt,{isViewer:!0,viewerObject:l,viewerFunctions:i,authUser:e.authUser,closeModal:A}))})}(v,i,U,F))))},Nt=function(e){switch(e){case 0:return"parents";case 1:return"siblings";case 2:return"children";default:throw new Error("Unmatched Cached Type")}},At=function(e,t,a){var n=e.matched_pursuit_index=[e.pursuits.findIndex(function(e){return e.name===t})],r=e.pursuits[n].posts,i=r.length>0?r[0].content_id:null;return e.distance=re(e.location.coordinates[0],a.long,e.location.coordinates[1],a.lat),{type:"USER",content:e,data:null,post:i}},Ut=function(e,t,a,n){for(;e<3;){for(var r=a[Nt(e)],i=t;i<r.length;i++)n.push({type:S,post:r[i]});e++}},Ft=function(e){return r.a.createElement("div",{className:e.isSelected?"pursuitobject-selected":"pursuitobject-unselected",onClick:function(){return e.onSelect(e.index,e.pursuit.num_posts)}},r.a.createElement("div",{className:"pursuitobject-pursuit"},r.a.createElement("h4",{key:e.index},(t=e.pursuit.name.toLowerCase()).charAt(0).toUpperCase()+t.slice(1),"\xa0"),!e.isSelected&&r.a.createElement("div",{className:"pursuitobject-num-posts-unselected"},r.a.createElement("p",null," ",e.pursuit.num_posts," Posts"))),e.isSelected&&r.a.createElement("div",{className:"pursuitobject-meta-selected"},r.a.createElement("div",{id:"pursuitobject-num-posts",className:"pursuitobject-thread-container"},r.a.createElement("div",{className:"pursuitobject-num-posts-selected"},r.a.createElement("p",null,"Posts")),r.a.createElement("p",null,e.pursuit.num_posts)),r.a.createElement("div",{className:"pursuitobject-thread-container"},r.a.createElement("p",{className:"pursuitobject-thread-title"},"Showing a Post From"),r.a.createElement("p",{className:"pursuitobject-thread"},e.thread))));var t},Vt=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={thread:null,matchedIndex:n.props.content.matched_pursuit_index[0],selected:n.props.content.matched_pursuit_index[0],altData:null},n.intermSaveProjectPreview=n.intermSaveProjectPreview.bind(Object(h.a)(n)),n.handlePursuitClick=n.handlePursuitClick.bind(Object(h.a)(n)),n.getTitle=n.getTitle.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"intermSaveProjectPreview",value:function(e){this.setState({thread:e.title}),this.props.viewerFunctions.saveProjectPreview(e)}},{key:"handlePursuitClick",value:function(e,t){var a=this;if(0!==t&&this.state.selected!==this.state.matchedIndex+1)return fe.retrievePost(this.props.content.pursuits[e].posts[0].content_id,!1).then(function(t){a.setState({selected:e,altData:t.data})});this.setState({selected:e})}},{key:"getTitle",value:function(e,t){var a;return t?null===(a=e[t])||void 0===a?void 0:a.title:null}},{key:"render",value:function(){var e,t=this,a=this.props.content,n=this.state.selected===this.state.matchedIndex?this.props.data:this.state.altData,i=this.getTitle(this.props.projectPreviewMap,null!==(e=null===n||void 0===n?void 0:n.project_preview_id)&&void 0!==e?e:null);return r.a.createElement("div",{className:"userfeeditem-user"},r.a.createElement("div",{className:"userfeeditem-upper-main"},r.a.createElement("div",{className:"userfeeditem-upper-left"},r.a.createElement("div",{className:"userfeeditem-photo"},r.a.createElement("a",{href:"/u/"+a.username},r.a.createElement("img",{alt:"profile",src:ve(a.displayPhoto)})))),r.a.createElement("div",{className:"userfeeditem-upper-right"},r.a.createElement("h3",{className:"userfeeditem-upper-right-distance"},a.username," ",tt(a.distance)),r.a.createElement("div",{className:"userfeeditem-upper-right-pursuits"},r.a.createElement("h5",null,"Pursuing"),a.pursuits.map(function(e,a){return 0!==a?r.a.createElement(Ft,{key:a,thread:i,pursuit:{name:e.name,num_posts:e.num_posts},index:a,isSelected:a===t.state.selected,onSelect:t.handlePursuitClick}):null})))),!n&&r.a.createElement("div",{className:"userfeeditem-lower-main"},r.a.createElement("p",null,"No Posts Available to Show")),n&&r.a.createElement("div",{className:"userfeeditem-lower-main"},r.a.createElement(Rt,{isViewer:!0,key:n._id,largeViewMode:!0,textData:n.text_data,viewerObject:Object(u.a)(Object(u.a)({},this.props.viewerObject),{},{eventData:n}),viewerFunctions:this.props.viewerFunctions,intermSaveProjectPreview:this.intermSaveProjectPreview,authUser:this.props.authUser})))}}]),a}(r.a.Component),Wt=function(e){for(var t=[],a=1;a<e.length;a++){var n=e[a];t.push({name:n.name,experience:n.experience_level})}return t},Bt=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.state={loading:!0,hasMore:!0,nextOpenPostIndex:0,numOfContent:0,distance:1e15,lat:null,long:null,contentList:[],feedData:[],projectPreviewMap:{},formattedPursuits:Wt(n.props.authUser.pursuits),usedPeople:[n.props.authUser.userPreviewID],dynamic:{beginner:[],familiar:[],experienced:[],expert:[]},selected:null,textData:null,selectedIndex:null},n.debounceFetch=B.a.debounce(function(){return n.fetch()},10),n.fetch=n.fetch.bind(Object(h.a)(n)),n.getContent=n.getContent.bind(Object(h.a)(n)),n.initializeFirstPull=n.initializeFirstPull.bind(Object(h.a)(n)),n.onSuccess=n.onSuccess.bind(Object(h.a)(n)),n.onError=n.onError.bind(Object(h.a)(n)),n.displayFeed=n.displayFeed.bind(Object(h.a)(n)),n.checkValidLocation=n.checkValidLocation.bind(Object(h.a)(n)),n.setCoordinates=n.setCoordinates.bind(Object(h.a)(n)),n.getDynamicFeed=n.getDynamicFeed.bind(Object(h.a)(n)),n.formatFeed=n.formatFeed.bind(Object(h.a)(n)),n.getSpotlight=n.getSpotlight.bind(Object(h.a)(n)),n.mergeData=n.mergeData.bind(Object(h.a)(n)),n.prepareRenderedFeedInput=n.prepareRenderedFeedInput.bind(Object(h.a)(n)),n.handleEventClick=n.handleEventClick.bind(Object(h.a)(n)),n.handleCommentIDInjection=n.handleCommentIDInjection.bind(Object(h.a)(n)),n.saveProjectPreview=n.saveProjectPreview.bind(Object(h.a)(n)),n.setFeedState=n.setFeedState.bind(Object(h.a)(n)),n.setModal=n.setModal.bind(Object(h.a)(n)),n.closeModal=n.closeModal.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"handleEventClick",value:function(e){this.props.passDataToModal(this.state.feedData[e],"EXTRAS_STATE",e)}},{key:"componentDidMount",value:function(){return this._isMounted=!0,fe.getLocation(this.props.authUser.userPreviewID).then(this.checkValidLocation)}},{key:"getSpotlight",value:function(e){var t=this;return fe.getSpotlight(5,e.latitude,e.longitude,[this.props.authUser.userPreviewID]).then(function(e){t.setState({spotlight:e.data.users})})}},{key:"checkValidLocation",value:function(e){204===e.status?navigator.geolocation.getCurrentPosition(this.onSuccess,this.onError,Ce):this.setCoordinates(e.data.coordinates)}},{key:"setCoordinates",value:function(e){this.setState({lat:e[1],long:e[0]},this.getContent)}},{key:"onSuccess",value:function(e){var t=e.coords;this.setState({lat:t.latitude,long:t.longitude},this.initializeFirstPull)}},{key:"onError",value:function(e){console.warn("onError(".concat(e.code,"): ").concat(e.message))}},{key:"displayFeed",value:function(e){return e.map(function(e){return r.a.createElement("p",null,e)})}},{key:"initializeFirstPull",value:function(){var e=this;fe.setLocation(this.state.lat,this.state.long,this.props.authUser.userPreviewID).then(function(t){return alert("Location Set!"),e.getContent()})}},{key:"prepareRenderedFeedInput",value:function(e,t,a){var n=[],r={long:this.state.long,lat:this.state.lat};if(!a){var i=new Set;return function(e,t,a){for(var n=Math.min(e.length,t.length),r=0;r<n;r++)a.push(e[r],t[r]);a.push.apply(a,Object(st.a)(e.slice(n)).concat(Object(st.a)(t.slice(n))))}(function(e,t,a){var n,r=[],i=Object(F.a)(e);try{for(i.s();!(n=i.n()).done;){var s,o=n.value,l=Object(F.a)(o.queue);try{for(l.s();!(s=l.n()).done;){var c=s.value;a.has(c._id)||(r.push(At(c,o.type,t)),a.add(c._id))}}catch(u){l.e(u)}finally{l.f()}}}catch(u){i.e(u)}finally{i.f()}return r}(t,r,i).sort(function(e,t){return e.content.distance-t.content.distance}),function(e){var t=[];return Ut(0,0,e,t),t}(e),n),{contentList:n,keys:i.keys()}}}},{key:"formatFeed",value:function(e){var t=e.data.map(function(e){return function(e){for(var t=0,a=[];e.exact[t]&&e.different[t];)a.push(e.exact[t]),a.push(e.different[t]),t++;for(var n=t,r=t;r<e.exact.length;)a.push(e.exact[r++]);for(;n<e.different.length;)a.push(e.different[n++]);return{type:e.type,queue:a}}(e)}),a=this.prepareRenderedFeedInput(this.props.cached,t),n=a.contentList;return{dynamic:e,usedPeople:Object(st.a)(new Set(this.state.usedPeople.concat(a.usedPeople))),contentList:n}}},{key:"getContent",value:function(){var e=this;return this.getDynamicFeed().then(this.formatFeed).then(function(t){return e.fetch(t)})}},{key:"getDynamicFeed",value:function(){var e=this.state.distance;return fe.getSimilarPeopleAdvanced(e,this.state.formattedPursuits,this.state.usedPeople,this.state.lat,this.state.long)}},{key:"setFeedState",value:function(e,t,a,n,r){return this.setState(Object(u.a)(Object(u.a)({},r),{},{feedData:e,hasMore:t,nextOpenPostIndex:a,numOfContent:n,loading:!1}))}},{key:"mergeData",value:function(e,t){var a={};return t.forEach(function(e){a[e._id]=e}),e.map(function(e){return(e.post?e.post:void 0)&&(e.data=a[e.post]),e})}},{key:"fetch",value:function(e){var t=this;this.debounceFetch.cancel();var a=(e?e.contentList:this.state.contentList).slice(this.state.nextOpenPostIndex,this.state.nextOpenPostIndex+10),n=a.filter(function(e){return!!e.post}).map(function(e){return e.post});if(n.length>0)return fe.returnMultiplePosts(n,!0).then(function(n){var r=t.mergeData(a,n.data.posts),i=t.state.feedData.concat(r),s=10===i.length,o=t.state.nextOpenPostIndex+10,l=t.state.numOfContent+i.length;return t.setFeedState(i,s,o,l,e)}).catch(function(e){return console.log(e)});var r=this.state.feedData.length+a.length,i=this.state.feedData.concat(a),s=r<this.state.contentList.length,o=this.state.nextOpenPostIndex+10,l=this.state.numOfContent+a.length;return this.setFeedState(i,s,o,l,e)}},{key:"saveProjectPreview",value:function(e){if(!this.state.projectPreviewMap[e._id]){var t=X(this.state.projectPreviewMap,e);this.setState({projectPreviewMap:t})}}},{key:"handleCommentIDInjection",value:function(e,t){var a=this.state.feedData;a[e].data.comment_count+=1,this.setState({feedData:a})}},{key:"createFeedRow",value:function(e,t){var a=this;return this._isMounted&&0!==this.state.feedData.length?this.state.feedData.map(function(n,i){var s=Object(u.a)({key:i,largeViewMode:!1,isPostOnlyView:!1,postIndex:i},e);switch(n.type){case S:return s.eventData=n.data,s.textData=n.data.text_data,r.a.createElement("div",{key:i,className:"returninguser-feed-object extrafeed-object"},r.a.createElement(Rt,{isViewer:!0,viewerObject:s,viewerFunctions:t,authUser:a.props.authUser}));case"USER":return r.a.createElement("div",{key:i,className:"returninguser-feed-object"},r.a.createElement(Vt,Object.assign({},n,{lat:a.state.lat,long:a.state.long,viewerObject:s,viewerFunctions:t,authUser:a.props.authUser,projectPreviewMap:a.state.projectPreviewMap})));default:throw new Error("Malformed content type")}}):[]}},{key:"setModal",value:function(e,t,a){var n=this;this.setState({selected:e,textData:t,selectedIndex:a},function(){return n.props.openMasterModal("POST_VIEWER_MODAL_STATE")})}},{key:"closeModal",value:function(){this.setState({selected:null},this.props.closeMasterModal())}},{key:"render",value:function(){var e={pursuitObjects:this.props.pursuitObjects,projectPreviewMap:this.state.projectPreviewMap,windowWidth:this.props.windowWidth},t={onCommentIDInjection:this.handleCommentIDInjection,saveProjectPreview:this.saveProjectPreview,setModal:this.setModal,clearModal:this.closeModal};return this.state.loading?r.a.createElement("p",null,"Loading"):r.a.createElement("div",null,r.a.createElement(Lt,Object.assign({},e,{authUser:this.props.authUser,modalState:this.props.modalState,viewerFunctions:t,selectedIndex:this.state.selectedIndex,selected:this.state.selected,returnModalStructure:this.props.returnModalStructure,clearModal:this.closeModal})),r.a.createElement("div",{id:"returninguser-infinite-scroll"},r.a.createElement(Te.a,{dataLength:this.state.numOfContent,next:this.debounceFetch,hasMore:this.state.hasMore,loader:r.a.createElement("h4",null,"Loading..."),endMessage:r.a.createElement("p",{style:{textAlign:"center"}},r.a.createElement("b",null,"Yay! You have seen it all"))},this.createFeedRow(e,t))))}}]),a}(r.a.Component),Ht=a(38),Yt=function(e){var t=Object(De.m)(),a=et(e.updatedAt);return r.a.createElement("div",{className:"headerobject",onClick:function(){var a=pe(e.project_id);t(a)}},r.a.createElement("div",{className:"headerobject-cover"},e.cover&&r.a.createElement("img",{alt:"cover",src:e.cover})),r.a.createElement("div",{className:"headerobject-text"},r.a.createElement("h2",null,e.title),r.a.createElement("p",null,"Last Updated at ",a.month," ",a.day,", ",a.year),e.overview?r.a.createElement("p",null,e.overview):null,r.a.createElement("div",{className:"headerobject-label"},e.labels?e.labels.map(function(e,t){return r.a.createElement("p",{key:t,className:"headerobject-label-text"},e)}):null)))},Jt=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),i=a[0],s=a[1],l=Object(n.useState)(null),c=Object(o.a)(l,2),u=c[0],d=c[1],p=Object(n.useState)(null),h=Object(o.a)(p,2),m=h[0],v=h[1],E=Object(n.useState)(0),f=Object(o.a)(E,2),b=f[0],g=f[1];Object(n.useEffect)(function(){e.recent&&fe.getSingleProjectPreview(e.recent.project_preview_id).then(function(e){var t=e.data;return d(t),s(!0),fe.getRelatedProjectPreview(t._id,t.labels,t.pursuit).then(function(e){console.log(e),v(e.data)})})},[]);var P=function(e){var t=b+e;g(-1===t?0:3===t?2:t)};return i?r.a.createElement("div",{className:"relatedheader"},r.a.createElement("h3",null,"Journey Spotlight "),m?r.a.createElement("p",{className:"relatedheader-subtext"},"Showing Work From Someone Who's Pursuing Something Similar To Your Most Recent Work"):r.a.createElement("p",{className:"relatedheader-subtext"},"Loading"),r.a.createElement("div",{id:"relatedheader-self-other"},r.a.createElement("div",{id:"relatedheader-self"},r.a.createElement("h2",null,"Yours"),r.a.createElement("div",{id:"relatedheader-self-preview"},r.a.createElement("div",{id:"relatedheader-self-preview-object"},u&&r.a.createElement("h2",null,u.title),u&&r.a.createElement("p",null,u.overview)))),r.a.createElement("div",{id:"relatedheader-other"},r.a.createElement("h2",null,"Theirs"),r.a.createElement("div",{className:"relatedheader-other-preview"},r.a.createElement("button",{disabled:null===m||b-1<0,onClick:function(){return P(-1)}},"Prev"),m?r.a.createElement(Yt,m[b]):r.a.createElement("p",null,"None Found"),r.a.createElement("button",{disabled:null===m||b+1>m.length-1,onClick:function(){return P(1)}},"Next")),m&&r.a.createElement("p",{id:"relatedheader-index"},b+1," of ",m.length," ")))):r.a.createElement("div",{id:"relatedheader"},r.a.createElement("h3",null,"Similar Spotlight "),r.a.createElement("p",null,"Create Your First Post To Start Seeing Suggestions!"),r.a.createElement("div",null))},Gt=void 0,Kt=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.state={username:n.props.firebase.returnUsername(),name:{first:null,last:null},pursuitObjects:null,croppedDisplayPhoto:null,smallCroppedDisplayPhoto:null,indexUserDataID:null,fullUserDataID:null,preferredPostPrivacy:null,followedUserPostIDs:[],nextOpenPostIndex:0,isModalShowing:!1,selectedEvent:null,textData:"",recentPosts:null,recentPostsKey:0,isExtraFeedToggled:!1,windowWidth:null,cached:null},n.handlePursuitClick=n.handlePursuitClick.bind(Object(h.a)(n)),n.handleRecentWorkClick=n.handleRecentWorkClick.bind(Object(h.a)(n)),n.handleEventClick=n.handleEventClick.bind(Object(h.a)(n)),n.setModal=n.setModal.bind(Object(h.a)(n)),n.createPursuits=n.createPursuits.bind(Object(h.a)(n)),n.passDataToModal=n.passDataToModal.bind(Object(h.a)(n)),n.clearModal=n.clearModal.bind(Object(h.a)(n)),n.handleDeletePost=n.handleDeletePost.bind(Object(h.a)(n)),n.toggleFeedState=n.toggleFeedState.bind(Object(h.a)(n)),n.setExtraFeedModal=n.setExtraFeedModal.bind(Object(h.a)(n)),n.setWindowSize=n.setWindowSize.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(this._isMounted=!0,this.setWindowSize(),window.addEventListener("resize",this.setWindowSize),this._isMounted&&this.state.username){var t=this.createPursuits(this.props.authUser.pursuits),a=fe.getCachedFeed(this.props.authUser.cached_feed_id),n=this.props.firebase.returnName();Promise.all([a,n]).then(function(a){e.setState({cached:a[0].data,name:{first:a[1].firstName,last:a[1].lastName},pursuitObjects:t})})}}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,window.removeEventListener("resize",this.setWindowSize)}},{key:"setWindowSize",value:function(){this.setState({windowWidth:window.innerWidth})}},{key:"toggleFeedState",value:function(e){this.setState({isExtraFeedToggled:!e})}},{key:"handleDeletePost",value:function(){return fe.deletePost(this.state.fullUserDataID,this.state.indexUserDataID,this.state.selectedEvent._id).then(function(e){alert(e)})}},{key:"passDataToModal",value:function(e,t,a){this.setState({selectedEvent:e,textData:e.text_data,selectedPostFeedType:"RECENT_POSTS",selectedPostIndex:a},this.setModal())}},{key:"setModal",value:function(){this.props.openMasterModal("POST_VIEWER_MODAL_STATE")}},{key:"setExtraFeedModal",value:function(e,t,a){this.setState({selectedEvent:e,textData:e.text_data,selectedPostFeedType:"SHORT",selectedPostIndex:a},this.setModal())}},{key:"clearModal",value:function(){this.setState({selectedEvent:null},this.props.closeMasterModal())}},{key:"handlePursuitClick",value:function(e){e.preventDefault(),this.props.navigate(this.state.username,{replace:!1})}},{key:"handleRecentWorkClick",value:function(e,t){e.preventDefault(),alert(t)}},{key:"handleEventClick",value:function(e,t,a){this._isMounted&&this.setState({selectedEvent:e,selectedPostIndex:t,selectedPostFeedType:"RECENT_POSTS"},this.setModal())}},{key:"createPursuits",value:function(e){var t,a=[],n=[],i=0,s=Object(F.a)(e);try{for(s.s();!(t=s.n()).done;){var o=t.value;n.push(o.name),i+=o.total_min,a.push(r.a.createElement("tr",{key:o.name},r.a.createElement("th",{key:o.name+" name"},$(o.name)),r.a.createElement("td",{key:o.name+" experience"},o.experience_level),r.a.createElement("td",{key:o.total_min+"minutes"},o.total_min),r.a.createElement("td",{key:o.num_posts+"posts"},o.posts?o.posts.length:0),r.a.createElement("td",{key:o.num_milestones+" milestones"},o.num_milestones)))}}catch(l){s.e(l)}finally{s.f()}return{names:n,pursuitInfoArray:a,totalMin:i}}},{key:"render",value:function(){var e=this,t=null;this.state.pursuitObjects&&(t={pursuitNames:this.state.pursuitObjects.names,pursuitObjects:this.state.pursuitObjects});var a={modalState:this.props.modalState,openMasterModal:this.props.openMasterModal,closeMasterModal:this.props.closeMasterModal,returnModalStructure:this.props.returnModalStructure};return r.a.createElement("div",{id:"returninguser"},r.a.createElement(Jt,{recent:this.props.authUser.recentPosts[0]}),r.a.createElement("div",{id:"returninguser-feed",className:"returninguser-main-row"},r.a.createElement("h4",{className:"returninguser-title"},this.state.isExtraFeedToggled?"People Like You":"Following"),r.a.createElement("label",{className:"switch"},r.a.createElement("input",{type:"checkbox",onChange:function(){return e.toggleFeedState(e.state.isExtraFeedToggled)}}),r.a.createElement("span",{className:"slider round"})),!this.state.isExtraFeedToggled&&this.state.cached&&r.a.createElement("div",{id:"returninguser-infinite-scroll"},r.a.createElement(xt,Object.assign({authUser:this.props.authUser,following:this.state.cached.following,nextOpenPostIndex:this.state.nextOpenPostIndex,fetchNextPosts:this.fetchNextPosts,windowWidth:this.state.windowWidth},t,a))),this.state.isExtraFeedToggled&&r.a.createElement(Bt,Object.assign({authUser:this.props.authUser,cached:this.state.cached,windowWidth:this.state.windowWidth},t,a))))}}]),a}(r.a.Component),zt=function(){Gt.props.firebase.checkIsExistingUser()},qt=we(function(e){return!!e&&T(zt)})(Ie(Kt)),Xt=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.state={isNewUser:null},n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.firebase.checkIsExistingUser().then(function(t){e._isMounted&&(t?e.setState({isNewUser:!1}):e.setState({isNewUser:!0}))})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){return null===this.state.isNewUser?r.a.createElement("div",null,"Grabbing User Info"):this.state.isNewUser?r.a.createElement(Oe,null):r.a.createElement(qt,{authUser:this.props.authUser,returnModalStructure:this.props.returnModalStructure,openMasterModal:this.props.openMasterModal,closeMasterModal:this.props.closeMasterModal,modalState:this.props.modalState})}}]),a}(r.a.Component),Qt=we(function(e){return!!e})(T(Xt)),$t=Object(l.a)(Ie,T)(U),Zt=Object(l.a)(Ie,T)(Qt),ea=T(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ye.Consumer,null,function(t){return t&&t.emailVerified?r.a.createElement(Zt,{authUser:t,returnModalStructure:e.returnModalStructure,openMasterModal:e.openMasterModal,closeMasterModal:e.closeMasterModal,modalState:e.modalState}):r.a.createElement($t,{emailVerifiedStatus:!1})}))}),ta={passwordOne:"",passwordTwo:"",error:null},aa=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state=Object(u.a)({},ta),n.handlePasswordUpdateSubmit=n.handlePasswordUpdateSubmit.bind(Object(h.a)(n)),n.handleTextUpdate=n.handleTextUpdate.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"handlePasswordUpdateSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.passwordOne;this.props.firebase.doPasswordUpdate(a).then(function(){t.setState(Object(u.a)({},ta))}).catch(function(e){t.setState({error:e})})}},{key:"handleTextUpdate",value:function(e){this.setState(Object(c.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){var e=this.state,t=e.passwordOne,a=e.passwordTwo,n=e.error,i=t!==a||""===t;return r.a.createElement("div",{id:"passwordchange"},r.a.createElement("label",{className:"label-form"},"Update Password"),r.a.createElement("form",{className:"form-med",onSubmit:this.handlePasswordUpdateSubmit},r.a.createElement("input",{name:"passwordOne",className:"input-single",value:t,onChange:this.handleTextUpdate,type:"password",placeholder:"New Password"}),r.a.createElement("input",{name:"passwordTwo",className:"input-single",value:a,onChange:this.handleTextUpdate,type:"password",placeholder:"Confirm New Password"}),r.a.createElement("button",{className:"btn-round",disabled:i,type:"submit"},"Reset My Password"),n&&r.a.createElement("p",null,n.message)))}}]),a}(n.Component),na=T(aa),ra=function(e){var t={DISPLAY:{title:"Display Photo",edit:"Edit Display Photo",select:"Select Display Photo",submit:"Submit Display Photo",remove:"Remove Display Photo"},COVER:{title:"Cover Photo",edit:"Edit Cover Photo",select:"Select Cover Photo",submit:"Submit Cover Photo",remove:"Remove Cover Photo"}};return r.a.createElement("div",{id:"photocontainer"},r.a.createElement("label",{className:"label-form"},t[e.type].title),r.a.createElement("button",{className:"btn-round",onClick:function(){e.setIsEditingPhoto(!e.isEditing),e.showPhotoEditor(e.photoRef)}},e.isEditing?"Cancel":t[e.type].edit),r.a.createElement("div",{ref:e.photoRef,className:"photocontainer-file"},r.a.createElement("div",{className:"photocontainer-file-inner"},r.a.createElement("p",null,t[e.type].select),r.a.createElement("input",{type:"file",onChange:function(t){e.setPhoto(t.target.files[0])}}),e.photoExists&&"COVER"!==e.type&&e.profilePhotoEditor,r.a.createElement("button",{className:"btn-round",disabled:!e.photoExists,onClick:function(){return e.submitPhoto(e.type)}},t[e.type].submit)),r.a.createElement("div",{className:"photocontainer-file-inner"},r.a.createElement("p",null,t[e.type].remove),r.a.createElement("button",{className:"btn-round",onClick:function(){return e.removePhoto(e.type)}},t[e.type].remove))))},ia=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),i=a[0],s=a[1],l=Object(n.useState)(!1),c=Object(o.a)(l,2),u=c[0],d=c[1],p=Object(n.useState)(null),h=Object(o.a)(p,2),m=h[0],v=h[1],E=Object(n.useState)(!0),f=Object(o.a)(E,2),b=f[0],g=f[1],P=Object(n.useState)(null),S=Object(o.a)(P,2),O=S[0],y=S[1],j=Object(n.useState)(""),D=Object(o.a)(j,2),I=D[0],w=D[1],T=Object(n.useState)(1),C=Object(o.a)(T,2),_=C[0],k=C[1],M=Object(n.useState)(0),R=Object(o.a)(M,2),L=R[0],x=R[1],N=Object(n.useState)(null),A=Object(o.a)(N,2),U=A[0],F=A[1],W=Object(n.useState)(null),B=Object(o.a)(W,2),H=B[0],Y=B[1],J=Object(n.useState)(0),K=Object(o.a)(J,2),z=K[0],q=K[1],X=r.a.createRef(),Q=r.a.createRef();Object(n.useEffect)(function(){fe.returnAccountSettingsInfo(e.firebase.returnUsername()).then(function(e){var t=e.data.pursuits,a=[];if(t)for(var n in t)a.push(n);g(null!==e.data.cropped_display_photo_key),w(e.data.bio),Y(e.data.private)})},[e.firebase]);var $=function(e){""===e.current.style.display?e.current.style.display="flex":e.current.style.display=""},Z=function(t){var a=e.firebase.returnUsername();window.confirm("Are you sure you want to remove your photo?")&&fe.deleteAccountPhoto(a,t).then(function(){return fe.updatePostDisplayPhotos(a,"")}).then(function(){"DISPLAY"===t?window.alert("Your Display Photo has been removed. \n              You should see the changes take effect soon."):"COVER"===t&&window.alert("Your cover photo has been removed. You should\n               see the changes take effect immediately."),window.location.reload()}).catch(function(e){console.log(e),window.alert("Something went wrong while deleting your image.\n             Please wait and try again later")})},ee=function(e,t,a){return fe.updateAccountImage(e,t).then(function(e){return"COVER"!==t?fe.updatePostDisplayPhotos(a,e.data.imageKey):void 0}).then(function(e){alert("Successfully updated!"),window.location.reload()}).catch(function(e){console.log(e),alert("Something has gone wrong while updating :(")})},te=function(t,a){var n=e.firebase.returnUsername();return b?fe.deleteAccountPhoto(n,a).then(function(e){return ee(t,a,n)}):ee(t,a,n)},ae=function(t){var a=new FormData;if(a.append(be.USERNAME_FIELD,e.firebase.returnUsername()),"DISPLAY"===t){var n=["normal","small","tiny"],r=U.getImage();V.a.canvasToFile(r).then(function(e){return Promise.all([Object(V.a)(e,{maxWidthOrHeight:250,maxSizeMB:1,fileType:"image/jpeg"}),Object(V.a)(e,{maxWidthOrHeight:125,maxSizeMB:1,fileType:"image/jpeg"}),Object(V.a)(e,{maxWidthOrHeight:62,maxSizeMB:1,fileType:"image/jpeg"})])}).then(function(e){for(var r=[],i=0;i<3;i++)r.push(new File([e[i]],n[i],{type:"image/jpeg"}));return a.append(be.CROPPED_IMAGE_FIELD,e[0]),a.append(be.SMALL_CROPPED_IMAGE_FIELD,e[1]),a.append(be.TINY_CROPPED_IMAGE_FIELD,e[2]),te(a,t)})}else if("COVER"===t)return O.size>1e6?Object(V.a)(O,{maxSizeMB:1,fileType:"image/jpeg"}).then(function(e){a.append(be.COVER_PHOTO_FIELD,e),te(a,t)}):(a.append(be.COVER_PHOTO_FIELD,O),te(a,t))},ne=r.a.createElement(G,{clearFile:function(){q(z+1),v(null)},profilePhoto:m,handleImageDrop:function(e){v(e)},imageScale:_,imageRotation:L,scaleImage:k,rotateImage:x,setEditorRef:F});return r.a.createElement("div",{id:"account"},r.a.createElement("h1",null,"Account: ",e.authUser.email),r.a.createElement("div",{className:"account-section"},r.a.createElement(ra,{type:"DISPLAY",isEditing:i,setIsEditingPhoto:s,setPhoto:v,showPhotoEditor:$,photoExists:m,photoRef:X,profilePhotoEditor:ne,submitPhoto:ae,removePhoto:Z})),r.a.createElement("div",{className:"account-section"},r.a.createElement(ra,{type:"COVER",isEditing:u,setIsEditingPhoto:d,setPhoto:y,showPhotoEditor:$,photoExists:O,photoRef:Q,profilePhotoEditor:ne,submitPhoto:ae,removePhoto:Z})),r.a.createElement("div",{className:"account-section"},r.a.createElement("label",{className:"label-form"},"Bio"),r.a.createElement("textarea",{type:"text",onChange:function(e){return w(e.target.value)},value:I,maxLength:500}),r.a.createElement("button",{className:"btn-round",onClick:function(){return fe.updateBio(e.authUser.userPreviewID,e.authUser.indexProfileID,e.authUser.profileID,I).then(function(){alert("Successfully updated your bio!"),window.location.reload()}).catch(function(e){return console.log(e)})}},"Submit Bio")),r.a.createElement("div",{className:"account-section"},r.a.createElement("label",{className:"label-form"},"Choose the privacy of your profile!"),r.a.createElement("select",{value:H?"PRIVATE":"PUBLIC",onChange:function(t){return function(t){var a="PRIVATE"===t;return Y(a),fe.setProfilePrivacy(e.firebase.returnUsername(),a).then(function(e){return alert("Success!")}).catch(function(e){console.log(e),alert("Unable to update Profile Privacy.")})}(t.target.value)}},r.a.createElement("option",{key:"private",value:"PRIVATE"},"Private"),r.a.createElement("option",{key:"public",value:"PUBLIC"},"Public"))),r.a.createElement("div",{className:"account-section"},r.a.createElement(na,null)))},sa=we(function(e){return!!e})(T(function(e){return r.a.createElement(ye.Consumer,null,function(t){return r.a.createElement(ia,Object.assign({},e,{authUser:t}))})})),oa=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this))._isMounted=!1,e.state={userRelationID:null,following:[],followers:[],requested:[]},e.handleStatusChange=e.handleStatusChange.bind(Object(h.a)(e)),e.handleRenderRelation=e.handleRenderRelation.bind(Object(h.a)(e)),e.renderUserRow=e.renderUserRow.bind(Object(h.a)(e)),e.handleDataSet=e.handleDataSet.bind(Object(h.a)(e)),e.handleRelationUpdate=e.handleRelationUpdate.bind(Object(h.a)(e)),e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,fe.returnUserRelationInfo(this.props.username).then(function(t){e._isMounted&&e.handleDataSet(t.data)})}},{key:"handleDataSet",value:function(e){var t=this.handleRenderRelation(this.renderUserRow,e.following,{exists:!0,type:"FOLLOWING"}),a=this.handleRenderRelation(this.renderUserRow,e.followers,{exists:!0,type:"REMOVE"}),n=this.handleRenderRelation(this.renderUserRow,e.requested,{exists:!1,type:"REQUESTED"}),r=this.handleRenderRelation(this.renderUserRow,e.requester,{exists:!1,type:"REQUESTER"});this.setState({userRelationID:e._id,following:t,followers:a,requests:r.concat(n)})}},{key:"handleStatusChange",value:function(e,t,a){var n=this;return fe.setFollowerStatus(t,a,e).then(function(){return fe.returnUserRelationInfo(n.props.username)}).then(function(e){n.handleDataSet(e.data)}).catch(function(e){return window.alert("Something went wrong :(")})}},{key:"handleRelationUpdate",value:function(){}},{key:"renderUserRow",value:function(e,t){var a=this,n=[];if(t.exists){var i,s=Object(F.a)(e);try{var o=function(){var e=i.value;n.push(r.a.createElement("div",{className:"relationmodal-profile-row"},r.a.createElement("div",{className:"relationmodal-profile-info-container"},r.a.createElement("img",{alt:"profile",src:ve(e.display_photo)}),r.a.createElement("a",{href:he(e.username)},e.username)),"FOLLOWING"===t.type?r.a.createElement("button",{className:"relationmodal-button",onClick:function(){return a.handleStatusChange("UNFOLLOW",a.state.userRelationID,e.user_relation_id)}},"Following"):r.a.createElement("button",{className:"relationmodal-button",onClick:function(){return a.handleStatusChange("UNFOLLOW",e.user_relation_id,a.state.userRelationID)}},"Remove")))};for(s.s();!(i=s.n()).done;)o()}catch(d){s.e(d)}finally{s.f()}}else{var l,c=Object(F.a)(e);try{var u=function(){var e=l.value,i="REQUESTED"===t.type?r.a.createElement("div",{className:"relationmodal-reaction"},r.a.createElement("button",{className:"relationmodal-button",onClick:function(){return a.handleStatusChange("ACCEPT",e.user_relation_id,a.state.userRelationID)}},"Accept"),r.a.createElement("button",{className:"relationmodal-button",onClick:function(){return a.handleStatusChange("DECLINE",e.user_relation_id,a.state.userRelationID)}},"Decline")):r.a.createElement("button",{className:"relationmodal-button",onClick:function(){return a.handleStatusChange("UNFOLLOW",a.state.userRelationID,e.user_relation_id)}},"Cancel Request");n.push(r.a.createElement("div",{className:"relationmodal-profile-row"},r.a.createElement("div",{className:"relationmodal-profile-info-container"},r.a.createElement("img",{alt:"profile",src:ve(e.display_photo)}),r.a.createElement("a",{href:he(e.username)},e.username)),i))};for(c.s();!(l=c.n()).done;)u()}catch(d){c.e(d)}finally{c.f()}}return n}},{key:"handleRenderRelation",value:function(e,t,a){return t?e(t,a):null}},{key:"render",value:function(){return r.a.createElement("div",{id:"relationmodal",className:"small-post-window"},r.a.createElement("div",{id:"relationmodal-relations"},r.a.createElement("div",{className:"relationmodal-column"},r.a.createElement("h2",null,"Requests"),this.state.requests),r.a.createElement("div",{className:"relationmodal-column"},r.a.createElement("h2",null,"Followers"),this.state.followers),r.a.createElement("div",{className:"relationmodal-column"},r.a.createElement("h2",null,"Following"),this.state.following)))}}]),a}(r.a.Component),la=function(e){switch(e.modalState){case"NEW_ENTRY_MODAL_STATE":return r.a.createElement(Rt,{authUser:e.authUser,username:e.authUser.username,closeModal:e.closeModal});case"RELATION_MODAL_STATE":return r.a.createElement(oa,{username:e.authUser.username,closeModal:e.closeModal});case"POST_VIEWER_MODAL_STATE":return null;default:throw Error("Modal Controller: Nothing matched")}},ca=function(e){switch(e.linkType){case"NEW_ENTRY_MODAL_STATE":return r.a.createElement("div",{className:"optionallinks-actions"},r.a.createElement("button",{className:"btn-navbar",onClick:function(){return e.setModal("NEW_ENTRY_MODAL_STATE")}},r.a.createElement("h4",null,"+ Add Activity")));case"PEOPLE_SEARCH_STATE":return r.a.createElement("a",{href:"/search"},r.a.createElement("div",{className:"optionallinks-actions btn-navbar-div"},r.a.createElement("h4",null,"People Like You")));case"RELATION_MODAL_STATE":return r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:"/u/".concat(e.username)},r.a.createElement("div",{className:"optionallinks-actions btn-navbar-div"},r.a.createElement("div",{id:"optionallinks-dp"},r.a.createElement("img",{src:e.tinyDisplayPhoto}),r.a.createElement("p",null,e.username)))),r.a.createElement("div",{className:"optionallinks-actions"},r.a.createElement("button",{className:"btn-navbar",onClick:function(){return e.setModal("RELATION_MODAL_STATE")}},r.a.createElement("h4",null,"Friends"))));case"WORKS":return r.a.createElement("a",{href:"/works"},r.a.createElement("div",{className:"optionallinks-actions btn-navbar-div"},r.a.createElement("h4",null,"Published")));default:throw new Error("Nothing matched in Optional-Links")}},ua=T(function(e){return e.showMenu?r.a.createElement("div",{id:"optionsmenu-dropdown"},e.shouldHideFriendsTab?null:r.a.createElement("div",{className:"optionsmenu-dropdown-inner",onClick:function(){return e.closeModal()}},r.a.createElement(Ht.b,{to:"/account"},r.a.createElement("h4",null,"Edit Your Profile"))),r.a.createElement("div",{className:"optionsmenu-dropdown-inner"},r.a.createElement("button",{onClick:function(){e.closeModal(),e.firebase.doSignOut()}},r.a.createElement("h4",null,"Sign Out")))):null}),da=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={showMenu:!1,isUserStillLoading:!0,isExistingUser:!1,isPostModalShowing:!1,isRequestModalShowing:!1},n.showMenu=n.showMenu.bind(Object(h.a)(n)),n.closeMenu=n.closeMenu.bind(Object(h.a)(n)),n.clearModal=n.clearModal.bind(Object(h.a)(n)),n.setModal=n.setModal.bind(Object(h.a)(n)),n.setBasicInfo=n.setBasicInfo.bind(Object(h.a)(n)),n.displayOptionalsDecider=n.displayOptionalsDecider.bind(Object(h.a)(n)),n.linkDecider=n.linkDecider.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.firebase.checkIsExistingUser().then(function(t){var a=e.props.authUser.tinyCroppedDisplayPhotoKey,n=ve(a);e.setBasicInfo(!!t,!1,n)})}},{key:"showMenu",value:function(e){var t=this;e.preventDefault(),this.setState({showMenu:!0},function(){document.addEventListener("click",t.closeMenu)})}},{key:"closeMenu",value:function(){var e=this;this.setState({showMenu:!1},function(){document.removeEventListener("click",e.closeMenu)})}},{key:"setBasicInfo",value:function(e,t,a){this.setState({isExistingUser:e,isUserStillLoading:t,tinyDisplayPhoto:a})}},{key:"setModal",value:function(e){"NEW_ENTRY_MODAL_STATE"===e&&(console.log("hit"),this.setState({isPostModalShowing:!0})),this.props.modalState&&e===this.props.modalState?this.clearModal():(this.clearModal(),this.props.openMasterModal(e))}},{key:"clearModal",value:function(){this.state.isPostModalShowing&&this.setState({isPostModalShowing:!1}),this.props.closeMasterModal()}},{key:"displayOptionalsDecider",value:function(e){return(this.state.isUserStillLoading||!this.state.isUserStillLoading&&this.state.isExistingUser)&&e}},{key:"linkDecider",value:function(){if("/"!==window.location.pathname)this.props.navigate("");else{if("/"!==window.location.pathname.toString())throw new Error("Navbar inputted url doesnt work for some reason");window.location.reload()}}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",null,r.a.createElement("div",{id:"navbar-left"},r.a.createElement(Ht.b,{to:"",className:"navbar-link",onClick:function(){return e.linkDecider()}},r.a.createElement("div",{id:"navbar-logo"},r.a.createElement("h3",null,"Third Space"))),this.displayOptionalsDecider(r.a.createElement(ca,{username:this.props.authUser.username,linkType:"NEW_ENTRY_MODAL_STATE",setModal:this.setModal}))),r.a.createElement("div",{id:"navbar-right"},this.displayOptionalsDecider(r.a.createElement(ca,{username:this.props.authUser.username,linkType:"RELATION_MODAL_STATE",tinyDisplayPhoto:this.state.tinyDisplayPhoto,setModal:this.setModal})),r.a.createElement("div",{id:"optionsmenu-pre-click"},r.a.createElement("button",{className:"btn-navbar",onClick:this.showMenu},r.a.createElement("h4",null,"\u2022\u2022\u2022"))),r.a.createElement(ua,{showMenu:this.state.showMenu,shouldHideFriendsTab:!this.state.isUserStillLoading&&!this.state.isExistingUser,closeModal:this.clearModal}))),this.props.modalState&&this.props.returnModalStructure(r.a.createElement(la,{authUser:this.props.authUser,modalState:this.props.modalState,closeModal:this.clearModal}),function(){e.state.isPostModalShowing&&!window.confirm("Are you sure you want to discard your draft?")||e.clearModal()}))}}]),a}(r.a.Component),pa=Ie(T(da)),ha=function(){return r.a.createElement("nav",{style:{alignItems:"center"}},r.a.createElement("div",null,r.a.createElement(Ht.b,{to:"/",id:"navbar-logo"},r.a.createElement("h3",null,"Third Space"))))},ma=function(e){return r.a.createElement(ye.Consumer,null,function(t){return t&&t.emailVerified?r.a.createElement(pa,{authUser:t,returnModalStructure:e.returnModalStructure,openMasterModal:e.openMasterModal,closeMasterModal:e.closeMasterModal,modalState:e.modalState}):r.a.createElement(ha,null)})},va=Ie(function(e){return r.a.createElement("div",{className:e.isSelected?"pursuitholder-container-selected":"pursuitholder-container",key:e.name,onClick:function(){return e.onPursuitToggle(e.value)}},r.a.createElement("h4",null,"  ",e.name,"  "),e.numEvents?r.a.createElement("p",null,e.numEvents,1===e.numEvents?" Post":" Posts"):r.a.createElement("p",null,"0 Posts"))}),Ea=function(e){if(e.isOwner)return r.a.createElement(r.a.Fragment,null);var t="",a=null;switch(e.followerStatus){case"NOT_A_FOLLOWER":t="Follow",a="FOLLOW";break;case"FOLLOW_REQUESTED":t="Requested",a="UNFOLLOW";break;case"FOLLOWING":t="Followed",a="UNFOLLOW"}return r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.onFollowClick(a)}},t))},fa=function(e){return e.viewerObject.eventData&&"POST_VIEWER_MODAL_STATE"===e.modalState?e.returnModalStructure(r.a.createElement(Rt,{isViewer:!0,authUser:e.authUser,viewerObject:e.viewerObject,viewerFunctions:e.viewerFunctions,closeModal:e.closeModal}),e.viewerFunctions.closeModal):null},ba=function(e){return r.a.createElement("div",{className:"eventbottominfo"},r.a.createElement("div",{className:"eventbottominfo-dynamic"},r.a.createElement("div",{className:"eventbottominfo-labels"},e.labels&&r.a.createElement(Et,{labels:e.labels})),r.a.createElement("div",{className:"eventbottominfo-comment"},r.a.createElement("p",null,e.commentCount," Comments"))))},ga=function(e){var t=e.date?et(e.date):null;return r.a.createElement("div",{className:"eventdatepursuit"},e.pursuit&&r.a.createElement("div",{className:"eventdatepursuit-pursuit"},r.a.createElement("h5",null,$(e.pursuit))),t?r.a.createElement("p",{className:"eventdatepursuit-date"}," ",t.month," ",t.day,", ",t.year," "):r.a.createElement(r.a.Fragment,null))},Pa=function(e){return e.isImage?r.a.createElement("div",{className:"eventpreview-image-container"},r.a.createElement("img",{alt:"short event cover",className:"eventpreview-image",src:e.image})):e.isText?r.a.createElement("div",{className:"eventpreview-snippet-container"},r.a.createElement("p",null,e.snippet)):void 0},Sa=function(e){var t=e.post,a=t.cover_photo_key?me(t.cover_photo_key):me(t.image_data[0]);return a?r.a.createElement("div",null,r.a.createElement(Pa,{isImage:!0,image:a}),r.a.createElement("div",{className:"eventhero-text"},t.title?r.a.createElement("h4",{className:"eventhero-image-title"},t.title):r.a.createElement(r.a.Fragment,null),r.a.createElement(ga,{date:t.date,pursuit:t.pursuit_category}),r.a.createElement(ba,{labels:t.labels,commentCount:e.commentCount}))):r.a.createElement("div",null,t.title?r.a.createElement("h4",{className:"eventhero-no-image-title"},t.title):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{className:"eventhero-text"},r.a.createElement(ga,{date:t.date,pursuit:t.pursuit_category}),r.a.createElement(Pa,{isText:!0,snippet:t.text_snippet}),r.a.createElement(ba,{labels:t.labels,commentCount:e.commentCount})))},Oa=function(e){var t=e.post;console.log(e);e.post.status;var a=null,n=null;switch(e.post.status){case"DRAFT":a="Ongoing",n="timelineprojectevent-draft";break;case"COMPLETE":a="Completed",n="timelineprojectevent-completed";break;case"PUBLISHED":a="Published",n="timelineprojectevent-published";break;default:throw new Error("Type mismatched")}return r.a.createElement("div",null,r.a.createElement("div",{id:"timelineprojectevent",className:n},r.a.createElement("h4",null,t.title),t.overview&&r.a.createElement("h6",{className:"event-overview"},t.overview)),r.a.createElement("div",{id:"timelineproject-meta"},r.a.createElement("div",{className:"timelineproject-meta-pursuit"},r.a.createElement("p",null,$(t.pursuit))),r.a.createElement("div",{className:"timelineproject-meta-status"},r.a.createElement("p",null," ",a))))},ya=function(e){return r.a.createElement("input",{type:"checkbox",checked:e.isChecked,onChange:function(t){e.onProjectEventSelect(e.post,t.target.value)}})},ja=function(e){switch(e){case 0:return"event-first";case 1:case 2:return"event-middle";case 3:return"event-last";default:return"event-middle"}},Da=function(e){var t=e.eventData;if(e.contentType===O)return r.a.createElement("div",{onClick:e.disableModalPreview?function(){return console.log("Selected")}:function(){return e.onProjectClick(t)},className:ja(e.columnIndex)},r.a.createElement(Oa,{shouldShowPursuit:e.shouldShowPursuit,post:t}));if("SPOTLIGHT_POST"===e.contentType)return r.a.createElement("div",{className:ja(e.columnIndex)},r.a.createElement("div",{onClick:e.disableModalPreview?function(){return console.log("Selected")}:function(){return e.onEventClick(t)}},r.a.createElement(Sa,{post:t,commentCount:t.comments.length})));if(e.contentType===S||"PROJECT_EVENT"===e.contentType){var a=e.isRecentEvents?[t,e.index]:[e.eventIndex];return r.a.createElement("div",{className:ja(e.columnIndex)},r.a.createElement("div",{onClick:e.disableModalPreview?function(){return console.log("Selected")}:function(){return e.onEventClick.apply(e,a)}},r.a.createElement(Sa,{post:t,commentCount:t.comment_count})),e.editProjectState&&r.a.createElement(ya,{post:t,isChecked:e.isSelected,onProjectEventSelect:e.onProjectEventSelect}),e.shouldMarkAsNew&&r.a.createElement("div",null,r.a.createElement("p",null,"To Be Added Post")))}if("SPOTLIGHT_PROJECT"===e.contentType)return console.log("asdfffff"),r.a.createElement("div",{onClick:e.disableModalPreview?function(){return console.log("Selected")}:function(){return e.onProjectClick(t)},className:ja(e.columnIndex)},r.a.createElement(Oa,{post:t}));throw new Error("No props.contentType matched")},Ia=r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("p",{style:{textAlign:"center"}},"Yay! You have seen it all")),wa=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.state={feedID:n.props.feedID,nextOpenPostIndex:0,numOfFeedItems:0},n.decideInfiniteScroller=n.decideInfiniteScroller.bind(Object(h.a)(n)),n.debounceFetch=B.a.debounce(function(){return n.fetchNextPosts()},10),n.fetchNextPosts=n.fetchNextPosts.bind(Object(h.a)(n)),n.callCachedPosts=n.callCachedPosts.bind(Object(h.a)(n)),n.decideAPICall=n.decideAPICall.bind(Object(h.a)(n)),n.callUncachedPosts=n.callUncachedPosts.bind(Object(h.a)(n)),n.handleCachedResults=n.handleCachedResults.bind(Object(h.a)(n)),n.handleUncachedPosts=n.handleUncachedPosts.bind(Object(h.a)(n)),n.loadFeedMetaInfo=n.loadFeedMetaInfo.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidUpdate",value:function(){var e=this;"DYNAMIC"!==this.props.contentType&&this.props.feedID!==this.state.feedID&&this.setState({feedID:this.props.feedID,nextOpenPostIndex:0},function(){e.state.nextOpenPostIndex<e.props.allPosts.length&&e.props.allPosts.length>0&&e.debounceFetch()})}},{key:"componentDidMount",value:function(){this._isMounted=!0,"DYNAMIC"!==this.props.contentType&&(!function(e){if(e.length>0&&e.every(function(e){return"string"!==typeof e}))throw new Error("Feed is not just ObjectIDs")}(this.props.allPosts),this.props.allPosts.length>0&&this.props.hasMore?this.debounceFetch():this.props.shouldPull(!1))}},{key:"loadFeedMetaInfo",value:function(e,t,a){var n=e.slice(this.state.nextOpenPostIndex,this.state.nextOpenPostIndex+t),r=this.state.numOfFeedItems>=10&&this.state.numOfFeedItems<a,i=this.state.numOfFeedItems+t>=a,s=this.state.nextOpenPostIndex+n.length;return i&&this.props.shouldPull(!1),{slicedObjectIDs:n,nextOpenPostIndex:s,hasCachedContentOverflowed:r,endOfContent:i}}},{key:"fetchNextPosts",value:function(){var e,t=this;if(this.debounceFetch.cancel(),"DYNAMIC"===this.props.contentType)fe.searchProject(this.props.pursuitObject,this.props.resultsIDList,this.props.requestQuantity,this.props.submittingIndexUserID).then(function(e){var a=t.state.nextOpenPostIndex+e.length;t.setState({nextOpenPostIndex:a},t.handleCachedResults(e.data))});else if((e=this.props.contentType)===S||e===O||"PROJECT_EVENT"===e){var a=this.loadFeedMetaInfo(this.props.allPosts,this.props.requestLength,this.props.numOfContent);if(this.props.contentType===S&&a.hasCachedContentOverflowed)return this.callUncachedPosts(this.props.allPosts,this.props.contentType,this.props.indexUserID,this.props.requestLength).then(function(e){return t.handleUncachedPosts(e)}).catch(function(e){return console.log(e)});this.setState({nextOpenPostIndex:a.nextOpenPostIndex},function(){return t.callCachedPosts(a.slicedObjectIDs)})}}},{key:"callCachedPosts",value:function(e){var t=this;return this.decideAPICall(e).then(function(a){return t.handleCachedResults(a.data,e)}).catch(function(e){return console.log(e)})}},{key:"decideAPICall",value:function(e){if(0===e.length)return Promise.resolve({data:[]});switch(this.props.contentType){case O:return fe.returnMultipleProjects(e);case S:case"PROJECT_EVENT":return fe.returnMultiplePosts(e,!0);default:throw new Error}}},{key:"callUncachedPosts",value:function(e,t,a,n){return fe.returnOverflowContent(e,t,a,n)}},{key:"handleCachedResults",value:function(e,t){var a=null,n="DYNAMIC"===this.props.contentType?null:t;if(0===e.length)a=e;else switch(this.props.contentType){case O:a=e.projects;break;case S:case"PROJECT_EVENT":a=e.posts;break;case"DYNAMIC":a=e;break;default:throw new Error}return this.setState({numOfFeedItems:a.length+this.state.numOfFeedItems},this.props.createTimelineRow(a,"CACHED",n))}},{key:"handleUncachedPosts",value:function(e){var t=e.data.posts;return this.setState({numOfFeedItems:t.length+this.state.numOfFeedItems,nextOpenPostIndex:t.length+this.state.nextOpenPostIndex},this.props.createTimelineRow(t,"UNCACHED"))}},{key:"decideInfiniteScroller",value:function(){return this.props.contentType===S||this.props.contentType===O||"PROJECT_EVENT"===this.props.contentType?r.a.createElement(Te.a,{dataLength:this.state.numOfFeedItems,next:this.debounceFetch,hasMore:this.props.hasMore,loader:r.a.createElement("h4",null,"Loading..."),endMessage:Ia},this.props.loadedFeed.map(function(e,t){return r.a.createElement("div",{className:"timeline-infinite-scroll-row",key:t},e)}),r.a.createElement("br",null)):"DYNAMIC"===this.props.contentType?r.a.createElement(Te.a,{dataLength:this.state.numOfFeedItems,next:this.debounceFetch,hasMore:this.props.hasMore,loader:r.a.createElement("h4",null,"Loading..."),endMessage:Ia},this.props.loadedFeed,r.a.createElement("br",null)):void 0}},{key:"render",value:function(){var e="DYNAMIC"===this.props.contentType||this.props.allPosts&&this.props.allPosts.length>0;return"DYNAMIC"===this.props.contentType||this.props.allPosts?r.a.createElement("div",{key:this.props.feedID},e?this.decideInfiniteScroller():r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),this.props.contentType===O?r.a.createElement("p",null," You don't have any projects. Feel free to make one!"):r.a.createElement("p",null,"There doesn't seem to be anything here.")),this.props.loadedFeed.length>1?null:r.a.createElement("div",{style:{height:this.props.editProjectState?"500px":"200px"}})):r.a.createElement("div",null,r.a.createElement("p",null,"Loading"))}}]),a}(r.a.Component),Ta=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),i=a[0],s=a[1];return r.a.createElement("div",{id:"rightmanagebuttons-delete-container"},r.a.createElement("p",null,"Deleting this project is irreversible. Are you sure you want to continue?"),r.a.createElement("input",{type:"checkbox",checked:i,onChange:function(){return s(!i)}}),r.a.createElement("button",{onClick:function(){return t=e.projectID,a=i,fe.deleteProject(t,a,e.userInfo.indexUserID,e.userInfo.completeUserID,e.userInfo.userPreviewID).then(function(e){return console.log(e)}).catch(function(e){return console.log(e)});var t,a}},"Confirm"),r.a.createElement("button",{onClick:e.toggleDelete},"Cancel"))},Ca=Ie(function(e){var t=Object(n.useState)("Branch of "+e.title),a=Object(o.a)(t,2),i=a[0],s=a[1],l=Object(n.useState)(""),c=Object(o.a)(l,2),u=c[0],d=c[1];return r.a.createElement("div",{className:"small-post-window"},r.a.createElement("div",{id:"forkwindow-fields"},r.a.createElement("h3",null,"Create a Branch Of This Series"),r.a.createElement("h4",null,"Title"),r.a.createElement("input",{type:"text",value:i,onChange:function(e){return s(e.target.value)}}),r.a.createElement("h4",null,"Your Twist On This Series"),r.a.createElement("input",{type:"text",placeholder:"How Will Your Project Be Linked To This?",value:u,onChange:function(e){return d(e.target.value)}})),r.a.createElement("div",{id:"rightmanagebuttons-submit"},r.a.createElement("button",{onClick:function(){return fe.createFork(e.forkData.profileID,e.forkData.indexProfileID,e.forkData.username,e.forkData.sourceContent,e.forkData.shouldCopyPosts,e.forkData.displayPhotoKey,i,u,e.forkData.cachedFeedID).then(function(t){e.closeModal(),console.log(t),window.confirm("Done! Go To Newly Created Series?")&&window.location.replace("/c/"+t.data.projectID.toString())}).catch(function(e){return console.log(e)})}},"Confirm"),r.a.createElement("button",{onClick:e.closeModal},"Cancel")))}),_a=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),i=a[0],s=a[1],l=Object(n.useState)(!1),c=Object(o.a)(l,2),u=c[0],d=c[1],p=Object(n.useState)(!1),h=Object(o.a)(p,2),m=h[0],v=h[1],E=function(){d(!u)},f=function(){v(!m)},b=e.isOwner?r.a.createElement("div",{className:"rightmanagebuttons-dropdown"},r.a.createElement("button",{className:"rightmanagebuttons-button",onClick:function(){return e.onEditExistingProject()}},"Edit"),r.a.createElement("button",{className:"rightmanagebuttons-button",onClick:E},"Delete Series")):r.a.createElement("div",{className:"rightmanagebuttons-dropdown"},r.a.createElement("button",{onClick:function(){return alert("Temporary Report Button")}},"Report")),g=function(){f(),e.closeMasterModal()};return r.a.createElement("div",null,r.a.createElement("div",{id:"rightmanagebuttons-utilities"},r.a.createElement("div",{className:"rightmanagebuttons-utilities-inner"},e.isOwner&&r.a.createElement("button",{title:"PUBLISHED"===e.status?"You've Already Published This":"Publish Your Series So The World Can See",className:"rightmanagebuttons-button",disabled:"PUBLISHED"===e.status,onClick:function(){return e.onPublish(e.projectID)}},"PUBLISHED"===e.status?"Published":"Publish"),r.a.createElement("button",{title:"Reference This Project",className:"rightmanagebuttons-button",onClick:function(){e.openMasterModal("POST_VIEWER_MODAL_STATE"),f()}},"Create Branch"),r.a.createElement("div",null,r.a.createElement("button",{className:"rightmanagebuttons-button",onClick:function(){s(!i)}}," ... "),i&&b))),u&&r.a.createElement(Ta,{userInfo:e.userInfo,projectID:e.projectID,toggleDelete:E}),m&&e.returnModalStructure(r.a.createElement(Ca,{toggleFork:f,title:e.title,forkData:e.forkData,closeModal:g}),g))},ka=function(e){var t=r.a.createElement(_a,{userInfo:e.userInfo,title:e.title,projectID:e.projectID,onEditExistingProject:e.onEditExistingProject,postIDList:e.postIDList,forkData:e.forkData,isOwner:e.isOwner,onPublish:e.onPublish,status:e.status,returnModalStructure:e.returnModalStructure,modalState:e.modalState,openMasterModal:e.openMasterModal,closeMasterModal:e.closeMasterModal});switch(e.barType){case g:return r.a.createElement("div",{id:"topbuttonbar-right-only-button-bar"},t);case b:return r.a.createElement("button",{id:"topbuttonbar-left-button",onClick:e.onNewProjectSelect},"New");case"PROJECT_MICRO_VIEW_STATE":return r.a.createElement("div",{id:"topbuttonbar-dual-button-bar"},r.a.createElement("button",{id:"topbuttonbar-left-button",onClick:e.onBackClick},"Back"),r.a.createElement("div",null,t));case"PROJECT_SELECT_VIEW_STATE":return r.a.createElement("div",{id:"topbuttonbar-dual-button-bar"},r.a.createElement("button",{id:"topbuttonbar-left-button",onClick:e.onBackClick},"Back"),r.a.createElement("button",{id:"topbuttonbar-right-button",onClick:function(){if(1===e.projectSelectSubState)e.handleWindowSwitch(2);else{if(2!==e.projectSelectSubState)throw new Error("Missing selectState");e.handleWindowSwitch("EDIT")}}},"Next"));case"PROJECT_REARRANGE_STATE":return r.a.createElement("div",{id:"topbuttonbar-dual-button-bar"},r.a.createElement("button",{id:"topbuttonbar-left-button",onClick:e.onBackClick},"Back"),r.a.createElement("button",{id:"topbuttonbar-right-button",onClick:function(){return e.handleWindowSwitch("REVIEW")}},"Finalize"));default:throw new Error("No matching barType")}},Ma=function(e){return r.a.createElement("div",{id:"projectheaderinput-header"},r.a.createElement(_e.a,{id:"projectheaderinput-title",placeholder:"Write a Title for your Post!",maxLength:140,onChange:function(t){return e.onTextChange("TITLE",t.target.value)},value:e.titleValue}),r.a.createElement(_e.a,{id:"projectheaderinput-overview",placeholder:"Write an Overview for your Project!",maxLength:140,onChange:function(t){return e.onTextChange("OVERVIEW",t.target.value)},value:e.descriptionValue}))},Ra=Ie(function(e){return console.log(e),r.a.createElement("div",{className:"similarprojectinfo"},r.a.createElement("a",{href:pe(e.preview.project_id)},r.a.createElement("h4",null,e.preview.title),r.a.createElement("p",null,e.preview.remix)))}),La=function(e){var t,a,i,s=Object(n.useState)([]),l=Object(o.a)(s,2),c=l[0],u=l[1],d=Object(n.useState)([]),p=Object(o.a)(d,2),h=p[0],m=p[1],v=Object(n.useState)("NONE"),E=Object(o.a)(v,2),f=E[0],b=E[1],g=Object(n.useState)(!1),P=Object(o.a)(g,2),S=(P[0],P[1],null!==(t=null===(a=e.projectMetaData.children)||void 0===a?void 0:a.length)&&void 0!==t?t:0),O=e.projectMetaData.ancestors.length,y=null===(i=e.projectMetaData.ancestors[O-1])||void 0===i?void 0:i.project_id,j=e.projectMetaData.cover_photo_key;Object(n.useEffect)(function(){var t=e.projectMetaData.status,a=e.projectMetaData.ancestors.length;if(e.projectMetaData.ancestors.length>0){var n=e.projectMetaData.ancestors[a-1].project_id;if(n){var r=h.map(function(e){return e.project_id});r.push(e.projectMetaData._id),fe.getSharedParentProjectPreview(n,t,r).then(function(e){return m(e.data)})}}fe.getRelatedProjectPreview(e.projectMetaData.project_preview_id,e.projectMetaData.labels,e.projectMetaData.pursuit).then(function(e){u(e.data)})},[]);var D=function(e){e===f?b("NONE"):"PARENT"===e?b("PARENT"):"CHILDREN"===e?b("CHILDREN"):"RELATED"===e&&b("RELATED")},I="NONE"!==f;return r.a.createElement("div",null,r.a.createElement("div",{id:"projectheader-pursuit"},r.a.createElement("h5",null,e.projectMetaData.pursuit)),r.a.createElement("div",{id:"projectheader-hero"},r.a.createElement("h1",null,e.titleValue),e.descriptionValue&&r.a.createElement("h4",null,e.descriptionValue),e.projectMetaData.remix&&r.a.createElement("p",null,e.projectMetaData.remix),e.projectMetaData.status&&r.a.createElement("h5",null,"Ongoing")),r.a.createElement("div",{id:"projectheader-fork"},y&&r.a.createElement("a",{href:"/c/"+y.toString()},"See Predecessor Series")),j&&r.a.createElement("div",{id:"projectheader-cover"},r.a.createElement("img",{alt:"cover",src:me(j)})),r.a.createElement("div",{id:"projectheader-user-meta"},r.a.createElement("a",{href:"/u/"+e.projectMetaData.username},r.a.createElement("img",{src:ve(e.projectMetaData.display_photo_key)}),r.a.createElement("h5",null,e.projectMetaData.username))),r.a.createElement("div",null,r.a.createElement("p",null,e.projectMetaData.overview)),r.a.createElement("div",null,r.a.createElement("div",{id:"projectheader-comparator"},r.a.createElement("button",{id:"RELATED"===f?"projectheader-selected":"",className:"projectheader-other-button",onClick:function(){return D("RELATED")}},"Related"),r.a.createElement("button",{id:"CHILDREN"===f?"projectheader-selected":"",className:0===e.projectMetaData.children_length?"projectheader-other-button-disabled":"projectheader-other-button",onClick:function(){return D("CHILDREN")},disabled:0===e.projectMetaData.children_length},"Series Influenced By This"),r.a.createElement("button",{id:"PARENT"===f?"projectheader-selected":"",className:0===h.length?"projectheader-other-button-disabled":"projectheader-other-button",onClick:function(){return D("PARENT")},disabled:0===h.length},"Other Series With The Same Parent")),I&&r.a.createElement("button",{id:"projectheader-close",onClick:function(){b("NONE")}},"Close"),"RELATED"===f&&r.a.createElement("div",{id:"projectheader-previews"},c.map(function(e,t){return r.a.createElement(Ra,{key:t,preview:e})})),"PARENT"===f&&r.a.createElement("div",{id:"projectheader-previews"},h.map(function(e,t){return r.a.createElement(Ra,{key:t,preview:e})})),"CHILDREN"===f&&r.a.createElement("div",{id:"projectheader-previews"},S>0&&e.projectMetaData.children.map(function(e,t){return r.a.createElement(Ra,{key:t,preview:e})}))))},xa=function(e){return 1===e.stage?r.a.createElement("h3",null,"Select The Posts You Want To Add!"):2===e.stage?r.a.createElement("h3",null,"Select The Posts You Want To Keep!"):void 0},Na=function(e){return r.a.createElement("div",{id:"projectutilitybuttons"},r.a.createElement("button",{onClick:function(){return e.onSelectAll(!0)}},"Select All Visible Posts"),r.a.createElement("button",{onClick:function(){return e.onSelectAll(!1)}},"Unselect All Posts"))},Aa=function(e){var t,a,n,i,s=(null===(t=e.projectMetaData)||void 0===t?void 0:t.index_user_id)===e.userInfo.indexUserID;return r.a.createElement("div",null,r.a.createElement(ka,{isOwner:s,userInfo:e.userInfo,projectID:null===(a=e.projectMetaData)||void 0===a?void 0:a._id,projectSelectSubState:e.projectSelectSubState,barType:e.barType,postIDList:null===(n=e.projectMetaData)||void 0===n?void 0:n.post_ids,onBackClick:e.onBackClick,onNewProjectSelect:e.onNewProjectSelect,onEditExistingProject:e.onEditExistingProject,handleWindowSwitch:e.handleWindowSwitch,title:e.title,status:null===(i=e.projectMetaData)||void 0===i?void 0:i.status,forkData:e.forkData,onPublish:e.onPublish,returnModalStructure:e.returnModalStructure,modalState:e.modalState,openMasterModal:e.openMasterModal,closeMasterModal:e.closeMasterModal}),e.editProjectState&&r.a.createElement(Ma,{titleValue:e.title,descriptionValue:e.overview,onTextChange:e.handleInputChange}),e.barType===g||"PROJECT_MICRO_VIEW_STATE"===e.barType?r.a.createElement(La,{titleValue:e.title,descriptionValue:e.overview,projectMetaData:e.projectMetaData,onPriorForkClick:e.onPriorForkClick,isContentOnlyView:e.isContentOnlyView}):null,e.editProjectState&&r.a.createElement(Na,{onSelectAll:e.onSelectAll}),e.editProjectState&&r.a.createElement(xa,{stage:e.projectSelectSubState}),r.a.createElement(wa,{feedID:e.feedID,requestLength:10,nextOpenPostIndex:e.nextOpenPostIndex,contentType:e.contentType,editProjectState:e.editProjectState,onProjectEventSelect:e.onProjectEventSelect,onProjectClick:e.onProjectClick,allPosts:e.allPosts,numOfContent:e.editProjectState?e.numOfContent:e.allPosts.length,window:e.window,onEventClick:e.onEventClick,loadedFeed:e.loadedFeed,updateFeedData:e.updateFeedData,targetProfileID:e.targetProfileID,shouldPull:e.shouldPull,hasMore:e.hasMore,createTimelineRow:e.createTimelineRow}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null))},Ua=function(e){var t,a,i,s,l,c,u,d,p,h=Object(n.useState)(null!==(t=null===(a=e.projectMetaData)||void 0===a?void 0:a.remix)&&void 0!==t?t:null),m=Object(o.a)(h,2),v=m[0],E=m[1],f=Object(n.useState)(null!==(i=null===(s=e.projectMetaData)||void 0===s?void 0:s.pursuit)&&void 0!==i?i:""),b=Object(o.a)(f,2),g=b[0],P=b[1],S=Object(n.useState)(null!==(l=null===(c=e.projectMetaData)||void 0===c?void 0:c.start_date)&&void 0!==l?l:null),O=Object(o.a)(S,2),y=O[0],j=O[1],D=Object(n.useState)(null!==(u=null===(d=e.projectMetaData)||void 0===d?void 0:d.end_date)&&void 0!==u?u:null),I=Object(o.a)(D,2),w=I[0],T=I[1],C=Object(n.useState)(!1),_=Object(o.a)(C,2),k=_[0],M=_[1],R=Object(n.useState)(0),L=Object(o.a)(R,2),x=L[0],N=L[1],A=Object(n.useState)(null),U=Object(o.a)(A,2),V=U[0],W=U[1],B=Object(n.useState)(!1),H=Object(o.a)(B,2),Y=H[0],J=H[1],G=Object(n.useState)(null),K=Object(o.a)(G,2),z=K[0],q=K[1],X=Object(n.useState)(!1),Q=Object(o.a)(X,2),$=Q[0],Z=Q[1],ee=Object(n.useState)([]),te=Object(o.a)(ee,2),ae=te[0],re=te[1],ie=Object(n.useState)(null),oe=Object(o.a)(ie,2),le=oe[0],ce=oe[1],ue=Object(n.useState)(!1),de=Object(o.a)(ue,2),pe=de[0],he=de[1],me=Object(n.useState)(!1),ve=Object(o.a)(me,2),Ee=(ve[0],ve[1],function(t,a){return t.append(be.USERNAME_FIELD,e.authUser.username),t.append(be.USER_ID_FIELD,e.authUser.profileID),t.append(be.INDEX_USER_ID_FIELD,e.authUser.indexProfileID),t.append(be.USER_PREVIEW_ID_FIELD,e.authUser.userPreviewID),t.append(be.STATUS_FIELD,a),fe.createProject(t).then(function(e){alert("Success!"),window.location.reload()}).catch(function(e){return console.log(e)})}),ge=function(t,a){var n,r=Promise.resolve(),i={indexUserID:e.authUser.indexProfileID,projectID:e.projectMetaData._id,threadTitle:e.title},s=e.tite!==e.projectMetaData.title,o=pe||s||g!==(null===(n=e.projectMetaData)||void 0===n?void 0:n.pursuit);if(t.append(be.SHOULD_UPDATE_PREVIEW_FIELD,o),t.append(be.PROJECT_ID_FIELD,e.projectMetaData._id),t.append(be.STATUS_FIELD,a),o){var l,c,u=(null===(l=e.projectMetaData)||void 0===l?void 0:l.children)&&(null===(c=e.projectMetaData)||void 0===c?void 0:c.children.length)>0;t.append(be.IS_FORKED_FIELD,u),t.append(be.PROJECT_PREVIEW_ID_FIELD,e.projectMetaData.project_preview_id)}if(le){var d,p,h,m,v=null!==(d=null===(p=e.projectMetaData)||void 0===p?void 0:p.coverPhoto)&&void 0!==d?d:null,E=null!==(h=null===(m=e.projectMetaData)||void 0===m?void 0:m.miniCoverPhoto)&&void 0!==h?h:null;if(t.append(be.REMOVE_COVER_PHOTO,!0),!v&&!E)throw new Error("Need cover Photo");r=r.then(fe.deleteManyPhotosByKey([v,E]))}return s&&(r=r.then(fe.updateCachedDraftTitle(i.indexUserID,i.projectID,i.title))),(r=r.then(fe.updateProject(t))).then(function(e){alert("Done!"),window.location.reload()}).catch(function(e){console.log(e)})},Pe=$&&!z,Se=Pe||!g||!e.title,Oe=Se?"projectcontroller-btn-disabled":"projectcontroller-btn-enabled",ye=null;e.projectMetaData&&(ye=e.projectMetaData?e.projectMetaData.coverPhoto:e.projectMetaData.cover_photo_key);var je=ye&&le||!ye;return r.a.createElement("div",null,r.a.createElement("div",{id:"projectcontroller-return"},r.a.createElement("button",{onClick:function(){return e.onWindowSwitch("EDIT")}},"Return")),r.a.createElement("div",{id:e.isContentOnlyView?"projectcontroller-content":""}),r.a.createElement("div",{id:"projectcontroller-submit"},Pe&&r.a.createElement("label",null,"One Moment, We Are Compressing Your Photo"),r.a.createElement("div",{className:"projectcontroller-field"},r.a.createElement("label",null,"Title  ",r.a.createElement("span",null,"Required")),r.a.createElement(_e.a,{value:e.title,onChange:function(t){return e.handleInputChange("TITLE",t.target.value)}})),r.a.createElement("div",{className:"projectcontroller-field"},r.a.createElement("label",null,"Overview"),r.a.createElement(_e.a,{value:e.overview,onChange:function(t){return e.handleInputChange("OVERVIEW",t.target.value)}})),(null===(p=e.projectMetaData)||void 0===p?void 0:p.parent_project_id)&&r.a.createElement("div",{className:"projectcontroller-field"},r.a.createElement("label",null,"Remix"),r.a.createElement(_e.a,{value:v,onChange:function(e){return E(e.target.value)}})),r.a.createElement("div",{className:"projectcontroller-field"},r.a.createElement("label",null,"Pursuit ",r.a.createElement("span",null,"Required")),r.a.createElement("select",{name:"pursuit-category",value:g,onChange:function(e){return P(e.target.value)}},e.pursuitSelects)),r.a.createElement("div",{className:"projectcontroller-field"}," ",r.a.createElement("label",null,"Start Date"),r.a.createElement("input",{type:"date",value:y,onChange:function(e){return j(e.target.value)}})),r.a.createElement("div",{className:"projectcontroller-field"}," ",r.a.createElement("label",null,"End Date"),r.a.createElement("input",{type:"date",value:w,onChange:function(e){return T(e.target.value)}})),r.a.createElement("div",{className:"projectcontroller-field"},r.a.createElement("label",null,"Total Minutes"),r.a.createElement("input",{type:"number",value:x,onChange:function(e){return N(e.target.value)}})),r.a.createElement("div",{className:"projectcontroller-field"},r.a.createElement("span",{className:"projectcontroller-checkbox-span"},r.a.createElement("input",{type:"checkbox",onClick:function(){return M(!k)}})," ",r.a.createElement("label",null,"Is Complete"))),ye&&r.a.createElement("div",{className:"projectcontroller-field"},r.a.createElement("span",{className:"projectcontroller-checkbox-span"},r.a.createElement("input",{type:"checkbox",onClick:function(){return ce(!le)}}),r.a.createElement("label",null,"Remove Cover Photo"))),je&&r.a.createElement("div",{className:"projectcontroller-field"},r.a.createElement("label",null,ye?"Replace Your Cover Photo":"Cover Photo"),r.a.createElement("input",{type:"file",onChange:function(e){return t=e.target.files,ne(t[0],J,W,250,"miniCoverPhoto"),void ne(t[0],Z,q,1e3,"coverPhoto");var t}}),$||Y&&r.a.createElement("button",{onClick:function(){q(null),W(null),Z(!1),J(!1)}},"Clear Photos")),r.a.createElement("div",{className:"projectcontroller-field"},r.a.createElement("label",null,"Tags"),r.a.createElement(se,{options:e.labels,selectedLabels:e.selectedLabels,name:"Tags",onSelect:function(e){he(!0),re(e)}})),r.a.createElement("div",{className:"projectcontroller-submit-buttons"},r.a.createElement("button",{className:Oe,disabled:Se,onClick:function(){return function(t){if("PUBLISHED"!==t||window.confirm("Once You Publish, You Will Not Be Able To Make Changes to Your Project. Are You Sure?")){var a=new FormData;if(a.append(be.THREAD_TITLE_FIELD,e.title.trim()),v&&v.trim().length>0&&a.append(be.REMIX,v.trim()),e.overview&&a.append(be.OVERVIEW_FIELD,e.overview.trim()),g&&a.append(be.PURSUIT_FIELD,g),y&&a.append(be.START_DATE_FIELD,y),w&&a.append(be.END_DATE_FIELD,w),k&&a.append(be.IS_COMPLETE_FIELD,k),0!==x&&a.append(be.MIN_DURATION_FIELD,x),z&&V&&(a.append(be.MINI_COVER_PHOTO_FIELD,V),a.append(be.COVER_PHOTO_FIELD,z)),ae.length>0){var n,r=Object(F.a)(ae);try{for(r.s();!(n=r.n()).done;){var i=n.value;a.append(be.LABELS_FIELD,i.value)}}catch(c){r.e(c)}finally{r.f()}}e.authUser.smallCroppedDisplayPhotoKey&&a.append(be.DISPLAY_PHOTO_FIELD,e.authUser.smallCroppedDisplayPhotoKey);var s,o=Object(F.a)(e.selectedPosts);try{for(o.s();!(s=o.n()).done;){var l=s.value;a.append(be.SELECTED_POSTS_FIELD,l)}}catch(c){o.e(c)}finally{o.f()}e.isUpdate?ge(a,t):Ee(a,t)}}("DRAFT")}},"Save"))),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null)))},Fa="MAIN",Va=r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null)),Wa=function(e){return 4===++e?0:e},Ba=Object(Ae.b)(function(e){var t=e.contentType,a=e.value,n=e.classColumnIndex;return r.a.createElement("div",{className:"projectcontroller-event"},r.a.createElement(Da,{columnIndex:n,contentType:t,eventData:a,editProjectState:!1,key:a._id,disableModalPreview:!0}))}),Ha=Object(Ae.a)(function(e){var t=e.contentType,a=e.items,n=e.onSortEnd;return r.a.createElement("ul",null,a.map(function(e,a){return r.a.createElement(Ba,{key:"item-".concat(a),index:a,classColumnIndex:a%4,value:e,contentType:t,onSortEnd:n})}))}),Ya=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n,r;return Object(d.a)(this,a),(r=t.call(this,e)).state={contentViewOnlyAllPosts:[],window:Fa,projectSelectSubState:1,barType:r.props.isContentOnlyView?g:b,feedData:[],selectedPosts:[],semiFinalData:[],feedIndex:new Map,title:r.props.content?r.props.content.title:"",overview:r.props.content?null===(n=r.props.content)||void 0===n?void 0:n.overview:"",selectedProject:r.props.content.post_ids?Object(u.a)({},r.props.content):null,selectedEventIndex:null,hasMore:!0,isUpdate:!1,editProjectState:!1,feedID:0,selectedPursuitIndex:r.props.selectedPursuitIndex,numOfContent:0,projectPreviewMap:{}},r.handleBackClick=r.handleBackClick.bind(Object(h.a)(r)),r.handleProjectClick=r.handleProjectClick.bind(Object(h.a)(r)),r.setNewURL=r.setNewURL.bind(Object(h.a)(r)),r.handleEventClick=r.handleEventClick.bind(Object(h.a)(r)),r.handleProjectEventSelect=r.handleProjectEventSelect.bind(Object(h.a)(r)),r.handleWindowSwitch=r.handleWindowSwitch.bind(Object(h.a)(r)),r.setSecondaryMainWindow=r.setSecondaryMainWindow.bind(Object(h.a)(r)),r.handleSortEnd=r.handleSortEnd.bind(Object(h.a)(r)),r.handleInputChange=r.handleInputChange.bind(Object(h.a)(r)),r.setModal=r.setModal.bind(Object(h.a)(r)),r.clearModal=r.clearModal.bind(Object(h.a)(r)),r.handleNewProjectSelect=r.handleNewProjectSelect.bind(Object(h.a)(r)),r.shouldPull=r.shouldPull.bind(Object(h.a)(r)),r.clearedFeed=r.clearedFeed.bind(Object(h.a)(r)),r.selectFeedSource=r.selectFeedSource.bind(Object(h.a)(r)),r.selectFeedData=r.selectFeedData.bind(Object(h.a)(r)),r.onEditExistingProject=r.onEditExistingProject.bind(Object(h.a)(r)),r.onSelectAll=r.onSelectAll.bind(Object(h.a)(r)),r.createTimelineRow=r.createTimelineRow.bind(Object(h.a)(r)),r.createRenderedPosts=r.createRenderedPosts.bind(Object(h.a)(r)),r.handlePublish=r.handlePublish.bind(Object(h.a)(r)),r.handleCommentIDInjection=r.handleCommentIDInjection.bind(Object(h.a)(r)),r.saveProjectPreview=r.saveProjectPreview.bind(Object(h.a)(r)),r}return Object(p.a)(a,[{key:"componentDidUpdate",value:function(){this.props.selectedPursuitIndex!==this.state.selectedPursuitIndex&&this.setState({selectedPursuitIndex:this.props.selectedPursuitIndex,feedData:[],hasMore:!0,feedID:this.state.feedID+1})}},{key:"handleCommentIDInjection",value:function(e,t){var a=this.state.feedData;a[e].comments=t,a[e].comment_count+=1,this.setState({feedData:a})}},{key:"saveProjectPreview",value:function(e){if(!this.state.projectPreviewMap[e._id]){var t=this.state.projectPreviewMap;t[e._id]=e,this.setState({projectPreviewMap:t})}}},{key:"createTimelineRow",value:function(e,t,a){console.log(e);var n=Z(this.state.feedData,e,t,a);console.log(n),this.setState({feedData:n})}},{key:"createRenderedPosts",value:function(){var e=this,t=this.state.isUpdate&&2===this.state.projectSelectSubState,a=[],n=a.length-1,i=this.state.selectedPosts.length;return this.state.feedData.forEach(function(s,o){o%4===0&&(a.push([]),n++),a[n].push(r.a.createElement("div",{key:s._id},r.a.createElement(Da,{columnIndex:o%4,contentType:e.state.barType===b?O:"PROJECT_EVENT",shouldMarkAsNew:!!t&&o<i,shouldShowPursuit:e.state.selectedPursuitIndex!==P,isSelected:e.state.feedIndex.get(s._id),editProjectState:e.state.editProjectState,key:o,eventIndex:o,eventData:s,onEventClick:e.handleEventClick,onProjectClick:e.handleProjectClick,onProjectEventSelect:e.handleProjectEventSelect})))}),a}},{key:"onSelectAll",value:function(e){var t,a=this.state.feedIndex,n=[],r=Object(F.a)(this.state.feedData);try{for(r.s();!(t=r.n()).done;){var i=t.value;a.set(i._id,e)}}catch(s){r.e(s)}finally{r.f()}e&&(n=this.state.feedData.map(function(e){return{post_id:e._id}})),this.setState({feedIndex:a,selectedPosts:n})}},{key:"onEditExistingProject",value:function(){var e=this,t={barType:"PROJECT_SELECT_VIEW_STATE",editProjectState:!0,hasMore:!0,isUpdate:!0,feedID:this.state.feedID+1};if(this.props.isContentOnlyView)return Promise.all([fe.returnUserPreviewByParam({id:this.props.authUser.userPreviewID}),fe.allPosts(this.props.authUser.profileID)]).then(function(a){e.setState(Object(u.a)(Object(u.a)({numOfContent:a[0].data.pursuits[0].num_posts,contentViewOnlyAllPosts:{post_ids:a[1].data.map(function(e){return e.content_id})}},t),e.clearedFeed()))}).catch(function(e){throw console.log(e),new Error("Nothing returned for all posts")});this.setState(Object(u.a)(Object(u.a)({},t),this.clearedFeed()))}},{key:"clearedFeed",value:function(){return{feedData:[],hasMore:!0,feedID:this.state.feedID+1}}},{key:"shouldPull",value:function(e){this.setState({hasMore:e})}},{key:"handleBackClick",value:function(){var e=this;switch(this.state.barType){case"PROJECT_MICRO_VIEW_STATE":var t=this.state.selectedProject.username;this.setState(Object(u.a)({newProjectState:!1,selectedProject:null,title:"",overview:"",barType:b},this.clearedFeed()),function(){e.setNewURL(he(t))});break;case"PROJECT_SELECT_VIEW_STATE":if(this.state.isUpdate)1===this.state.projectSelectSubState?this.setState(Object(u.a)({barType:this.props.isContentOnlyView?g:"PROJECT_MICRO_VIEW_STATE",editProjectState:!1,selectedPosts:[],feedIndex:new Map,isUpdate:!1},this.clearedFeed())):2===this.state.projectSelectSubState&&this.setState(Object(u.a)({projectSelectSubState:1},this.clearedFeed()));else{var a=this.props.isContentOnlyView?g:b;this.setState(Object(u.a)({barType:a,editProjectState:!1,projectSelectSubState:1,isUpdate:!1},this.clearedFeed()))}break;case"PROJECT_REARRANGE_STATE":this.setState({window:Fa,barType:"PROJECT_SELECT_VIEW_STATE"});break;default:throw new Error("Nothing Matched")}}},{key:"setModal",value:function(e){this.state.editProjectState||this.props.navigate(de(e),{replace:!1}),this.props.openMasterModal("POST_VIEWER_MODAL_STATE")}},{key:"clearModal",value:function(){var e=this,t=this.props.isContentOnlyView?this.props.content:this.state.selectedProject;this.setState({selectedEventIndex:null,header:null},function(){e.state.editProjectState||e.setNewURL(pe(t._id)),e.props.closeMasterModal()})}},{key:"handleEventClick",value:function(e){this.setState({selectedEventIndex:e},this.setModal(this.state.feedData[e]._id))}},{key:"handleInputChange",value:function(e,t){switch(e){case"TITLE":this.setState({title:t});break;case"OVERVIEW":this.setState({overview:t});break;default:throw new Error("NO TEXT ID'S Matched in POST")}}},{key:"setSecondaryMainWindow",value:function(e,t){var a=this;if(this.state.newProjectState){var n=this.state.feedData.filter(function(e){return a.state.feedIndex.get(e._id)});return this.setState(Object(u.a)({semiFinalData:n,window:"EDIT",barType:"PROJECT_REARRANGE_STATE"},this.clearedFeed()))}return this.state.selectedProject.post_ids.forEach(function(t){return e.set(t,!0)}),this.setState(Object(u.a)({projectSelectSubState:2,selectedPosts:t,feedIndex:e},this.clearedFeed()))}},{key:"handleWindowSwitch",value:function(e){var t=this,a=0;if(2===e){var n=this.state.feedIndex,r=this.state.selectedPosts;return r.forEach(function(e){return n.set(e.post_id,!0)}),this.setSecondaryMainWindow(n,r)}if("EDIT"===e){if("REVIEW"===this.state.window)return this.setState({window:e,barType:"PROJECT_REARRANGE_STATE"});var i=this.state.feedData.filter(function(e){return t.state.feedIndex.get(e._id)});return this.setState(Object(u.a)({semiFinalData:i,window:e,barType:"PROJECT_REARRANGE_STATE"},this.clearedFeed()))}if("REVIEW"===e){var s,o=Object(F.a)(this.state.selectedPosts);try{for(o.s();!(s=o.n()).done;){var l=s.value;l.min_duration&&(a+=l.min_duration)}}catch(c){o.e(c)}finally{o.f()}}this.setState({window:e,min:0!==a?a:null})}},{key:"handleProjectEventSelect",value:function(e){var t=this.state.feedIndex;if(1===this.state.projectSelectSubState){var a=this.state.selectedPosts;t.set(e._id,!t.get(e._id)),a.push({post_id:e._id}),this.setState({selectedPosts:a,feedIndex:t})}else{if(2!==this.state.projectSelectSubState)throw new Error("Something weird happened");t.set(e._id,!t.get(e._id)),this.setState({feedIndex:t})}}},{key:"handleSortEnd",value:function(e){var t=e.oldIndex,a=e.newIndex,n=this.state.semiFinalData,r=n.splice(t,1),i=Object(o.a)(r,1)[0],s=-1;n.splice(a,0,i);var l,c=Object(F.a)(n);try{for(c.s();!(l=c.n()).done;){var u=l.value;s=Wa(s),u.column_index=s}}catch(d){c.e(d)}finally{c.f()}this.setState({semiFinalData:n})}},{key:"setNewURL",value:function(e){this.props.navigate(e,{replace:!1})}},{key:"handleProjectClick",value:function(e){var t=this;this.setState(Object(u.a)({selectedProject:e,priorProjectID:e.ancestors.length>0?e.ancestors[e.ancestors.length-1]:null,barType:"PROJECT_MICRO_VIEW_STATE",title:e.title,overview:e.overview},this.clearedFeed()),function(){t.setNewURL(pe(e._id)),t.shouldPull(!0)})}},{key:"handleNewProjectSelect",value:function(){this.setState(Object(u.a)({barType:"PROJECT_SELECT_VIEW_STATE",editProjectState:!0,newProjectState:!0},this.clearedFeed()))}},{key:"selectFeedSource",value:function(){}},{key:"selectFeedData",value:function(){var e=this;switch(this.state.barType){case g:return this.props.content.post_ids;case b:return this.props.content.projects.map(function(e){return e.content_id});case"PROJECT_MICRO_VIEW_STATE":return this.state.selectedProject.post_ids;case"PROJECT_SELECT_VIEW_STATE":if(!this.state.isUpdate)return this.props.content.posts.map(function(e){return e.content_id});if(1===this.state.projectSelectSubState)return(this.props.isContentOnlyView?this.state.contentViewOnlyAllPosts.post_ids:this.props.content.posts.map(function(e){return e.content_id})).filter(function(t){return!e.state.selectedProject.post_ids.includes(t)});if(2===this.state.projectSelectSubState)return this.state.selectedPosts.map(function(e){return e.post_id}).concat(this.state.selectedProject.post_ids);break;default:throw new Error("Nothing Matched")}}},{key:"handlePublish",value:function(e){return fe.publishProject(e).then(function(e){}).catch()}},{key:"render",value:function(){var e,t,a,n,i=this.state.editProjectState||this.props.isContentOnlyView||this.state.selectedProject?"PROJECT_EVENT":O;switch(this.state.window){case Fa:var s=this.props.isContentOnlyView?this.props.content:this.state.selectedProject,o=this.state.feedData?this.state.feedData[this.state.selectedEventIndex]:[],l={sourceContent:s,profileID:this.props.authUser.profileID,indexProfileID:this.props.authUser.indexProfileID,username:this.props.authUser.username,shouldCopyPosts:!1,displayPhotoKey:this.props.authUser.smallCroppedDisplayPhotoKey,cachedFeedID:this.props.authUser.cached_feed_id},c={title:this.state.title,project_id:null===(e=this.state.selectedProject)||void 0===e?void 0:e._id,parent_project_id:this.state.priorProjectID,remix:null===(t=this.state.selectedProject)||void 0===t?void 0:t.remix},u={largeViewMode:!0,textData:o?ee(o):null,eventData:o,projectID:null===(a=this.state.selectedProject)||void 0===a?void 0:a._id,editProjectState:this.state.editProjectState,postIndex:this.state.selectedEventIndex,postType:this.state.postType,pursuitNames:this.props.pursuitNames,projectPreviewMap:c},d={onCommentIDInjection:this.handleCommentIDInjection,saveProjectPreview:this.saveProjectPreview,setModal:this.setModal,closeModal:this.clearModal};return r.a.createElement(r.a.Fragment,null,r.a.createElement(fa,{viewerObject:u,viewerFunctions:d,authUser:this.props.authUser,modalState:this.props.modalState,returnModalStructure:this.props.returnModalStructure}),r.a.createElement(Aa,{userInfo:{indexUserID:this.props.authUser.indexProfileID,completeUserID:this.props.authUser.profileID,userPreviewID:this.props.authUser.userPreviewID},forkData:l,feedID:this.state.feedID,contentType:i,numOfContent:this.state.numOfContent,projectMetaData:this.state.selectedProject,projectSelectSubState:this.state.projectSelectSubState,barType:this.state.barType,window:this.state.window,targetProfileID:this.props.targetProfileID,hasMore:this.state.hasMore,isContentOnlyView:this.props.isContentOnlyView,editProjectState:this.state.editProjectState,title:this.state.title,overview:this.state.overview,allPosts:this.selectFeedData(),loadedFeed:this.createRenderedPosts(),onPublish:this.handlePublish,createTimelineRow:this.createTimelineRow,onProjectEventSelect:this.handleProjectEventSelect,onProjectClick:this.handleProjectClick,handleWindowSwitch:this.handleWindowSwitch,onEventClick:this.handleEventClick,onBackClick:this.handleBackClick,handleInputChange:this.handleInputChange,onEditExistingProject:this.onEditExistingProject,onNewProjectSelect:this.handleNewProjectSelect,shouldPull:this.shouldPull,onSelectAll:this.onSelectAll,returnModalStructure:this.props.returnModalStructure,modalState:this.props.modalState,openMasterModal:this.props.openMasterModal,closeMasterModal:this.props.closeMasterModal}));case"EDIT":return r.a.createElement("div",null,r.a.createElement(ka,{barType:this.state.barType,selectedProjectID:null===(n=this.state.selectedProject)||void 0===n?void 0:n._id,onBackClick:this.handleBackClick,onNewProjectSelect:this.handleNewProjectSelect,handleWindowSwitch:this.handleWindowSwitch}),r.a.createElement("h3",null,"Rearrange Your Posts"),r.a.createElement("div",{id:"projectcontroller-sortable-list"},0===this.state.semiFinalData.length&&r.a.createElement("p",null,"No Posts Have Been Selected"),r.a.createElement(Ha,{contentType:S,items:this.state.semiFinalData,onSortEnd:this.handleSortEnd,axis:"xy"})),this.state.semiFinalData.length<12&&Va);case"REVIEW":var p,h=[],m=Object(F.a)(this.props.pursuitNames);try{for(m.s();!(p=m.n()).done;){var v=p.value;"ALL"===v?h.push(r.a.createElement("option",{key:"None",value:null})):h.push(r.a.createElement("option",{key:v,value:v},v))}}catch(E){m.e(E)}finally{m.f()}return r.a.createElement(Ua,{authUser:this.props.authUser,title:this.state.title,overview:this.state.overview,isUpdate:this.state.isUpdate,projectMetaData:this.state.selectedProject,pursuitSelects:h,selectedPosts:this.state.semiFinalData.map(function(e){return e._id}),isContentOnlyView:this.props.isContentOnlyView,onWindowSwitch:this.handleWindowSwitch,handleInputChange:this.handleInputChange});default:throw new Error("No Window Options Matched in post-project-controller")}}}]),a}(r.a.Component),Ja=Ie(Ya),Ga=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.state={selectedEventIndex:null,isModalShowing:!1,hasMore:!0,feedData:[],feedID:n.props.feedID,projectPreviewMap:{}},n.handleEventClick=n.handleEventClick.bind(Object(h.a)(n)),n.handleCommentIDInjection=n.handleCommentIDInjection.bind(Object(h.a)(n)),n.clearModal=n.clearModal.bind(Object(h.a)(n)),n.setModal=n.setModal.bind(Object(h.a)(n)),n.shouldPull=n.shouldPull.bind(Object(h.a)(n)),n.createTimelineRow=n.createTimelineRow.bind(Object(h.a)(n)),n.createRenderedPosts=n.createRenderedPosts.bind(Object(h.a)(n)),n.saveProjectPreview=n.saveProjectPreview.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;window.addEventListener("popstate",function(t){"POST_VIEWER_MODAL_STATE"===e.props.modalState?e.clearModal(!0):e.props.modalState||"p"===window.location.pathname[1]&&(e.state.selectedEventIndex?e.setModal(e.state.feedData[e.state.selectedEventIndex]._id,!0):window.location.reload())})}},{key:"saveProjectPreview",value:function(e){if(!this.state.projectPreviewMap[e._id]){var t=this.state.projectPreviewMap;t[e._id]=e,this.setState({projectPreviewMap:t})}}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.setState({hasMore:!0,feedData:[]},function(){return window.removeEventListener("popstate")})}},{key:"componentDidUpdate",value:function(){this.props.feedID!==this.state.feedID&&this.setState({feedID:this.props.feedID,feedData:[],hasMore:!0})}},{key:"createTimelineRow",value:function(e,t,a){var n=this,r=Z(this.state.feedData,e,t,a);this.setState({feedData:r},function(){if("UNCACHED"===t){var a=function(e){return e.map(function(e){return{content_id:e._id,labels:e.labels,date:e.date,createdAt:e.createdAt,updatedAt:e.updatedAt}})}(e);n.props.updateAllPosts(a)}})}},{key:"createRenderedPosts",value:function(e,t){var a=this,n=[],i=n.length-1;return this._isMounted&&0!==this.state.feedData.length?(this.state.feedData.forEach(function(e,t){t%4===0&&(n.push([]),i++),n[i].push(r.a.createElement("div",{key:e._id},r.a.createElement(Da,{key:i,contentType:S,eventIndex:t,columnIndex:t%4,eventData:e,onEventClick:a.handleEventClick})))}),n):n}},{key:"handleEventClick",value:function(e){this.setState({selectedEventIndex:e},this.setModal(this.state.feedData[e]._id))}},{key:"setModal",value:function(e,t){t||this.props.navigate(de(e),{replace:!1}),this.props.openMasterModal("POST_VIEWER_MODAL_STATE")}},{key:"clearModal",value:function(e){e||this.props.navigate(-1),this.props.closeMasterModal()}},{key:"handleCommentIDInjection",value:function(e,t){console.log(this.state.feedData);var a=Q(e,t,this.state.feedData);this.setState({feedData:a})}},{key:"shouldPull",value:function(e){this.setState({hasMore:e})}},{key:"render",value:function(){var e=this.state.feedData[this.state.selectedEventIndex],t={largeViewMode:!0,textData:e?ee(e):null,isPostOnlyView:!1,pursuitNames:this.props.pursuitNames,eventData:e,projectPreviewMap:this.state.projectPreviewMap,selectedIndex:this.state.selectedEventIndex},a={onCommentIDInjection:this.handleCommentIDInjection,saveProjectPreview:this.saveProjectPreview,setModal:this.setModal,closeModal:this.clearModal};return r.a.createElement(r.a.Fragment,null,r.a.createElement(fa,{viewerObject:t,viewerFunctions:a,authUser:this.props.authUser,modalState:this.props.modalState,returnModalStructure:this.props.returnModalStructure}),r.a.createElement(wa,{contentType:S,indexUserID:this.props.authUser.indexProfileID,requestLength:10,index:!0,feedID:this.props.feedID,allPosts:this.props.feedData,numOfContent:this.props.numOfContent,hasMore:this.state.hasMore,loadedFeed:this.createRenderedPosts(),shouldPull:this.shouldPull,createTimelineRow:this.createTimelineRow,setUncachedEdition:this.props.setUncachedEdition}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null))}}]),a}(r.a.Component),Ka=Ie(Ga),za=function(e){return e.visibility.fail?r.a.createElement("p",null,"The user you're looking for does not exist."):e.visibility.shouldHide?r.a.createElement("p",null,"This profile is private. To see these posts, please request access. "):e.contentType===S?r.a.createElement("div",{key:e.selectedPursuitIndex},r.a.createElement(Ka,e)):e.contentType===O?r.a.createElement("div",{key:e.selectedPursuitIndex},r.a.createElement(Ja,e)):new Error("Missing Content Type Field")},qa=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n,r,i,s;return Object(d.a)(this,a),(s=t.call(this,e))._isMounted=!1,s.state={isPrivate:!0,pursuits:null,allPosts:null,allProjects:null,fail:!1,textData:null,userRelationID:null,followerStatus:null,feedIDList:null,contentType:null,selectedContent:null,selectedPursuit:"ALL",selectedPursuitIndex:0,preferredPostPrivacy:null,isContentOnlyView:null,loading:!0,profileData:{username:null!==(n=null===(r=s.props.match)||void 0===r?void 0:null===(i=r.params)||void 0===i?void 0:i.username)&&void 0!==n?n:null}},s.loadMacroProjectData=s.loadMacroProjectData.bind(Object(h.a)(s)),s.loadMicroProjectData=s.loadMicroProjectData.bind(Object(h.a)(s)),s.loadMicroPostData=s.loadMicroPostData.bind(Object(h.a)(s)),s.setContentOnlyData=s.setContentOnlyData.bind(Object(h.a)(s)),s.handleFollowClick=s.handleFollowClick.bind(Object(h.a)(s)),s.handleFollowerStatusChange=s.handleFollowerStatusChange.bind(Object(h.a)(s)),s.handlePursuitToggle=s.handlePursuitToggle.bind(Object(h.a)(s)),s.handleMediaTypeSwitch=s.handleMediaTypeSwitch.bind(Object(h.a)(s)),s.loadProfile=s.loadProfile.bind(Object(h.a)(s)),s.setProfileData=s.setProfileData.bind(Object(h.a)(s)),s.loadedContentCallback=s.loadedContentCallback.bind(Object(h.a)(s)),s.isOwner=s.isOwner.bind(Object(h.a)(s)),s.updateAllPosts=s.updateAllPosts.bind(Object(h.a)(s)),s}return Object(p.a)(a,[{key:"componentDidMount",value:function(){this._isMounted=!0;var e=this.props.match,t=e.username,a=e.postID,n=e.projectID,r=!!t,i=a?S:null,s=this.props.isProjectView,o=n?O:null;if(this._isMounted){if(s)return this.loadProfile(t,O);if(r)return this.loadProfile(t,S);if(i)return this.loadMicroPostData(a);if(o)return this.loadMicroProjectData(n)}}},{key:"componentDidUpdate",value:function(){var e,t=this.props.match.username,a=t!==(null===(e=this.state.profileData)||void 0===e?void 0:e.username),n=!!this.props.match.postID,r=!!this.props.match.projectID;if(!this.state.fail&&a&&!n&&!r)return this.loadProfile(t,S)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"loadMacroProjectData",value:function(e){var t=this,a=null;return fe.returnUser(e).then(function(e){return a=e.data,t.loadFollowerStatus(a.user_relation_id,a.private)})}},{key:"isOwner",value:function(){return!!this.props.authUser&&(this.state.isContentOnlyView?this.state.selectedContent.username===this.props.authUser.username:this.props.authUser.username===this.state.profileData.username)}},{key:"loadProfile",value:function(e,t){var a=this,n=null;return fe.returnUser(e).then(function(e){return console.log(e.data),n=e.data,fe.returnFollowerStatus(a.props.authUser.username,n.user_relation_id)}).then(function(e){return a.setProfileData(n,e,t)}).catch(function(e){console.log(e),a.setState({fail:!0})})}},{key:"loadedContentCallback",value:function(e,t){var a=e===S?t:t.project;if(this.props.authUser){var n=this.props.authUser,r=te(n.pursuits);this.setContentOnlyData(e,a,r.names)}else this.setContentOnlyData(e,a)}},{key:"setProfileData",value:function(e,t,a){var n=te(e.pursuits),r=this.handleFollowerStatusResponse(t);console.log(e),this.setState({profileData:e,pursuitNames:n.names,followerStatus:r,contentType:a,isContentOnlyView:!1,isPrivate:e.private,loading:!1})}},{key:"loadMicroProjectData",value:function(e){var t=this;return fe.returnSingleProject(e).then(function(e){return t.loadedContentCallback(O,e.data)})}},{key:"setContentOnlyData",value:function(e,t,a){this.setState({contentType:e,selectedContent:t,pursuitNames:a,isContentOnlyView:!0,loading:!1})}},{key:"loadMicroPostData",value:function(e){var t=this;return fe.retrievePost(e,!1).then(function(e){return t.loadedContentCallback(S,e.data)}).catch(function(e){return console.log(e)})}},{key:"handleMediaTypeSwitch",value:function(e){var t=this,a=null,n=null;if(0===this.state.selectedPursuitIndex)switch(e){case S:a=this.state.allPosts;break;case O:a=this.state.allProjects;break;default:throw new Error("Nothing matched for feed type")}else{var r=this.state.profileData.pursuits[this.state.selectedPursuitIndex];switch(e){case S:a=r.posts,n=r.num_posts;break;case O:a=r.projects,n=r.num_posts;break;default:throw new Error("Nothing matched for feed type")}}this.setState({contentType:e,feedIDList:a,numOfContent:n},function(){e===O?t.props.navigate(he(t.state.profileData.username)+"/"+"THREADS".toLowerCase(),{replace:!1}):t.props.navigate(he(t.state.profileData.username),{replace:!1})})}},{key:"handlePursuitToggle",value:function(e){var t=this.state.contentType===S?this.state.profileData.pursuits[e].posts:this.state.profileData.pursuits[e].projects;this.setState(function(a){return{selectedPursuitIndex:e,selectedPursuit:a.profileData.pursuits[e].name,feedIDList:t}})}},{key:"handleFollowerStatusResponse",value:function(e){if(!e)return"NOT_A_FOLLOWER";if(200===e.status){if(e.data.success){if("FOLLOWING"===e.data.success)return"FOLLOWING";if("FOLLOW_REQUESTED"===e.data.success)return"FOLLOW_REQUESTED";throw new Error("No Follow State Matched")}if(e.data.error)return"NOT_A_FOLLOWER"===e.data.error||"UNFOLLOWED"===e.data.error?"NOT_A_FOLLOWER":"FOLLOW_REQUESTED"}return"NOT_A_FOLLOWER"}},{key:"handleFollowerStatusChange",value:function(e){var t=this;fe.setFollowerStatus(this.props.authUser.userRelationID,this.props.authUser.cached_feed_id,this.state.profileData.user_relation_id,this.state.profileData.cached_feed_id,e,this.state.profileData.private).then(function(a){var n=function(e,t){switch(e){case"FOLLOW":return t?"FOLLOW_REQUESTED":"FOLLOWING";case"UNFOLLOW":return"NOT_A_FOLLOWER"}}(e,t.state.profileData.private);t.setState({followerStatus:n})}).catch(function(e){console.log(e),alert(e)})}},{key:"handleFollowClick",value:function(e){"FOLLOW"===e?this.handleFollowerStatusChange(e):window.confirm("Are you sure you want to unfollow?")&&this.handleFollowerStatusChange(e)}},{key:"updateAllPosts",value:function(e){var t=this.state.profileData,a=t.pursuits[this.state.selectedPursuitIndex].posts.concat(e);t.pursuits[this.state.selectedPursuitIndex].posts=a,this.setState({profileData:t})}},{key:"render",value:function(){var e=this;if(this.state.loading)return null;var t=0,a=[];if(this.state.profileData.pursuits){var n,i=Object(F.a)(this.state.profileData.pursuits);try{for(i.s();!(n=i.n()).done;){var s=n.value;a.push(r.a.createElement(va,{isSelected:s.name===this.state.selectedPursuit,name:s.name,numEvents:s.num_posts,key:s.name,value:t++,onPursuitToggle:this.handlePursuitToggle}))}}catch(P){i.e(P)}finally{i.f()}}if(this.state.isContentOnlyView){if(this.state.contentType===S){var o=ee(this.state.selectedContent),l={key:this.state.selectedContent._id,largeViewMode:!0,textData:o,isPostOnlyView:this.state.isContentOnlyView,pursuitNames:this.state.pursuitNames,eventData:this.state.selectedContent,projectPreviewMap:{}};return r.a.createElement(Rt,{isViewer:!0,authUser:this.props.authUser,viewerObject:l})}if(this.state.contentType===O)return r.a.createElement("div",{id:"profile-main"},r.a.createElement(Ja,{authUser:this.props.authUser,content:this.state.selectedContent,pursuitNames:this.state.pursuitNames,returnModalStructure:this.props.returnModalStructure,modalState:this.props.modalState,openMasterModal:this.props.openMasterModal,closeMasterModal:this.props.closeMasterModal,isContentOnlyView:this.state.isContentOnlyView}));throw new Error("No Content Type Matched")}if(this.state.isContentOnlyView)return new Error("State condition for postOnlyView was null");var c,u,d,p,h,m=null!==(c=null===(u=this.state.profileData)||void 0===u?void 0:u.username)&&void 0!==c?c:"",v=ve(null!==(d=null===(p=this.state.profileData)||void 0===p?void 0:p.cropped_display_photo_key)&&void 0!==d?d:null),E=!(null===(h=this.props.authUser)||void 0===h?void 0:h.username)&&this.state.profileData.private,f=!this.isOwner()&&this.state.profileData.private&&"FOLLOWING"!==this.state.followerStatus&&"REQUEST_ACCEPTED"!==this.state.followerStatus,b={};if(this.state.contentType===S){var g=this.state.profileData.pursuits[this.state.selectedPursuitIndex];b.feedData=g.posts.map(function(e){return e.content_id}),b.numOfContent=g.num_posts,b.updateAllPosts=this.updateAllPosts}else this.state.contentType===O&&(b.content=this.state.profileData.pursuits[this.state.selectedPursuitIndex],b.selectedPursuitIndex=this.state.selectedPursuitIndex,b.isContentOnlyView=this.state.isContentOnlyView,b.numOfContent=this.props.authUser.pursuits[0].num_posts);return r.a.createElement("div",null,r.a.createElement("div",{id:"profile-main"},r.a.createElement("div",{id:"profile-intro"},r.a.createElement("div",{id:"profile-upper"},r.a.createElement("div",{id:"profile-dp"},r.a.createElement("img",{alt:"user profile",src:v})),r.a.createElement("div",{id:"profile-upper-right"},r.a.createElement("div",{id:"profile-upper-user-info"},r.a.createElement("div",{id:"profile-name"},r.a.createElement("h3",null,m)),r.a.createElement("div",{id:"profile-actions"},r.a.createElement(Ea,{isOwner:this.isOwner(),followerStatus:this.state.followerStatus,onFollowClick:this.handleFollowClick,onOptionsClick:this.handleOptionsClick}))),r.a.createElement("div",{id:"profile-biography"},this.state.profileData.bio&&r.a.createElement("p",null,this.state.profileData.bio)))),r.a.createElement("div",{id:"profile-pursuits"},a)),r.a.createElement("div",{id:"profile-content-switch"},r.a.createElement("button",{className:this.state.contentType===S?"profile-content-selected":"profile-content-unselected",disabled:this.state.contentType===S,onClick:function(){return e.handleMediaTypeSwitch(S)}},"Posts"),r.a.createElement("button",{className:this.state.contentType===O?"profile-content-selected":"profile-content-unselected",disabled:this.state.contentType===O,onClick:function(){return e.handleMediaTypeSwitch(O)}},"Series")),this.state.contentType&&r.a.createElement(za,Object.assign({},b,{contentType:this.state.contentType,visibility:{shouldHide:E||f,fail:this.state.fail},authUser:this.props.authUser,returnModalStructure:this.props.returnModalStructure,modalState:this.props.modalState,openMasterModal:this.props.openMasterModal,closeMasterModal:this.props.closeMasterModal,pursuitNames:this.state.pursuitNames,feedID:this.state.selectedPursuitIndex}))))}}]),a}(r.a.Component),Xa=Ie(T(function(e){return r.a.createElement(ye.Consumer,null,function(t){return r.a.createElement(qa,Object.assign({},e,{authUser:t}))})})),Qa=function(e,t){return r.a.createElement("div",{key:t,className:"results-stats"},r.a.createElement("h4",null,$(e.name)),r.a.createElement("p",null," ",e.num_milestones," Milestones"),r.a.createElement("p",null," ",e.total_min," Total Minutes"))},$a=function(e){var t=tt(e.person.distance),a=ve(e.person.small_cropped_display_photo_key),n=e.person.pursuits.slice(1);return r.a.createElement("div",{key:e.person._id,className:"results"},r.a.createElement("div",{className:"results-profile"},r.a.createElement("div",null,r.a.createElement("div",{className:"results-image"},r.a.createElement("img",{alt:"profile",src:a})),r.a.createElement("a",{className:"results-name",href:"/u/"+e.person.username},r.a.createElement("h3",null,e.person.first_name+" "+e.person.last_name)),t&&r.a.createElement("p",null,t)),r.a.createElement("div",null,r.a.createElement("p",null,e.person.bio)),n.map(Qa)),r.a.createElement("div",{className:"results-post"},r.a.createElement("div",{className:"results-title"},r.a.createElement("h4",null,"Recent Posts")),r.a.createElement("div",{className:"results-post-preview"},e.person.pursuits[0].posts.length>0?e.person.pursuits[0].loaded.map(function(t,a){return r.a.createElement("div",{key:a},r.a.createElement(Da,{contentType:"SPOTLIGHT_POST",eventIndex:1,columnIndex:a,eventData:t,onEventClick:e.onEventClick}))}):r.a.createElement("p",null,"No Posts Yet"))))},Za=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.state={isLoaded:!1,content:{upper:null,lower:null},containsProject:!1},n.returnPosts=n.returnPosts.bind(Object(h.a)(n)),n.returnProject=n.returnProject.bind(Object(h.a)(n)),n.setContent=n.setContent.bind(Object(h.a)(n)),n.renderUppercontent=n.renderUppercontent.bind(Object(h.a)(n)),n.handleProjectClick=n.handleProjectClick.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;var t=this.props.user.pursuits[0],a=t.posts.length>0?t.posts[0].content_id:null,n=t.posts.length>1?t.posts[1].content_id:null,r=t.projects.length>0?t.projects[0].content_id:null,i=[];if(a&&i.push(a),!r&&n&&i.push(n),this._isMounted&&i.length>0)return r?Promise.all([this.returnProject(r),fe.retrievePost(a,!1).then(function(e){return e.data})]).then(function(t){e.setContent(t,!0)}):this.returnPosts(i).then(function(t){return e.setContent(t,!1)})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"setContent",value:function(e,t){var a=this.state.content;t?(a.upper=e[0],a.lower=e[1]):(1===e.length&&(a.upper=e[0]),2===e.length&&(a.upper=e[0],a.lower=e[1])),this.setState({content:a,containsProject:t,isLoaded:!0})}},{key:"returnPosts",value:function(e){return fe.returnMultiplePosts(e,!1).then(function(e){return e.data.posts})}},{key:"returnProject",value:function(e){return fe.returnSingleProject(e).then(function(e){return e.data.project})}},{key:"renderUppercontent",value:function(){return this.state.containsProject?r.a.createElement(Da,{isRecentEvents:!1,contentType:O,key:"Project",eventData:this.state.content.upper,onProjectClick:this.handleProjectClick}):r.a.createElement(Da,{isRecentEvents:!1,contentType:"SPOTLIGHT_POST",key:"First Post",eventData:this.state.content.upper,onEventClick:this.props.onEventClick})}},{key:"handleProjectClick",value:function(e){window.open("/c/"+e._id)}},{key:"render",value:function(){var e,t=tt(this.props.user.distance),a=0,n=Object(F.a)(this.props.user.pursuits);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.name!==P&&this.props.pursuits.includes(i.name)&&a++}}catch(s){n.e(s)}finally{n.f()}return r.a.createElement("div",{key:this.props.user._id,className:"tab"},r.a.createElement("div",{className:"tab-dp"},r.a.createElement("img",{alt:"profile",src:ve(this.props.user.small_cropped_display_photo_key)})),r.a.createElement("a",{href:"/u/"+this.props.user.username},r.a.createElement("h3",null,this.props.user.first_name+" "+this.props.user.last_name)),r.a.createElement("div",{className:"tab-meta"},t&&r.a.createElement("p",null,t),0!==a&&r.a.createElement("p",null,"Shares ",a," ",a>1?"Pursuits With You":"Pursuit With You"," ")),r.a.createElement("h4",null,"Recent Work"),r.a.createElement("div",{className:"tab-event"},this.state.content.upper&&this.renderUppercontent(),this.state.content.lower&&r.a.createElement(Da,{isRecentEvents:!1,contentType:"SPOTLIGHT_POST",key:"Second Post",eventData:this.state.content.lower,onEventClick:this.props.onEventClick})))}}]),a}(r.a.Component),en=Ie(Za),tn=function(e){var t=e.users.map(function(t){return r.a.createElement(en,{key:t._id,user:t,pursuits:e.pursuits,onEventClick:e.onEventClick})});return r.a.createElement("div",{id:"spotlight-main-container"},r.a.createElement("div",{id:"spotlight-highlight"},r.a.createElement("h1",null,"See What People Like You Are Doing")),t)},an=function(e){var t=e.pursuit===P?"All of Your Pursuits":$(e.pursuit);return r.a.createElement("div",{className:"pursuitoption input-hero-search",onClick:function(){return a=t,void e.onPursuitClick(a);var a}},r.a.createElement("p",null,t))},nn=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),i=a[0],s=a[1],l=Object(n.useRef)(null),c=Object(n.useRef)(null),u=function(){i?(l.current.style.display="none",c.current.style.display="none",s(!1)):(l.current.style.display="block",c.current.style.display="block",s(!0))},d=function(t){e.onFieldChange(be.PURSUIT_FIELD,t),u()};return r.a.createElement("div",{id:"peoplefields"},r.a.createElement("div",{id:"peoplefields-overlay",ref:c,onClick:u}),r.a.createElement("div",{id:"peoplefields-createable",className:"peoplefields-fields input-hero-search"},r.a.createElement("input",{id:"peoplefields-input-text",type:"text",value:e.selectedPursuit,onKeyDown:function(t){return function(t){"Enter"===t.key&&e.onRefreshClick()}(t)},onChange:function(t){return e.onFieldChange(be.PURSUIT_FIELD,t.target.value)}}),r.a.createElement("button",{onClick:u},"Your Pursuits"),r.a.createElement("div",{ref:l,id:"peoplefields-pursuit-dropdown"},e.pursuits.map(function(e){return r.a.createElement(an,{pursuit:e,onPursuitClick:d})})),r.a.createElement("div",{id:"peoplefields-distance"},r.a.createElement("select",{onChange:function(t){return e.onDistanceChange(t.target.value)}},r.a.createElement("option",{value:10},"10 Miles"),r.a.createElement("option",{value:50},"50 Miles"),r.a.createElement("option",{value:100},"100 Miles"),r.a.createElement("option",{value:250},"250 Miles"),r.a.createElement("option",{value:500},"500 Miles")))),r.a.createElement("div",{className:"peoplefields-fields"},r.a.createElement("button",{id:"peoplefields-refresh",className:"btn-round",disabled:0===e.selectedPursuit.length,onClick:function(t){t.preventDefault(),e.onRefreshClick()}},"Search")))},rn="SPOTLIGHT",sn=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={lat:null,long:null,resultState:rn,hasTextChanged:!1,spotlight:[],people:[],pursuits:n.props.authUser.pursuits.map(function(e){return e.name}),selectedContent:null,distance:10,difficulty:0,progression:1,selectedPursuit:"",projectPreviewMap:{}},n.success=n.success.bind(Object(h.a)(n)),n.error=n.error.bind(Object(h.a)(n)),n.getSpotlight=n.getSpotlight.bind(Object(h.a)(n)),n.setModal=n.setModal.bind(Object(h.a)(n)),n.clearModal=n.clearModal.bind(Object(h.a)(n)),n.renderModal=n.renderModal.bind(Object(h.a)(n)),n.handleEventClick=n.handleEventClick.bind(Object(h.a)(n)),n.handleFieldChange=n.handleFieldChange.bind(Object(h.a)(n)),n.handleRefreshClick=n.handleRefreshClick.bind(Object(h.a)(n)),n.handleDistanceChange=n.handleDistanceChange.bind(Object(h.a)(n)),n.refreshResults=n.refreshResults.bind(Object(h.a)(n)),n.getLocation=n.getLocation.bind(Object(h.a)(n)),n.saveProjectPreview=n.saveProjectPreview.bind(Object(h.a)(n)),n.setCoordinates=n.setCoordinates.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){this.getLocation()}},{key:"getLocation",value:function(){var e=this;return fe.getLocation(this.props.authUser.userPreviewID).then(function(t){204===t.status?navigator.geolocation.getCurrentPosition(e.success,e.error,Ce):e.setCoordinates(t.data.coordinates)})}},{key:"setCoordinates",value:function(e){var t=this;this.setState({lat:e.latitude,long:e.longitude},function(){return t.getSpotlight(e)})}},{key:"saveProjectPreview",value:function(e){if(!this.state.projectPreviewMap[e._id]){var t=this.state.projectPreviewMap;t[e._id]=e,this.setState({projectPreviewMap:t})}}},{key:"success",value:function(e){var t=this,a=e.coords;return this.setState({lat:a.latitude,long:a.longitude},function(){return t.getSpotlight(a)}),fe.setLocation(a.latitude,a.longitude,this.props.authUser.userPreviewID).then(function(e){alert("Location Set!")})}},{key:"error",value:function(e){console.warn("ERROR(".concat(e.code,"): ").concat(e.message))}},{key:"getSpotlight",value:function(e){var t=this;return fe.getSpotlight(5,e.latitude,e.longitude,[this.props.authUser.userPreviewID]).then(function(e){t.setState({spotlight:e.data.users})})}},{key:"setModal",value:function(){this.props.openMasterModal("POST_VIEWER_MODAL_STATE")}},{key:"clearModal",value:function(){this.setState({selectedContent:null},this.props.closeMasterModal())}},{key:"handleEventClick",value:function(e,t){this.setState({selectedContent:e},this.setModal())}},{key:"renderModal",value:function(){if("POST_VIEWER_MODAL_STATE"===this.props.modalState&&this.state.selectedContent){var e,t=(null===(e=this.state.selectedContent)||void 0===e?void 0:e.text_data)&&this.state.selectedContent.is_paginated?JSON.parse(this.state.selectedContent.text_data):this.state.selectedContent.text_data,a={key:this.state.selectedContent._id,largeViewMode:!0,textData:t,isPostOnlyView:!1,eventData:this.state.selectedContent,projectPreviewMap:this.state.projectPreviewMap,saveProjectPreview:this.saveProjectPreview},n=r.a.createElement(Rt,{isViewer:!0,viewerObject:a,authUser:this.props.authUser,closeModal:this.clearModal});return this.props.returnModalStructure(n,this.clearModal)}return null}},{key:"handleFieldChange",value:function(e,t){switch(e){case be.DIFFICULTY_FIELD:this.setState({difficulty:t});break;case be.PROGRESSION_FIELD:this.setState({progression:t});break;case be.DISTANCE_FIELD:this.setState({distance:t});break;case be.PURSUIT_FIELD:this.setState({selectedPursuit:t,hasTextChanged:!0});break;default:throw new Error("No fields matched")}}},{key:"handleRefreshClick",value:function(){this.state.selectedPursuit?this.setState({loading:!0},this.refreshResults):console.log("numb")}},{key:"handleDistanceChange",value:function(e){this.setState({distance:e})}},{key:"refreshResults",value:function(){var e=this,t=this.state.selectedPursuit===P?this.state.pursuits.slice(1):[this.state.selectedPursuit.toUpperCase()],a=[];return a.push(this.props.authUser.userPreviewID),fe.getSimilarPeople(this.state.distance,t,a,this.state.lat,this.state.long).then(function(t){e.setState({people:t.data.users,loading:!1,resultState:"RESULTS"})})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{id:"geosearch-header"},r.a.createElement(nn,{pursuits:this.state.pursuits,onFieldChange:this.handleFieldChange,onRefreshClick:this.handleRefreshClick,selectedPursuit:this.state.selectedPursuit,onDistanceChange:this.handleDistanceChange})),r.a.createElement("div",{id:"geosearch-results"},"SPOTLIGHT"===this.state.resultState?r.a.createElement(tn,{users:this.state.spotlight,onEventClick:this.handleEventClick,pursuits:this.state.pursuits}):this.state.people.length>0?this.state.people.map(function(t,a){return r.a.createElement("div",{key:a},r.a.createElement($a,{person:t,onEventClick:e.handleEventClick}))}):r.a.createElement("p",null,"No Results Found")),this.renderModal())}}]),a}(r.a.Component),on=function(e){return r.a.createElement(ye.Consumer,null,function(t){return r.a.createElement(sn,Object.assign({},e,{authUser:t}))})},ln={label:"Search Only Your Pursuits",value:"ALL"},cn=function(e){return e},un=function(e){return e.map(function(e){return"ALL"===e?{label:"Search Only Your Pursuits",value:e}:{label:e,value:e}})},dn=function(e){var t=q(e.pursuits,un);return r.a.createElement("div",null,r.a.createElement(K.a,{isClearable:!0,defaultValue:ln,options:t,formatCreateLabel:cn,onChange:function(t){return t?e.onFieldChange(be.PURSUIT_FIELD,t.value):e.onFieldChange(be.PURSUIT_FIELD,null)}}),r.a.createElement("button",{className:"btn-round",onClick:e.onSubmitSearch},"Submit"))},pn=function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),i=a[0],s=a[1],l=function(){s(!i)},c="ANCESTORS"===e.contentType?e.ancestors:e.children;return r.a.createElement("div",null,"ANCESTORS"===e.contentType&&r.a.createElement("p",null,"Total Ancestors: ",e.ancestors.length),"CHILDREN"===e.contentType&&r.a.createElement("p",null,"Total Children: ",e.children.length),"ANCESTORS"===e.contentType&&r.a.createElement("button",{onClick:l},i?"Hide Ancestors":"Show Ancestors"),"CHILDREN"===e.contentType&&r.a.createElement("button",{onClick:l},i?"Hide Children":"Show Children"),i&&c.length>0?c.map(function(t,a){return"CHILDREN"!==e.contentType&0===a?r.a.createElement("a",{key:a,href:"/c/"+t._id,target:"_blank",rel:"noreferrer"},r.a.createElement("div",{className:"contentgene"},r.a.createElement("h4",null,"Original: ",t.title),r.a.createElement("p",null,t.remix))):r.a.createElement("a",{key:a,href:"/c/"+t._id,target:"_blank",rel:"noreferrer"},r.a.createElement("div",{className:"contentgene"},r.a.createElement("h4",null,a+1,". ",t.title),r.a.createElement("p",null,t.remix)))}):null)},hn=function(e){return r.a.createElement("div",null,e.parent&&r.a.createElement("a",{href:"/c/"+e.parent,target:"_blank",rel:"noreferrer"},"See Parent"),r.a.createElement("p",null,"Start Date: ",e.startDate?e.startDate:"n/a"),r.a.createElement("p",null,"Start Date: ",e.endDate?e.endDate:"n/a"),r.a.createElement("p",null,"Duration: ",e.duration?e.duration:"n/a"),r.a.createElement("p",null,"Total Posts: ",e.postListLength?e.postListLength:"n/a"),r.a.createElement(pn,{contentType:"ANCESTORS",ancestors:e.ancestors}),r.a.createElement(pn,{contentType:"CHILDREN",children:e.children}))},mn=function(e,t){return e.length>0&&e.includes(t)},vn=function(e){var t=Object(n.useState)(0),a=Object(o.a)(t,2),i=a[0],s=a[1],l=Object(n.useState)(0),c=Object(o.a)(l,2),u=c[0],d=c[1],p=Object(n.useState)(!1),h=Object(o.a)(p,2),m=(h[0],h[1]);Object(n.useEffect)(function(){d(e.likes.length-e.dislikes.length),mn(e.bookmarks,e.userPreviewID)&&m(!0),mn(e.likes,e.userPreviewID)?s(1):mn(e.dislikes,e.userPreviewID)&&s(-1)},[]);var v=function(t){var a=u,n=i,r=n+t,o=r>-1&&r<1?t:r,l=t,c=t;return(r<-1||r>1)&&(l=0),r<-1&&(c=1),r>1?(console.log(r),c=-1):0===r&&(-1===n?c=2:1===n&&(c=-2)),fe.voteOnProject(e.projectID,e.userPreviewID,o).then(function(e){d(a+c),s(l)}).catch(function(e){console.log(e)})};return r.a.createElement("div",{className:"projectvote"},r.a.createElement("div",{className:"projectvote-controls"},r.a.createElement("button",{onClick:function(){return v(1)}},"Upvote"),r.a.createElement("p",null,u),r.a.createElement("button",{onClick:function(){return v(-1)}},"DownVote")))},En=function(e){var t=Object(n.useState)([]),a=Object(o.a)(t,2),i=(a[0],a[1]),s=Object(n.useState)("OVERVIEW_STATE"),l=Object(o.a)(s,2),c=l[0],u=l[1];return Object(n.useEffect)(function(){e.project.post_ids.length>0&&fe.returnMultiplePosts(e.project.post_ids.slice(0,2),!1).then(function(e){e.data.posts.length>0&&i(e.data.posts)})},[e.project]),r.a.createElement("div",{className:"spotlightpreview"},r.a.createElement("a",{href:"/c/"+e.project._id},r.a.createElement("h3",null,e.project.title)),e.project.cover_photo_key?r.a.createElement("div",{className:"spotlightpreview-cover-final"},r.a.createElement("img",{alt:"cover",src:ve(e.project.cover_photo_key)})):r.a.createElement("div",{className:"spotlightpreview-cover-placeholder"}),e.project.pursuit&&r.a.createElement("h4",null,e.project.pursuit),r.a.createElement("button",{disabled:"OVERVIEW_STATE"===c,onClick:function(){return u("OVERVIEW_STATE")}},"Overview "),r.a.createElement("button",{disabled:"STAT_STATE"===c,onClick:function(){return u("STAT_STATE")}},"Stats"),"OVERVIEW_STATE"===c&&r.a.createElement("div",null,e.project.overview&&r.a.createElement("p",null,e.project.overview),0!==e.project.children_length&&r.a.createElement("p",null," Children ",e.project.children_length," ")),"STAT_STATE"===c&&r.a.createElement(hn,{parent:e.project.parent,ancestors:e.project.ancestors,children:e.project.children,startDate:e.project.start_date,endDate:e.project.end_date,minDuration:e.project.min_duration,postListLength:e.project.postListLength}),r.a.createElement("div",{className:"spotlightpreview-dp"},r.a.createElement("img",{alt:"display",src:ve(e.project.display_photo_key)}),r.a.createElement("a",{z:!0,href:"/u/"+e.project.username},r.a.createElement("h4",null,e.project.username))),r.a.createElement("div",null,r.a.createElement(vn,{projectID:e.project._id,userPreviewID:e.authUser.userPreviewID,bookmarks:e.project.bookmarks,likes:e.project.likes,dislikes:e.project.dislikes})),r.a.createElement("div",null,r.a.createElement(Et,{labels:e.project.labels})))},fn=function(e){return r.a.createElement("div",null,r.a.createElement("h2",null,"Check Out Some Series That Have Been Published By Others Around the World!"),r.a.createElement("div",{id:"spotlight-projects"},e.spotlight.map(function(t,a){return r.a.createElement(En,Object.assign({key:a},e,{project:t}))})))},bn=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={},n.shouldPull=n.shouldPull.bind(Object(h.a)(n)),n.createRenderedPosts=n.createRenderedPosts.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"shouldPull",value:function(e){this.setState({hasMore:e})}},{key:"createRenderedPosts",value:function(){var e=this;return 0===this.props.results.length?[]:this.props.results.map(function(t){return r.a.createElement(En,Object.assign({},e.props,{project:t}))})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(wa,{feedID:this.props.feedID,contentType:"DYNAMIC",requestQuantity:5,pursuitObject:this.props.pursuitObject,resultsIDList:this.props.resultsIDList,submittingIndexUserID:this.props.submittingIndexUserID,loadedFeed:this.createRenderedPosts(),hasMore:this.props.hasMore,nextOpenPostIndex:this.state.nextOpenPostIndex,shouldPull:this.shouldPull,createTimelineRow:this.props.createTimeline}))}}]),a}(r.a.Component),gn=function(e){Object(m.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={options:null,display:j,spotlight:[],pursuits:null,selectedPursuit:P,finalPursuitObject:null,feedID:8*Math.random(),results:[],resultsIDList:[],hasMore:!0},n.createTimeline=n.createTimeline.bind(Object(h.a)(n)),n.setInitalState=n.setInitalState.bind(Object(h.a)(n)),n.handleFieldChange=n.handleFieldChange.bind(Object(h.a)(n)),n.handleSubmitSearch=n.handleSubmitSearch.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;return fe.getSpotlightProjects(2,["ALL"]).then(function(t){e.setInitalState(t.data.projects)})}},{key:"createTimeline",value:function(e){var t=5===e.length,a=this.state.results.concat(e),n=e.map(function(e){return e._id});this.setState({resultsIDList:n,results:a,hasMore:t})}},{key:"setInitalState",value:function(e){var t=null;if(this.props.authUser){var a=this.props.authUser.pursuits.map(function(e){return e.name});t={spotlight:e,pursuits:a,finalPursuitObject:a}}else t={spotlight:e};this.setState(Object(u.a)({},t))}},{key:"handleFieldChange",value:function(e,t){switch(e){case be.PURSUIT_FIELD:var a=t===P?this.state.pursuits:t;this.setState({selectedPursuit:t,finalPursuitObject:a})}}},{key:"handleSubmitSearch",value:function(){var e=this;return fe.searchProject(this.state.finalPursuitObject,[],5,this.props.authUser.indexProfileID).then(function(t){var a=t.data.map(function(e){return e._id});e.setState({feedID:e.state.feedID+1,results:t.data,resultsIDList:a,display:"RESULTS",hasMore:5===t.data.length})})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(dn,{pursuits:this.state.pursuits,onFieldChange:this.handleFieldChange,onSubmitSearch:this.handleSubmitSearch}),this.state.display===j?r.a.createElement(fn,Object.assign({},this.props,{spotlight:this.state.spotlight})):r.a.createElement(bn,Object.assign({},this.props,{results:this.state.results,pursuitObject:this.state.finalPursuitObject,resultsIDList:this.state.resultsIDList,createTimeline:this.createTimeline,hasMore:this.state.hasMore,feedID:this.state.feedID,submittingIndexUserID:this.props.authUser.indexProfileID})))}}]),a}(r.a.Component),Pn=function(e){return r.a.createElement(ye.Consumer,null,function(t){return r.a.createElement(gn,Object.assign({},e,{authUser:t}))})},Sn=a(97),On=a.n(Sn),yn=(a(151),je(function(){var e=Object(n.useState)(null),t=Object(o.a)(e,2),a=t[0],i=t[1],s=function(e){document.body.style.overflow="hidden",i(e)},l=function(){document.body.style.overflow="visible",i(null)},c=function(e,t){return r.a.createElement("div",{id:"overlay"},r.a.createElement("div",{id:"background",onClick:function(){return t()}}),r.a.createElement("div",{id:"contentholder"},e),r.a.createElement("div",{id:"close",onClick:function(){return t()}},r.a.createElement("img",{alt:"from Pixel perfect",src:On.a})))};return r.a.createElement(Ht.a,null,r.a.createElement(ma,{returnModalStructure:c,openMasterModal:s,closeMasterModal:l,modalState:a}),r.a.createElement(De.c,null,r.a.createElement(De.a,{path:"/",element:r.a.createElement(ea,{returnModalStructure:c,openMasterModal:s,closeMasterModal:l,modalState:a,keyProp:Math.random()})}),r.a.createElement(De.a,{path:"account",element:r.a.createElement(sa,null)}),r.a.createElement(De.a,{path:"works",element:r.a.createElement(Pn,{returnModalStructure:c,openMasterModal:s,closeMasterModal:l,modalState:a})}),r.a.createElement(De.a,{path:"search",element:r.a.createElement(on,{returnModalStructure:c,openMasterModal:s,closeMasterModal:l,modalState:a})}),r.a.createElement(De.a,{path:"u/:username",element:r.a.createElement(Xa,{returnModalStructure:c,openMasterModal:s,closeMasterModal:l,modalState:a})}),r.a.createElement(De.a,{path:"u/:username/threads",element:r.a.createElement(Xa,{returnModalStructure:c,openMasterModal:s,closeMasterModal:l,modalState:a,isProjectView:!0})}),r.a.createElement(De.a,{path:"p/:postID",element:r.a.createElement(Xa,{returnModalStructure:c,openMasterModal:s,closeMasterModal:l,modalState:a,isProjectView:!1})}),r.a.createElement(De.a,{path:"c/:projectID",element:r.a.createElement(Xa,{returnModalStructure:c,openMasterModal:s,closeMasterModal:l,modalState:a,isProjectView:!1})})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(C.Provider,{value:new M},r.a.createElement(yn,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()}).catch(function(e){console.error(e.message)})},6:function(e,t){e.exports={DRAFT:"DRAFT",COVER_PHOTO_FIELD:"coverPhoto",MINI_COVER_PHOTO_FIELD:"miniCoverPhoto",PROJECT_ID_FIELD:"projectID",POST_ID_FIELD:"postID",USER_ID_FIELD:"userID",INDEX_USER_ID_FIELD:"indexUserID",USER_PREVIEW_ID_FIELD:"userPreviewID",OVERVIEW_FIELD:"overview",REMOVE_COVER_PHOTO:"removeCoverPhoto",DISPLAY_PHOTO_FIELD:"displayPhoto",DISTANCE_FIELD:"distance",DIFFICULTY_FIELD:"difficulty",STATUS_FIELD:"status",START_DATE_FIELD:"startDate",END_DATE_FIELD:"endDate",USERNAME_FIELD:"username",IS_PAGINATED_FIELD:"isPaginated",IS_FORKED_FIELD:"isForked",LABELS_FIELD:"labels",PROGRESSION_FIELD:"progression",IS_COMPLETE_FIELD:"isComplete",TITLE_FIELD:"title",POST_PRIVACY_TYPE_FIELD:"postPrivacyType",POST_TYPE_FIELD:"postType",PROJECT_PREVIEW_ID_FIELD:"projectPreviewID",PURSUIT_ARRAY_FIELD:"pursuitArray",PURSUIT_FIELD:"pursuit",DATE_FIELD:"date",MIN_DURATION_FIELD:"minDuration",REMIX:"remix",SELECTED_DRAFT_ID:"selectedDraftID",SELECTED_POSTS_FIELD:"selectedPosts",SUBTITLE_FIELD:"subtitle",IMAGE_KEY_FIELD:"imageKey",IMAGES_FIELD:"images",TEXT_DATA_FIELD:"textData",CROPPED_IMAGE_FIELD:"croppedImage",SMALL_CROPPED_IMAGE_FIELD:"smallCroppedImage",TINY_CROPPED_IMAGE_FIELD:"tinyCroppedImage",FIRST_NAME_FIELD:"firstName",LAST_NAME_FIELD:"lastName",THREAD_TYPE_FIELD:"threadType",THREAD_TITLE_FIELD:"threadTitle",THREAD_TITLE_PRIVACY_FIELD:"threadTitlePrivacy",COMPLETE_PROJECT_FIELD:"completeProject",NEW:"new",EXISTING:"existing",SHOULD_UPDATE_PREVIEW_FIELD:"shouldUpdatePreview"}},8:function(e,t){e.exports={BUCKET_NAME:"eumyth-bucket-1",REGION:"us-west-1",TEMP_PROFILE_PHOTO_URL:"https://qph.fs.quoracdn.net/main-qimg-2b21b9dd05c757fe30231fac65b504dd",ROOT_URL:"/api",ALL_POSTS:"/api/pursuit/all-posts",IMAGE_BASE_URL:"/api/image",MULTIPLE_IMAGES_URL:"/api/image/multiple",DISPLAY_PHOTO_URL:"/api/image/display-photo",CACHED_FEED_URL:"/api/post/cached-feed",COVER_PHOTO_URL:"/api/image/cover",DRAFT_BASE_URL:"/api/draft",DRAFT_TITLE_URL:"/api/draft/title",EXTRA_FEED_URL:"/api/post/extra-feed",PROJECT_PREVIEW_FROM_POST:"/api/post/query-project-preview",TINY_DISPLAY_PHOTO_URL:"/api/image/navbar-display-photo",COMPRESS_PHOTO_URL:"/api/image/compress",USER_BASE_URL:"/api/user",USER_BIO_URL:"/api/user/bio",USER_ACCOUNT_SETTINGS_INFO_URL:"/api/user/account-settings-info",USER_PRIVACY_URL:"/api/user/private",USER_PREVIEW_BASE_URL:"/api/user-preview",USER_PREVIEW_ID_URL:"/api/user-preview/id",USER_PREVIEW_LOCATION_URL:"/api/user-preview/location",USER_TEMPLATE_URL:"/api/user/template",RELATION_BASE_URL:"/api/relation",RELATION_STATUS_URL:"/api/relation/status",RELATION_INFO_URL:"/api/relation/info",RELATION_SET_FOLLOWER_URL:"/api/relation/set",SIMPLE_PEOPLE_URL:"/api/search/simple_people",ADVANCED_PEOPLE_URL:"/api/search/advanced_people",SPOTLIGHT_URL:"/api/search/spotlight",POST_BASE_URL:"/api/post",PROJECT_BASE_URL:"/api/project",PROJECT_FORK_URL:"/api/project/fork",PROJECT_PUBLISH_URL:"/api/project/publish",PROJECT_SPOTLIGHT_URL:"/api/project/spotlight",PROJECT_THREAD_URL:"/api/project/thread",PROJECT_BOOKMARK_URL:"/api/project/bookmark",PROJECT_PREVIEW_BASE_URL:"/api/project-preview",PROJECT_PREVIEW_SINGLE_URL:"/api/project-preview/single",PROJECT_PREVIEW_SHARED_URL:"/api/project-preview/shared-parent",SEARCH_RELATED_PREVIEW_URL:"/api/search/related-projects",PROJECT_VOTE_URL:"/api/project/vote",SINGLE_PROJECT_URL:"/api/project/single",MULTIPLE_PROJECTS_URL:"/api/project/multiple",MULTIPLE_PROJECTS_NO_CACHE_URL:"/api/post/uncached",MULTIPLE_POSTS_URL:"/api/post/multiple",MULTIPLE_POSTS_NO_CACHE_URL:"/api/post/uncached",WITH_IMAGE_POST_URL:"/api/post/with-image",NO_IMAGE_POST_URL:"/api/post/no-image",SOCIAL_FEED_POSTS_URL:"/api/post/feed",POST_DISPLAY_PHOTO_URL:"/api/post/display-photo",SEARCH_PROJECT_URL:"/api/search/projects",SEARCH_UNCACHED_URL:"/api/search/uncached",SEARCH_BRANCHES_URL:"/api/search/branches",SINGLE_POST_TEXT_DATA_URL:"/api/post/single",INDEX_BASE_URL:"/api/index-user",CHECK_USERNAME_URL:"/api/index-user/username",INDEX_USER_PURSUITS_URL:"/api/index-user/pursuits",COMMENT_BASE_URL:"/api/comment",ROOT_COMMENT_URL:"/api/comment/root",REPLY_COMMENT_URL:"/api/comment/reply",REFRESH_COMMENTS_URL:"/api/comment/refresh",VOTE_ON_COMMENT_URL:"/api/comment/vote"}},97:function(e,t,a){e.exports=a.p+"static/media/close2.bb008657.png"}},[[100,1,2]]]);
//# sourceMappingURL=main.f72734a9.chunk.js.map